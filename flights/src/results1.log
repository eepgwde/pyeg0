
R version 3.2.5 (2016-04-14) -- "Very, Very Secure Dishes"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

During startup - Warning messages:
1: Setting LC_TIME failed, using "C" 
2: Setting LC_MONETARY failed, using "C" 
3: Setting LC_PAPER failed, using "C" 
4: Setting LC_MEASUREMENT failed, using "C" 
> options(STERM='iESS', str.dendrogram.last="'", editor='emacsclient', show.error.locations=TRUE)
> 
+ . + + . + + + . + 
> ### weaves
> 
> ## Processing for flights data.
> 
> ## Following the caret vignette.
> 
> ###################################################
> ### code chunk number 1: loadLibs
> ###################################################
> library(MASS)

> library(caret)
Loading required package: lattice
Loading required package: ggplot2

> library(mlbench)

> library(pROC)
Type 'citation("pROC")' for a citation.

Attaching package: 'pROC'

The following objects are masked from 'package:stats':

    cov, smooth, var


> library(pls)

Attaching package: 'pls'

The following object is masked from 'package:caret':

    R2

The following object is masked from 'package:stats':

    loadings


> library(doMC)
Loading required package: foreach
foreach: simple, scalable parallel programming from Revolution Analytics
Use Revolution R for scalability, fault tolerance and more.
http://www.revolutionanalytics.com
Loading required package: iterators
Loading required package: parallel

> registerDoMC(cores = 4)

> options(useFancyQuotes = FALSE) 

> # Accounting info.
> getInfo <- function(what = "Suggests")
+ {
+   text <- packageDescription("caret")[what][[1]]
+   text <- gsub("\n", ", ", text, fixed = TRUE)
+   text <- gsub(">=", "$\\\\ge$", text, fixed = TRUE)
+   eachPkg <- strsplit(text, ", ", fixed = TRUE)[[1]]
+   eachPkg <- gsub(",", .... [TRUNCATED] 

> ### project-specific: begin
> ## Set-seed, load original CSV file, order it
> ## and do some simple-cleaning
> ## Various datasets 
> 
> seed.mine = 107

> set.seed(seed.mine)                     # helpful for testing

> flight <- read.csv("../bak/flight.csv")

> flight <- flight[order(flight$D00),]

> # Backup
> flight.raw <- flight

> # Check warnings
> src.adjust <- TRUE

> source(file = "flight1.R")

> # To check adjustment, there is test code in flight-nb.R
> 
> # Some additions
> 
> flight$DEPSPOKE <- flight$DEPGRP == "Spoke"

> flight$ARRSPOKE <- flight$ARRGRP == "Spoke"

> # And some deletions
> 
> t.cols <- colnames(flight)

> t.drops <- t.cols[grep("^RANK*", t.cols)]

> t.drops <- c(t.drops, t.cols[grep("^(ARR|DEP)GRP$", t.cols)])

> t.drops <- c(t.drops, "D80THPCTL")

> flight <- flight[ , t.cols[!(t.cols %in% t.drops)] ]

> ## Let's do the flight duration logic see the flight logic the notes.
> 
> flight$xDURN <- flight$SARRHR - flight$SDEPHR

> flight$xHNGR <- flight$xDURN < 0

> ## I don't think there is any hangaring. I have to clean this up.
> 
> ## Max flight time is 8 hours for the positives, but red-eyes can
> ## take longer
> 
> hr.wrap <- function(d0, a0) {
+     t0 <- a0 - d0
+     if (t0 >= 0) return(t0)
+     t0 <- 24 - d0
+     t0 <- t0 + a0
+     return(t0)
+  .... [TRUNCATED] 

> flight$xDURN2 <- apply(flight[,c("SDEPHR", "SARRHR")], 1, 
+                        function(y) hr.wrap(y['SDEPHR'], y['SARRHR']))

> flight[which(flight$xDURN2 != flight$xDURN), c("SDEPHR", "SARRHR", "xDURN","xDURN2", "xHNGR")]
     SDEPHR SARRHR xDURN xDURN2 xHNGR
19       22      0   -22      2  TRUE
107      22      0   -22      2  TRUE
111      23      5   -18      6  TRUE
121      21      0   -21      3  TRUE
186      22      0   -22      2  TRUE
203      20      0   -20      4  TRUE
220      21      0   -21      3  TRUE
261      23      7   -16      8  TRUE
285      22      6   -16      8  TRUE
328      18      9    -9     15  TRUE
367      22      6   -16      8  TRUE
443      22      6   -16      8  TRUE
554      22     11   -11     13  TRUE
559      19      0   -19      5  TRUE
595      21     15    -6     18  TRUE
611      22      6   -16      8  TRUE
621      22      0   -22      2  TRUE
625      22      6   -16      8  TRUE
636      20      8   -12     12  TRUE
652      18      7   -11     13  TRUE
654      20     11    -9     15  TRUE
666      21      8   -13     11  TRUE
670      22      5   -17      7  TRUE
686      21      9   -12     12  TRUE
718      18      8   -10     14  TRUE
722      18      7   -11     13  TRUE
742      22      6   -16      8  TRUE
748      18      8   -10     14  TRUE
749      20     10   -10     14  TRUE
785      19      1   -18      6  TRUE
799      18      8   -10     14  TRUE
853      22      6   -16      8  TRUE
855      23      7   -16      8  TRUE
863      18      7   -11     13  TRUE
883      16      6   -10     14  TRUE
905      22      0   -22      2  TRUE
967      22      7   -15      9  TRUE
984      22      0   -22      2  TRUE
1011     22      6   -16      8  TRUE
1012     22      6   -16      8  TRUE
1043     23      6   -17      7  TRUE
1096     22      6   -16      8  TRUE
1148     22      5   -17      7  TRUE
1288     23      8   -15      9  TRUE
1372     23      8   -15      9  TRUE
1384     23      8   -15      9  TRUE
1386     23      5   -18      6  TRUE
1388     23      8   -15      9  TRUE

> t.cols <- colnames(flight)

> t.drops <- c("SARRHR", "xDURN")

> flight <- flight[ , t.cols[!(t.cols %in% t.drops)] ]

> ## Backup
> 
> flight00 <- flight

> # And we drop many, many rows because R slows with large datasets.
> # These are the ranges we have been asked to predict on.
> 
> flight <- flight[flight$AVGLOFATC >= 3.1 & flight$AVGLOFATC <= 4.4,]

> ## Take another copy - this is all we need as the training/prediction
> ## set.
> 
> flight1 <- flight

> ## Data insights
> 
> ## *Run from here.
> 
> ## Using the D00 and LEGTYPE dataset, I have this concern that D00 is
> ## a derived probit and we should ignore it.
> 
> flight <- flight1

> ## So something is defining the behaviour.
> 
> ## Try to simplify structure
> 
> head(model.matrix(LEGTYPE ~ ., data = flight))
   (Intercept) SDEPHR SKDDEPSTAALB SKDDEPSTAAMS SKDDEPSTAANC SKDDEPSTAATT
2            1     14            0            0            0            0
5            1     11            0            0            0            0
7            1     14            0            0            0            0
13           1     13            0            0            0            0
14           1     16            0            0            0            0
17           1     15            0            0            0            0
   SKDDEPSTAAUA SKDDEPSTAAUS SKDDEPSTABDA SKDDEPSTABDL SKDDEPSTABNA
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTABOI SKDDEPSTABOS SKDDEPSTABRU SKDDEPSTABUF SKDDEPSTABWI
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTACCC SKDDEPSTACDG SKDDEPSTACHS SKDDEPSTACLE SKDDEPSTACMH
2             1            0            0            0            0
5             0            0            0            0            0
7             1            0            0            0            0
13            0            0            0            0            0
14            1            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTACUN SKDDEPSTADDD SKDDEPSTADEN SKDDEPSTADFW SKDDEPSTADSM
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            1            0            0            0
   SKDDEPSTADTW SKDDEPSTADUB SKDDEPSTAEWR SKDDEPSTAFCO SKDDEPSTAFLL
2             0            0            0            0            0
5             1            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAFRA SKDDEPSTAGCM SKDDEPSTAGDL SKDDEPSTAGEG SKDDEPSTAGIG
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAHNL SKDDEPSTAIAH SKDDEPSTAILM SKDDEPSTAIND SKDDEPSTAJAX
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAJFK SKDDEPSTAKOA SKDDEPSTALAS SKDDEPSTALAX SKDDEPSTALGA
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTALGB SKDDEPSTALGW SKDDEPSTALHR SKDDEPSTALIH SKDDEPSTAMAD
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAMAN SKDDEPSTAMBJ SKDDEPSTAMCI SKDDEPSTAMCO SKDDEPSTAMDT
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAMEX SKDDEPSTAMHT SKDDEPSTAMIA SKDDEPSTAMKE SKDDEPSTAMSP
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAMSY SKDDEPSTAMUC SKDDEPSTAMZT SKDDEPSTANAS SKDDEPSTAOAK
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAOGG SKDDEPSTAOMA SKDDEPSTAONT SKDDEPSTAORD SKDDEPSTAORF
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAPBI SKDDEPSTAPDX SKDDEPSTAPIT SKDDEPSTAPLS SKDDEPSTAPPP
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            1
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAPUJ SKDDEPSTAPVD SKDDEPSTAPVR SKDDEPSTAPWM SKDDEPSTARDU
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTARIC SKDDEPSTARNO SKDDEPSTAROC SKDDEPSTARSW SKDDEPSTASAN
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTASAT SKDDEPSTASEA SKDDEPSTASFO SKDDEPSTASJC SKDDEPSTASJD
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTASJO SKDDEPSTASJU SKDDEPSTASLC SKDDEPSTASMF SKDDEPSTASNA
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTASRQ SKDDEPSTASTL SKDDEPSTASTT SKDDEPSTASXM SKDDEPSTASYR
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTATLV SKDDEPSTATPA SKDDEPSTAXHP SKDDEPSTAYEG SKDDEPSTAYVR
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAYYC SKDDEPSTAZRH SKDARRSTAALB SKDARRSTAAMS SKDARRSTAANC
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAATT SKDARRSTAAUA SKDARRSTAAUS SKDARRSTABDA SKDARRSTABDL
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTABNA SKDARRSTABOI SKDARRSTABOS SKDARRSTABRU SKDARRSTABUF
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            1            0            0
17            0            0            0            0            0
   SKDARRSTABWI SKDARRSTACCC SKDARRSTACDG SKDARRSTACHS SKDARRSTACLE
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            1            0            0            0
   SKDARRSTACMH SKDARRSTACUN SKDARRSTADDD SKDARRSTADEN SKDARRSTADFW
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTADSM SKDARRSTADTW SKDARRSTADUB SKDARRSTAEWR SKDARRSTAFCO
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAFLL SKDARRSTAFRA SKDARRSTAGCM SKDARRSTAGDL SKDARRSTAGEG
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAGIG SKDARRSTAHNL SKDARRSTAIAH SKDARRSTAILM SKDARRSTAIND
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAJAX SKDARRSTAJFK SKDARRSTAKOA SKDARRSTALAS SKDARRSTALAX
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTALGA SKDARRSTALGB SKDARRSTALGW SKDARRSTALHR SKDARRSTALIH
2             0            0            0            0            0
5             0            0            0            0            0
7             1            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAMAD SKDARRSTAMAN SKDARRSTAMBJ SKDARRSTAMCI SKDARRSTAMCO
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAMDT SKDARRSTAMEX SKDARRSTAMHT SKDARRSTAMIA SKDARRSTAMKE
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAMSP SKDARRSTAMSY SKDARRSTAMUC SKDARRSTAMZT SKDARRSTANAS
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAOAK SKDARRSTAOGG SKDARRSTAOMA SKDARRSTAONT SKDARRSTAORD
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            1
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAORF SKDARRSTAPBI SKDARRSTAPDX SKDARRSTAPIT SKDARRSTAPLS
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAPPP SKDARRSTAPUJ SKDARRSTAPVD SKDARRSTAPVR SKDARRSTAPWM
2             1            0            0            0            0
5             1            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTARDU SKDARRSTARIC SKDARRSTARNO SKDARRSTAROC SKDARRSTARSW
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTASAN SKDARRSTASAT SKDARRSTASEA SKDARRSTASFO SKDARRSTASJC
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTASJD SKDARRSTASJO SKDARRSTASJU SKDARRSTASLC SKDARRSTASMF
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTASNA SKDARRSTASRQ SKDARRSTASTL SKDARRSTASTT SKDARRSTASXM
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTASYR SKDARRSTATLV SKDARRSTATPA SKDARRSTAXHP SKDARRSTAYEG
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAYVR SKDARRSTAYYC SKDARRSTAZRH SKDEQP319 SKDEQP320 SKDEQP321
2             0            0            0         0         0         0
5             0            0            0         0         0         0
7             0            0            0         0         0         1
13            0            0            0         0         0         0
14            0            0            0         0         0         1
17            0            0            0         0         0         0
   SKDEQP332 SKDEQP333 SKDEQP734 SKDEQP75E SKDEQP75H SKDEQP767 SKDEQPA01
2          0         0         1         0         0         0         0
5          0         0         0         0         0         0         0
7          0         0         0         0         0         0         0
13         0         0         1         0         0         0         0
14         0         0         0         0         0         0         0
17         0         0         0         0         0         0         0
   SKDEQPA05 SKDEQPA19 SKDEQPA21 SKDEQPE90 SKDEPS       D00    AVGSQ AVGLOFATC
2          0         0         0         0     32 0.2500000 3.258065  3.258065
5          0         0         0         1     72 0.2916667 2.986111  3.805556
7          0         0         0         0     88 0.3295455 2.551724  3.701149
13         0         0         0         0     32 0.3750000 3.000000  3.903226
14         0         0         0         0     72 0.3750000 3.295775  3.859155
17         0         0         0         0     84 0.3809524 3.939759  3.361446
   UPLINEATCIMPLow UPLINEATCIMPMed UPLINEATCIMPMedHigh UPLINEATCIMPMedLow
2                0               1                   0                  0
5                0               0                   0                  0
7                0               0                   0                  1
13               0               1                   0                  0
14               0               0                   0                  1
17               1               0                   0                  0
   DEPSTAATCIMPLow DOWNLINEATCIMPLow AVGSKDAVAIL AVAILBUCKETA05 AVAILBUCKETA10
2                0                 0   10.903226              0              1
5                1                 0    2.000000              0              0
7                0                 0    9.647059              1              0
13               0                 0   17.354839              0              0
14               0                 0   17.057143              0              0
17               0                 0   10.621951              0              1
   AVAILBUCKETA15 AVAILBUCKETA20 AVAILBUCKETA25 AVAILBUCKETA30 AVAILBUCKETA<0
2               0              0              0              0              0
5               0              0              0              0              0
7               0              0              0              0              0
13              1              0              0              0              0
14              1              0              0              0              0
17              0              0              0              0              0
   DEPBUCKETD2 DEPBUCKETD3 DEPBUCKETD4 DEPBUCKETD5 DEPBUCKETD6 DEPBUCKETD7
2            0           0           0           1           0           0
5            0           0           1           0           0           0
7            0           0           0           1           0           0
13           0           0           0           1           0           0
14           0           0           0           0           1           0
17           0           0           0           0           1           0
   DEPBUCKETD8 ARRBUCKETA2 ARRBUCKETA3 ARRBUCKETA4 ARRBUCKETA5 ARRBUCKETA6
2            0           0           0           0           0           1
5            0           0           0           0           1           0
7            0           0           0           0           0           1
13           0           0           0           0           0           1
14           0           0           0           0           0           0
17           0           0           0           0           0           1
   ARRBUCKETA7 ARRBUCKETA8 DEPRANKGRPLow DEPRANKGRPMed DEPRANKGRPMedHigh
2            0           0             1             0                 0
5            0           0             0             1                 0
7            0           0             1             0                 0
13           0           0             0             0                 0
14           1           0             1             0                 0
17           0           0             0             0                 0
   DEPRANKGRPMedLow TRNRANKGRPLow TRNRANKGRPMed TRNRANKGRPMedHigh
2                 0             1             0                 0
5                 0             1             0                 0
7                 0             1             0                 0
13                1             0             0                 0
14                0             1             0                 0
17                1             0             1                 0
   TRNRANKGRPMedLow ARRRANKGRPLow ARRRANKGRPMed ARRRANKGRPMedHigh
2                 0             0             0                 1
5                 0             0             0                 1
7                 0             0             1                 0
13                1             0             0                 0
14                0             0             0                 1
17                0             0             0                 1
   ARRRANKGRPMedLow DEPSPOKETRUE ARRSPOKETRUE xHNGRTRUE xDURN2
2                 0            0            0         0      2
5                 0            1            0         0      2
7                 0            0            1         0      2
13                1            0            1         0      2
14                0            0            1         0      2
17                0            0            0         0      2

> dummies <- dummyVars(LEGTYPE ~ ., data = flight)

> flight.dum <- predict(dummies, newdata = flight)

> ## It may be too big to use, but useful for inspection.
> 
> ### Numeric variables
> 
> ## Check some more numeric correlations, I haven't scaled yet.
> ## I'd cut correlations above 0.75 because of overfitting.
> 
> x1 <- as.data.frame(as.matrix(sapply(flight, class)))

> flight.num <- flight[,names(x1[which(x1$V1 %in% c("numeric", "integer")),])]

> flight.nzv <- nearZeroVar(flight.num, saveMetrics = TRUE)

> flight.nzv
            freqRatio percentUnique zeroVar   nzv
SDEPHR       1.038462        5.9375   FALSE FALSE
SKDEPS       1.000000       19.0625   FALSE FALSE
D00          1.166667       75.3125   FALSE FALSE
AVGSQ        6.333333       82.8125   FALSE FALSE
AVGLOFATC    1.000000       78.4375   FALSE FALSE
AVGSKDAVAIL  1.000000       87.5000   FALSE FALSE
xDURN2       1.428571        2.5000   FALSE FALSE

> # annoying NA
> flight.cor <- cor(flight.num, use = "pairwise.complete.obs")

> descrCorr <- findCorrelation(flight.cor, cutoff = .65, verbose=TRUE)
Considering row	 1 column	 4 value	 0.956 
  Flagging column	 1 
Considering row	 4 column	 3 value	 0.414 
Considering row	 4 column	 6 value	 0.173 
Considering row	 4 column	 7 value	 0.201 
Considering row	 4 column	 5 value	 0.103 
Considering row	 4 column	 2 value	 0.082 
Considering row	 3 column	 6 value	 0.266 
Considering row	 3 column	 7 value	 0.071 
Considering row	 3 column	 5 value	 0.114 
Considering row	 3 column	 2 value	 0.006 
Considering row	 6 column	 7 value	 0.031 
Considering row	 6 column	 5 value	 0.094 
Considering row	 6 column	 2 value	 0.067 
Considering row	 7 column	 5 value	 0.137 
Considering row	 7 column	 2 value	 0.005 
Considering row	 5 column	 2 value	 0.041 

> colnames(flight.num)[descrCorr]
[1] "SDEPHR"

> ## Which tells me that departure time is very highly correlated to AVGSQ.
> ## AVGSQ is average stand queue?
> 
> ### Try and impute the AVG, it might have more information than the
> ### bucket.
> 
> flight$xAVAILBUCKET <- as.numeric(gsub("^[A<]+", "", flight$AVAILBUCKET))

> ## Arbitrary choice to set to -1.
> flight[which(flight$AVAILBUCKET == 'A<0'), "xAVAILBUCKET" ] <- -1

> flight.na <- flight[, c("AVGSKDAVAIL", "xAVAILBUCKET")]

> preProcValues <- preProcess(flight.na, method = c("knnImpute"))

> flight.na1 <- predict(preProcValues, flight.na)

> flight$xAVGSKDAVAIL <- flight.na1$AVGSKDAVAIL

> ## And I'll leave the centered and scale values in for now.
> ## and delete the troublesome ones
> 
> flight$AVGSKDAVAIL <- NULL

> flight$xHNGR <- NULL

> flight$AVAILBUCKET <- NULL

> # This should be deleted, leave it in and the results are ideal because it defines LEGTYPE.
> flight$D00 <- NULL

> ## Keep the results but don't change the order.
> outcomes.flight <- flight$LEGTYPE

> flight$LEGTYPE <- NULL

> ## If you know your factors are definitely factors, you don't need this
> ##  asNumeric <- function(x) as.numeric(as.character(x))
> 
> factors.numeric <- function(d) modifyList(d, lapply(d[, sapply(d, is.factor)], as.numeric))

> flight.num0 <- factors.numeric(flight)

> flight.scl0 <- scale(flight.num0)

> ## Now split the results
> 
> set.seed(seed.mine)

> inTrain <- createDataPartition(outcomes.flight, p = 0.65, list = FALSE)

> trainDescr <- flight.scl0[inTrain,]

> testDescr <- flight.scl0[-inTrain,]

> trainClass <- outcomes.flight[inTrain]

> testClass <- outcomes.flight[-inTrain]

> prop.table(table(flight.scl0))
flight.scl0
    -2.99546983996958     -2.98604368384811     -2.82110052361751 
           0.00281250            0.00015625            0.00015625 
    -2.64037641778924     -2.37742331516569     -2.09431321436608 
           0.00015625            0.00015625            0.00031250 
    -2.02525208119049     -2.02364615961949     -1.96706162425765 
           0.00046875            0.00093750            0.00015625 
    -1.94787383036273     -1.91934227796699     -1.87162293167633 
           0.00125000            0.00015625            0.00015625 
    -1.80813803757891      -1.8064397520718     -1.76880294648328 
           0.00093750            0.00093750            0.00453125 
     -1.7104004231695     -1.67620690253875     -1.63572266525187 
           0.00312500            0.00015625            0.00078125 
    -1.60554554037119     -1.58829697245811     -1.58375887562806 
           0.00265625            0.00062500            0.00031250 
    -1.56068940274137     -1.55266802930898     -1.55257138616628 
           0.00593750            0.00015625            0.00015625 
    -1.54865734259279     -1.54635333101763     -1.54295794614133 
           0.00015625            0.00015625            0.00015625 
    -1.53179508600425     -1.53074294246617     -1.50769426210174 
           0.00203125            0.00015625            0.00015625 
    -1.49330986644838     -1.47983129638045     -1.47646498237513 
           0.00015625            0.00171875            0.00015625 
    -1.44796824755814     -1.43812707979848     -1.43616463590287 
           0.00015625            0.00031250            0.00015625 
     -1.4311495031078     -1.42786750675664     -1.42754311366228 
           0.00062500            0.00031250            0.00015625 
     -1.4230237164245     -1.42196682798086     -1.40691590144974 
           0.00015625            0.00015625            0.00750000 
    -1.40295304316347     -1.39839761187043     -1.38337483337197 
           0.00343750            0.00015625            0.00015625 
    -1.37828409873765     -1.37590371713284      -1.3753288895824 
           0.00031250            0.00078125            0.00015625 
    -1.37383369560894     -1.37045453151584     -1.35466334686085 
           0.00015625            0.00015625            0.00015625 
    -1.33716625322094     -1.33398496346823     -1.33080367371552 
           0.00015625            0.00015625            0.00015625 
    -1.32393992750903      -1.3160853172316     -1.31578091655701 
           0.00093750            0.00015625            0.00015625 
    -1.31443367614047      -1.3133256164209     -1.30151560934568 
           0.00015625            0.00015625            0.00015625 
    -1.30111163600234     -1.29600486257245     -1.28619597667342 
           0.00015625            0.00031250            0.00031250 
    -1.28367748081635     -1.28186181839242      -1.2799413346293 
           0.00031250            0.00015625            0.00015625 
    -1.27197613788523     -1.26773489691459      -1.2671778786613 
           0.00109375            0.00015625            0.00015625 
     -1.2615812276646     -1.25974760485758     -1.25283365916062 
           0.00031250            0.00078125            0.00015625 
    -1.25178454113998     -1.24659260411695     -1.24079645146543 
           0.00015625            0.00015625            0.00015625 
     -1.2302338686483     -1.23020377865797      -1.2268968080815 
           0.00015625            0.00687500            0.00031250 
    -1.22001234826142     -1.21809512250389     -1.21512040999215 
           0.00046875            0.00015625            0.00015625 
    -1.21024953572476     -1.20647153886774     -1.20560405725029 
           0.00015625            0.00015625            0.00015625 
    -1.20188627600106     -1.20036054595575     -1.20011285144544 
           0.00031250            0.00140625            0.00015625 
    -1.19042311450129     -1.18991798468508     -1.18966337127103 
           0.00015625            0.00015625            0.00062500 
    -1.16804855863761     -1.16764210792351     -1.16749679150174 
           0.00093750            0.00015625            0.00015625 
    -1.16258400593847     -1.16018257780086     -1.15839829359119 
           0.00015625            0.00640625            0.00015625 
    -1.14179763548495     -1.13992628855288     -1.13935994002253 
           0.00015625            0.00031250            0.00031250 
    -1.13310730700243     -1.13102279477938     -1.12993289335973 
           0.00015625            0.00015625            0.00015625 
    -1.12915754122589     -1.12753063368423     -1.12667091460446 
           0.00015625            0.00015625            0.00015625 
    -1.12622940836933     -1.12368140470519     -1.12361616254288 
           0.00031250            0.00015625            0.00062500 
    -1.12145428351456     -1.11910330109794     -1.11800948418703 
           0.00015625            0.00015625            0.00015625 
    -1.11608476901381     -1.11429923219746     -1.09261479989672 
           0.00062500            0.00015625            0.00015625 
    -1.09084552937417     -1.09012044993392      -1.0895833019642 
           0.00015625            0.00015625            0.00031250 
    -1.08549109658463     -1.06938028371369     -1.06604781193988 
           0.00031250            0.00015625            0.00015625 
    -1.06587003530766        -1.06412097939     -1.05534288054392 
           0.00015625            0.00046875            0.00015625 
    -1.04945721011816     -1.04845626690162     -1.04766888572427 
           0.00015625            0.00015625            0.00015625 
    -1.04755297964098     -1.04598728075964     -1.04536609890991 
           0.00031250            0.00031250            0.00031250 
    -1.02993885350447     -1.02151758080685     -1.01733580186582 
           0.00015625            0.00203125            0.02453125 
    -1.01577847702439      -1.0138904262493      -1.0121571897662 
           0.00015625            0.00015625            0.00062500 
    -1.00929178081963     -1.00745946934895     -1.00714202059705 
           0.00015625            0.00015625            0.00015625 
    -1.00664275166081     -1.00407661804032     -1.00110637205939 
           0.00046875            0.00015625            0.00015625 
   -0.997768048748026    -0.991929422812267    -0.989060788495757 
           0.00328125            0.00015625            0.00031250 
    -0.98572380365604    -0.979554261682366    -0.976324799963229 
           0.00015625            0.00031250            0.00875000 
   -0.973173077974651    -0.971118460177678     -0.96975725707502 
           0.01640625            0.00015625            0.00015625 
   -0.963461694934854    -0.961159884505833    -0.960193400142389 
           0.00015625            0.00015625            0.00046875 
   -0.958010282948452    -0.957720936633644    -0.955230663538487 
           0.00015625            0.00015625            0.00015625 
   -0.953451859649493    -0.952397629449069    -0.951677411170411 
           0.00031250            0.00015625            0.01765625 
   -0.947281520180146    -0.946066444247069    -0.942123167843126 
           0.00015625            0.00015625            0.00015625 
   -0.941185041055857    -0.939666457415937    -0.937914389255748 
           0.00015625            0.00031250            0.00015625 
   -0.937428692031181    -0.937143144639067    -0.929006249994557 
           0.00015625            0.00203125            0.00031250 
   -0.928956547037233    -0.927234345076844    -0.926325405165677 
           0.00015625            0.00015625            0.00015625 
   -0.926208874394783     -0.92432711582923    -0.923751900565718 
           0.00015625            0.00015625            0.00015625 
   -0.921447647976772    -0.920026610901552    -0.919775930100724 
           0.00015625            0.00015625            0.00031250 
   -0.919418999070816    -0.918979533540974    -0.918834367344145 
           0.00093750            0.00015625            0.00015625 
   -0.918602057207572    -0.918233359080158    -0.916620305783416 
           0.00015625            0.00015625            0.00031250 
   -0.908229610518583    -0.907879271266391    -0.907626204980156 
           0.00031250            0.00015625            0.00015625 
   -0.906631706666217    -0.905610577820333    -0.905104725277818 
           0.00015625            0.00015625            0.00015625 
   -0.904170844231002    -0.902563699445797    -0.902495470961171 
           0.00031250            0.00015625            0.00046875 
   -0.902207570970879    -0.900277820755885    -0.900269127160796 
           0.00015625            0.00609375            0.00015625 
   -0.900105713501894    -0.897103060359799    -0.896252308815885 
           0.00015625            0.00015625            0.00015625 
   -0.895759768448355    -0.895685333371447    -0.891948830933419 
           0.00015625            0.00015625            0.00015625 
   -0.891482707849845     -0.89086838304768    -0.889814536282523 
           0.00015625            0.02343750            0.00015625 
   -0.886894039811436    -0.885423108336021    -0.885386138492139 
           0.00093750            0.00015625            0.01593750 
   -0.884574764423174    -0.881181388644532    -0.881133728915611 
           0.00015625            0.00015625            0.00015625 
   -0.879323305434347    -0.878872666379052    -0.877901133624378 
           0.00015625            0.00015625            0.00015625 
   -0.876749332956921    -0.876685019263073    -0.875765771148607 
           0.00031250            0.00015625            0.00031250 
   -0.875473779114446     -0.87537693015952    -0.872246314823305 
           0.00015625            0.00015625            0.00015625 
   -0.871001261435858    -0.870353841103083    -0.869162583211394 
           0.00015625            0.00015625            0.00015625 
   -0.866780745576637    -0.866244907634358    -0.858819232798091 
           0.00015625            0.00015625            0.00015625 
   -0.856265820894777    -0.844253476212177    -0.844066341550782 
           0.00078125            0.00015625            0.00015625 
   -0.842025743633279    -0.831738843759029    -0.830837909586882 
           0.02921875            0.00015625            0.02515625 
   -0.829374923233683    -0.828920190368225    -0.827915178181078 
           0.00015625            0.00093750            0.00015625 
   -0.827728686266157    -0.826039032973297    -0.822416105203804 
           0.00015625            0.00015625            0.00015625 
   -0.821797313281808    -0.819285769008092    -0.816336564086851 
           0.00015625            0.00015625            0.00015625 
   -0.814051297945908    -0.811605617460827    -0.809148421270981 
           0.00015625            0.00015625            0.00015625 
   -0.804302031270971    -0.800154571238789    -0.795175551540305 
           0.00062500            0.00015625            0.00171875 
   -0.792845872277945    -0.790185643279993    -0.789212464897955 
           0.02015625            0.00859375            0.00046875 
   -0.787996109659257    -0.785742695872334    -0.783287556756109 
           0.00015625            0.00015625            0.00015625 
    -0.78222517242437    -0.777611190965241    -0.777259256743858 
           0.00015625            0.00015625            0.00015625 
   -0.775052088417874    -0.768725111385422      -0.7653899578722 
           0.00031250            0.00015625            0.00015625 
   -0.764328853007072    -0.759372004638613    -0.759121665238872 
           0.00015625            0.00015625            0.00015625 
   -0.758171518227594    -0.752387355098689    -0.752338241647165 
           0.00015625            0.00015625            0.00031250 
   -0.751716727129916    -0.750007134146443    -0.748171465050933 
           0.00015625            0.00562500            0.00015625 
   -0.743693425437366     -0.74226506946404    -0.738477819728135 
           0.00718750            0.00015625            0.00015625 
   -0.735940818773818    -0.734501921638923    -0.723911474638978 
           0.00015625            0.00015625            0.00015625 
   -0.720697236097384    -0.718445199078953    -0.715142805531928 
           0.00031250            0.00015625            0.00031250 
   -0.713461500253351    -0.710452171936934    -0.708684788599593 
           0.00015625            0.00015625            0.00015625 
   -0.708003561812545    -0.702080356630785     -0.70037445202336 
           0.00015625            0.00015625            0.00203125 
    -0.69602539257426     -0.69280361708918    -0.687853983052082 
           0.00015625            0.03375000            0.00015625 
    -0.68694861300278    -0.684622918007104    -0.682222958529648 
           0.00015625            0.00015625            0.00015625 
   -0.681188975020078    -0.673798181086569     -0.66884926915034 
           0.00187500            0.00015625            0.00015625 
     -0.6653122497357    -0.654779601264497    -0.648410662399554 
           0.00015625            0.00015625            0.00078125 
   -0.647068571912601    -0.646559789740211    -0.633905116384853 
           0.00015625            0.00015625            0.00015625 
   -0.633276439235621    -0.626480919280269    -0.624813955253419 
           0.00015625            0.00015625            0.00015625 
   -0.621563193776932    -0.615573756562581    -0.613123253862724 
           0.00015625            0.00015625            0.00171875 
   -0.604038319371604    -0.596446872775748    -0.596237216599971 
           0.00015625            0.00046875            0.00015625 
   -0.596137826610777    -0.592583054332584    -0.590968847296576 
           0.00015625            0.00359375            0.00015625 
   -0.581016668721787     -0.57842864719944    -0.577046832499099 
           0.00015625            0.00015625            0.00015625 
   -0.576399963736262    -0.567294133064953    -0.562646449882806 
           0.00187500            0.00015625            0.00031250 
   -0.559949234902497    -0.553868745195444    -0.551562209118441 
           0.00031250            0.00015625            0.00859375 
   -0.548486073402725    -0.545057532705371    -0.544483083151942 
           0.00015625            0.00046875            0.00093750 
   -0.543553164656681    -0.542887786706365    -0.542791834600063 
           0.00015625            0.00015625            0.03859375 
   -0.535816263171991    -0.529620965141671    -0.523583345339874 
           0.00031250            0.00015625            0.00015625 
   -0.522876883678594    -0.515144874010522    -0.511242837482551 
           0.00015625            0.00015625            0.00015625 
   -0.511062050911504    -0.509452501139644    -0.507981951223969 
           0.00500000            0.00015625            0.00015625 
   -0.506004946851197    -0.504251327555701    -0.503668338010739 
           0.00015625            0.00203125            0.00015625 
   -0.497665904683127    -0.492519293528136    -0.488304476973275 
           0.00015625            0.00062500            0.00015625 
   -0.486275884354524    -0.480531685495119    -0.479070530598709 
           0.00015625            0.00015625            0.00015625 
   -0.476991811548017    -0.475764665500524    -0.473473045518126 
           0.00078125            0.00015625            0.00015625 
   -0.472612890303562    -0.464757185992567    -0.456186401194196 
           0.00015625            0.00015625            0.00015625 
   -0.454553689487183    -0.453074332488957    -0.452195518537862 
           0.00015625            0.00015625            0.00015625 
   -0.450040882361118    -0.446015592229304    -0.443168278929009 
           0.00015625            0.00015625            0.00015625 
    -0.44055550390433    -0.439275967288811    -0.439064986884659 
           0.00093750            0.00015625            0.00031250 
   -0.436572045333686    -0.433356062339654     -0.43210269137514 
           0.00015625            0.00015625            0.00031250 
   -0.429159183376661     -0.42811270638386    -0.424489571114943 
           0.00015625            0.00015625            0.00015625 
   -0.424136094192972    -0.422368710855631    -0.422286506964679 
           0.00015625            0.00015625            0.00015625 
     -0.4217879739841     -0.42160028367728    -0.408926090390664 
           0.00015625            0.00015625            0.00062500 
   -0.406238662084726    -0.405337563546837    -0.402845924603104 
           0.00015625            0.00015625            0.00015625 
   -0.398392401687235    -0.392753100892855    -0.392721940787981 
           0.00015625            0.00015625            0.00015625 
   -0.389990557124863    -0.383778543291898    -0.381829344162238 
           0.00203125            0.00031250            0.00031250 
   -0.378610740922975    -0.377352421209284     -0.37278098800314 
           0.00015625            0.00015625            0.00015625 
   -0.368704530397105    -0.364033384865912    -0.363121805899083 
           0.00015625            0.00015625            0.00015625 
   -0.361905601371654    -0.360992312891898     -0.36077985218898 
           0.00015625            0.00015625            0.00015625 
    -0.35995405519458    -0.354602189779798    -0.354221703071568 
           0.00046875            0.00015625            0.00015625 
   -0.354125613590753     -0.35383985286255    -0.350820163721666 
           0.00015625            0.00015625            0.00015625 
   -0.347880750045415    -0.347682518083072    -0.344794514479224 
           0.00031250            0.00015625            0.00015625 
   -0.344246401931106    -0.340586009596143    -0.338241270869783 
           0.00015625            0.00015625            0.00031250 
   -0.336627924656718    -0.333999550987416    -0.331679860754818 
           0.00015625            0.00015625            0.00015625 
   -0.327473828580897    -0.325591270635287    -0.320604647133837 
           0.00015625            0.00015625            0.00015625 
   -0.320293393650012    -0.318998347766866    -0.313800886365509 
           0.00015625            0.00015625            0.00015625 
   -0.308729731711204     -0.30775968479621    -0.307488803472333 
           0.00015625            0.00062500            0.00015625 
   -0.305912488397539    -0.300040013990283    -0.299281804870489 
           0.00015625            0.00015625            0.00015625 
   -0.297576089117692    -0.294612153988498    -0.290886990303406 
           0.00015625            0.00015625            0.00015625 
   -0.289476667647491    -0.287805419014019    -0.284664135032912 
           0.00015625            0.00031250            0.00062500 
   -0.283279035792871    -0.278947445070673    -0.278430676385642 
           0.00015625            0.00015625            0.01140625 
   -0.277028655971768    -0.274352800845479    -0.269810489634915 
           0.00015625            0.00015625            0.00875000 
   -0.268327804913194    -0.264273008183568    -0.263991250766728 
           0.00015625            0.00015625            0.00015625 
   -0.263633329101249    -0.256569345435893    -0.255210887064625 
           0.00015625            0.00015625            0.00015625 
   -0.254264930167697    -0.253205544043426    -0.250717006205447 
           0.00015625            0.00015625            0.00015625 
   -0.250531752899298    -0.249985351299549    -0.247578088366761 
           0.00015625            0.00015625            0.00015625 
   -0.244437996150226    -0.243268618233703    -0.242824942853484 
           0.00015625            0.00015625            0.00015625 
   -0.233740722783471    -0.232700345409106    -0.232349973253986 
           0.00015625            0.00015625            0.00015625 
   -0.231815214890401    -0.231309362347886     -0.23037548130107 
           0.00015625            0.00015625            0.00015625 
   -0.228412208040947    -0.226589859802479    -0.224837647995068 
           0.00015625            0.01656250            0.00015625 
   -0.223464759128966     -0.22331717855311    -0.222588752387258 
           0.00015625            0.00015625            0.00015625 
   -0.222456945885953    -0.220222816737245    -0.217487288707678 
           0.00015625            0.00031250            0.00046875 
   -0.216388232760497    -0.213098676881504    -0.212807560710942 
           0.00015625            0.00093750            0.00015625 
   -0.205527942504415    -0.202889656333141    -0.199061273711729 
           0.00015625            0.00015625            0.00015625 
   -0.197285663071406    -0.196655198635886    -0.187398059917142 
           0.00015625            0.00015625            0.00328125 
    -0.18553936273967    -0.184426534107832      -0.1807365557853 
           0.00015625            0.00015625            0.00031250 
   -0.173455385110242    -0.170696066339926    -0.167983070845547 
           0.00953125            0.00062500            0.00015625 
    -0.16706735776498     -0.16549287956689    -0.163323851054559 
           0.00015625            0.00015625            0.00015625 
   -0.163005226779217    -0.155721964916119     -0.15557956030375 
           0.00015625            0.00015625            0.00015625 
   -0.145050220201077    -0.140627037006184    -0.136663205761249 
           0.00015625            0.00015625            0.00015625 
   -0.135547666352963    -0.135353058341049    -0.135168941442998 
           0.00015625            0.00015625            0.00015625 
    -0.13422823788067    -0.128983100398563    -0.128772766161494 
           0.00015625            0.00015625            0.00062500 
   -0.128276147190878    -0.124732071896041    -0.122750748897942 
           0.00015625            0.00015625            0.00015625 
   -0.121913567685457    -0.114572129500928    -0.113273027561381 
           0.00015625            0.00015625            0.00015625 
   -0.107405286684043    -0.105529863556612    -0.103356043915892 
           0.00015625            0.00953125            0.00015625 
  -0.0959919473132286   -0.0946576344451732   -0.0921610479659292 
           0.00015625            0.00031250            0.00015625 
  -0.0897276946329045    -0.082082912166815   -0.0820786945748793 
           0.00015625            0.00015625            0.00031250 
  -0.0807439358161152   -0.0768089765376881   -0.0759616047321375 
           0.00015625            0.00140625            0.00015625 
  -0.0741942213947964   -0.0733788467156504   -0.0726315828860554 
           0.00015625            0.00718750            0.00015625 
  -0.0685974846038955   -0.0532150311664168   -0.0498043335027671 
           0.00093750            0.00015625            0.00015625 
  -0.0497543467601004   -0.0473016251818649   -0.0451490777305966 
           0.00015625            0.00015625            0.00031250 
  -0.0446498361490209   -0.0392160026639466   -0.0373582346840002 
           0.00015625            0.00015625            0.00015625 
  -0.0352851923820555   -0.0345646240252186   -0.0326438116903773 
           0.00031250            0.00031250            0.00015625 
  -0.0248451869138821   -0.0188880173129063    -0.013807090586871 
           0.00109375            0.00015625            0.00015625 
  -0.0119657325121257   -0.0114810502208166  -0.00721676013122688 
           0.00015625            0.00015625            0.00015625 
 -0.00368424503602545 -0.000580656453063986   0.00425466589044258 
           0.00015625            0.00015625            0.00015625 
  0.00624696207963468   0.00661720265702806    0.0104887638020741 
           0.00015625            0.00015625            0.00015625 
   0.0151944372905789    0.0177528116242494    0.0194770878491831 
           0.00421875            0.00015625            0.00015625 
   0.0217087977522383    0.0235168212825711    0.0255537765734798 
           0.00015625            0.00015625            0.00015625 
   0.0264730080152699    0.0271186027099238    0.0361351573082595 
           0.00015625            0.00031250            0.00015625 
   0.0362911121323546    0.0368634437985054    0.0454309894047899 
           0.00015625            0.00015625            0.00015625 
   0.0533298995579193    0.0570581595639766    0.0585759323236618 
           0.00015625            0.00937500            0.00015625 
   0.0675339577108118    0.0702113818864803    0.0729377618887858 
           0.00046875            0.00015625            0.00062500 
   0.0788793134968683    0.0789059252411879    0.0790823923337298 
           0.00015625            0.02343750            0.00046875 
   0.0797510873183287    0.0806069942083428    0.0841639835120876 
           0.00015625            0.00015625            0.00015625 
   0.0899621750174284    0.0966606496804153    0.0972018193465008 
           0.00015625            0.00015625            0.00015625 
    0.101566818289489     0.108411810410797     0.109012079979066 
           0.00062500            0.00015625            0.00046875 
     0.11244290268093     0.119444894039026     0.131046181957536 
           0.00015625            0.00015625            0.00203125 
    0.134889340170799     0.135028927523559     0.136658265622521 
           0.00015625            0.00015625            0.00015625 
    0.144157938789208     0.146258849789861     0.147318188850963 
           0.00015625            0.00015625            0.02984375 
    0.151115033119933     0.152349655315244     0.154426066228552 
           0.00015625            0.00015625            0.00015625 
     0.15737266071083     0.162873929857665     0.162973153669365 
           0.00015625            0.00015625            0.00015625 
    0.164891939398059     0.165580765616732     0.173693095305534 
           0.00015625            0.00015625            0.00015625 
    0.183009971581342     0.186789363756051     0.187969991368742 
           0.00093750            0.00015625            0.00015625 
    0.192709893790261     0.194724832331223     0.194735738184732 
           0.00015625            0.00015625            0.00015625 
    0.195991364801127     0.206802781312992     0.210386154876613 
           0.00015625            0.00015625            0.00500000 
    0.217235034249908       0.2177869344983     0.234906769563277 
           0.00031250            0.00203125            0.00015625 
    0.234973761205148     0.238837237065174     0.241127733319099 
           0.00031250            0.00015625            0.00015625 
    0.250135635132824      0.25028785413495     0.253309352340188 
           0.00015625            0.00015625            0.00078125 
    0.254814769298151     0.260835355687548     0.264960519475955 
           0.00015625            0.00015625            0.00015625 
    0.266044692238248      0.27127954776092     0.273304013334367 
           0.00015625            0.00015625            0.00015625 
    0.273531307307048     0.274822103147971     0.280770740587068 
           0.00015625            0.00015625            0.00015625 
    0.284591080073122     0.285810915205503     0.286937550828954 
           0.00015625            0.00015625            0.00046875 
    0.289640625615739     0.301307082566931     0.302882181759369 
           0.00015625            0.00015625            0.00015625 
    0.304256560508303     0.309710068792923     0.311251030414092 
           0.00015625            0.00015625            0.00015625 
    0.311802268812853     0.318128929047187     0.318922298138204 
           0.00015625            0.00031250            0.00015625 
    0.320852365313198     0.322875645177539     0.334350357273903 
           0.00015625            0.00015625            0.00015625 
    0.337167536402539     0.338400625416362     0.338901340452759 
           0.00015625            0.00031250            0.00140625 
    0.346939027258188     0.348766831423466     0.358991725758732 
           0.00015625            0.00015625            0.00015625 
    0.364034892089946     0.365884194608935     0.368674799710984 
           0.00015625            0.00015625            0.00015625 
    0.369643258716518     0.373829702918903     0.379821273586168 
           0.00015625            0.00062500            0.00015625 
    0.382087226815338      0.38685609839469       0.3878539441829 
           0.00015625            0.00015625            0.00015625 
     0.38923354153609     0.390865130076565     0.393785793790202 
           0.00015625            0.00093750            0.00015625 
    0.402956322412276     0.404247945632944      0.40569298299336 
           0.00015625            0.00015625            0.00015625 
    0.406064629649282      0.40786256349758     0.408056423319527 
           0.00015625            0.00109375            0.00015625 
    0.412247177017014     0.414419483912049     0.416346031539166 
           0.00015625            0.00046875            0.00015625 
     0.41794166276908     0.419463447191946     0.420106603846799 
           0.00015625            0.01078125            0.00015625 
    0.420379431706021     0.420869449539072     0.431214346889845 
           0.00406250            0.00015625            0.00015625 
    0.433937840525743     0.440278644951702     0.441895424076257 
           0.00031250            0.00015625            0.00015625 
    0.442828919700371     0.443274873059508     0.446173888246631 
           0.00046875            0.00984375            0.00015625 
    0.450718587802467     0.456900610463576     0.459555681956315 
           0.00015625            0.00031250            0.00015625 
    0.460696686048428     0.467876105484108     0.472728746197005 
           0.00015625            0.00015625            0.00015625 
    0.474472217743954     0.474601080341499     0.474734089218203 
           0.00015625            0.00031250            0.00015625 
    0.477973490467994     0.484307789443022     0.484652344952628 
           0.00015625            0.00015625            0.00015625 
    0.494792709324177     0.498497691565453     0.500784787450151 
           0.00109375            0.00515625            0.00015625 
    0.504691880000581     0.508425703980646      0.50861676779181 
           0.00031250            0.00015625            0.00015625 
     0.50996114523361     0.514344382856681     0.516995457862692 
           0.00015625            0.00015625            0.00015625 
    0.518586102739047     0.521829770584971     0.523840570430114 
           0.00015625            0.00015625            0.00015625 
    0.524285913333902     0.525227742436545     0.527917885589494 
           0.00015625            0.00015625            0.00015625 
    0.531983533422768     0.539966728864973     0.541903897062432 
           0.00015625            0.00015625            0.00046875 
    0.543994005812287     0.545724786000498     0.546756498947983 
           0.00125000            0.00015625            0.00203125 
    0.548923619243861     0.549353970396232       0.5588553176537 
           0.00015625            0.00015625            0.00031250 
    0.564138483610525     0.566992546543754     0.569133261860447 
           0.00015625            0.00015625            0.00015625 
    0.574903744908869     0.577978215152712     0.578343495716271 
           0.00031250            0.00109375            0.00015625 
    0.580241024741447     0.581634314964003     0.583204933976379 
           0.00015625            0.00015625            0.00015625 
     0.58873859479558     0.595455758634415     0.597057916427158 
           0.00015625            0.00031250            0.00015625 
    0.598720288571789     0.599162991111384     0.599578938399305 
           0.00031250            0.00015625            0.00015625 
     0.60342049593258     0.604292419065582     0.607847397763963 
           0.00015625            0.00015625            0.00015625 
    0.611956869618315     0.612059726969641     0.612784292101807 
           0.00015625            0.00062500            0.00015625 
    0.613557486760981     0.620580331763515     0.622971928913742 
           0.00015625            0.00015625            0.00375000 
     0.63588348041021     0.641390081029809     0.643182929950686 
           0.00015625            0.00015625            0.00015625 
    0.648293425210027     0.650684078195595     0.657754904789885 
           0.00015625            0.00046875            0.00015625 
    0.664732625480728     0.665678528246394     0.665791697835918 
           0.00015625            0.00984375            0.00015625 
    0.666578602798705     0.678050028820375     0.678379635730825 
           0.00015625            0.00015625            0.00015625 
    0.679808655934455     0.680412565586961     0.680711498268701 
           0.00328125            0.00015625            0.00015625 
    0.684080216155581     0.684149053017272     0.685295140133807 
           0.00281250            0.00015625            0.00031250 
    0.686201169423553     0.690582799388141     0.692180702201577 
           0.00015625            0.00421875            0.00015625 
    0.696595449900374     0.697435597111395     0.698914306548046 
           0.00015625            0.00015625            0.00015625 
     0.70193206265865     0.702647867819401     0.707754986014002 
           0.00015625            0.00062500            0.00015625 
    0.711210346763156     0.712920206015224     0.713369947147153 
           0.00015625            0.00015625            0.00015625 
    0.715327471836729     0.722275487513834     0.722728216151602 
           0.00031250            0.00156250            0.00015625 
      0.7239248415172      0.72708089915877     0.729737150343281 
           0.00015625            0.00015625            0.00015625 
    0.735388003016973     0.740385327518889     0.741422651587756 
           0.00031250            0.00015625            0.00015625 
    0.741444754160499     0.747108762937508     0.748191169284348 
           0.00015625            0.00031250            0.00015625 
    0.751436430272142     0.752533256420978     0.752674676426801 
           0.00015625            0.00015625            0.00015625 
    0.754611657443207     0.754889027400603     0.756349639135923 
           0.00125000            0.00015625            0.00015625 
    0.763526062479594     0.768717423291569     0.770997182276433 
           0.00015625            0.00015625            0.00015625 
     0.77805655959217     0.780455501601279      0.79111659134251 
           0.00015625            0.00015625            0.00015625 
    0.794424123694395     0.794542595446869     0.797594367513394 
           0.00046875            0.00015625            0.00015625 
    0.806459604893308     0.806575447067013     0.815325824113437 
           0.00015625            0.00171875            0.00031250 
    0.820054212719794     0.821566079066492     0.822735985643791 
           0.00015625            0.00015625            0.00015625 
    0.824910396049865     0.825564426121463     0.827093295015157 
           0.00015625            0.00281250            0.00015625 
    0.830498441784675     0.839706577696515     0.854374875678462 
           0.00031250            0.00015625            0.00015625 
    0.857045424718981     0.857046899457354     0.858539236690819 
           0.00031250            0.00015625            0.00109375 
    0.861958482401254     0.864973903806387     0.868060666977836 
           0.00015625            0.00031250            0.00015625 
    0.871547517399078     0.877907606552374     0.878620392468042 
           0.00015625            0.00031250            0.00015625 
    0.882079910398028     0.886773165429333     0.895872264013794 
           0.00015625            0.00015625            0.00031250 
    0.902874892971196     0.909893594892982     0.910503026314625 
           0.00015625            0.00015625            0.00015625 
    0.918355472177732     0.923930998062757     0.928610132228083 
           0.00156250            0.00015625            0.00015625 
    0.930580294371997     0.932353440099381     0.933043163131344 
           0.00015625            0.00015625            0.00015625 
    0.935865275090846     0.938721396055517      0.94732667023698 
           0.00015625            0.00015625            0.00015625 
    0.952388332756409     0.953472399517577     0.960457391255192 
           0.00046875            0.00015625            0.00015625 
    0.962466815938431     0.974608403263273     0.977273131185975 
           0.00031250            0.00015625            0.00015625 
    0.979887858238853     0.981765099822977     0.982533764258785 
           0.02546875            0.00015625            0.00015625 
    0.986421193335086     0.991131333762411      0.99464772824313 
           0.00046875            0.00015625            0.00015625 
     1.00529335053186      1.01443060556224       1.0145402019372 
           0.00015625            0.00062500            0.00015625 
     1.02257036343242      1.02480443153783      1.02810330735672 
           0.00015625            0.00015625            0.00015625 
     1.02815692332918       1.0286099206142      1.03278708868866 
           0.00265625            0.00015625            0.00015625 
     1.03867605371823      1.04030809775545      1.05026762861212 
           0.00015625            0.00046875            0.00015625 
     1.05448691449244       1.0552263521649      1.05588258974527 
           0.00125000            0.00015625            0.00015625 
     1.06000513122926      1.06639439518604      1.07107601485988 
           0.00906250            0.00078125            0.00015625 
     1.07323792501438      1.07985999257921      1.08185178624946 
           0.00015625            0.00015625            0.00015625 
     1.08200577310599      1.08501442587133      1.08924264046828 
           0.00015625            0.00015625            0.00015625 
     1.09237983879524      1.09858922192811      1.09934822043348 
           0.00015625            0.00015625            0.00015625 
      1.1078948637414      1.11407400788163      1.11835818480985 
           0.00015625            0.00015625            0.00093750 
     1.11909298650692      1.12255263564979      1.13098492845703 
           0.00125000            0.00640625            0.00718750 
     1.13520899613199      1.13659865262031      1.14324263811607 
           0.00015625            0.00031250            0.00015625 
      1.1444495252129       1.1551673045972      1.15841602768456 
           0.00578125            0.00046875            0.00015625 
     1.17032197443365      1.17077944389967      1.17660425916148 
           0.00156250            0.01546875            0.00015625 
     1.17671971786951      1.18390085758965      1.19061835680715 
           0.00031250            0.02078125            0.00078125 
     1.19124162268748      1.19491419845781      1.20187158527135 
           0.00046875            0.01000000            0.00015625 
     1.20935820034015      1.21534749252995      1.21684078311872 
           0.00015625            0.00015625            0.00015625 
     1.22228576405746      1.22358524293339       1.2307494205369 
           0.00046875            0.00375000            0.00359375 
     1.23190824585799      1.23309624815214       1.2482497077686 
           0.00015625            0.00015625            0.00015625 
     1.24914605564843      1.25030062698194      1.25167385090479 
           0.00015625            0.00015625            0.00015625 
      1.2521388586462      1.25403638767138      1.25696184836792 
           0.00015625            0.00015625            0.00015625 
     1.25865710330342      1.26219503016375      1.26339025886804 
           0.00015625            0.00015625            0.00062500 
     1.27424955368127      1.27429889692881      1.27581391381442 
           0.00062500            0.01093750            0.00015625 
     1.28103448636196      1.28422435170195      1.28502302740832 
           0.00015625            0.00015625            0.00015625 
     1.28694332261892      1.28862136579613      1.29135133286724 
           0.00015625            0.00015625            0.00015625 
     1.29271693854318      1.29352984392642      1.29416501801516 
           0.00093750            0.00015625            0.00015625 
     1.32000923372796      1.32621334330507      1.32674979912185 
           0.00015625            0.00031250            0.00031250 
      1.3355388950486      1.33819762355126      1.34572143844383 
           0.00703125            0.00015625            0.00015625 
     1.34900429115538      1.35106912963136      1.35909050306374 
           0.00015625            0.00015625            0.00015625 
     1.36740896432616      1.37732504122682      1.37817713292888 
           0.00015625            0.00015625            0.00171875 
     1.38155034894393      1.38244688032714      1.38971756538262 
           0.00015625            0.00015625            0.00015625 
     1.39337346848199      1.39481552027921      1.39920925968592 
           0.00015625            0.00015625            0.00015625 
     1.40401019415033      1.40768753122916      1.42034462702771 
           0.00015625            0.00046875            0.00031250 
     1.42884838085788      1.43014092255268      1.43175470937195 
           0.00062500            0.00078125            0.00015625 
     1.43334191774463      1.43396654425843      1.43750664054499 
           0.00046875            0.00015625            0.00015625 
     1.43754219334743       1.4388998201083      1.44153927902681 
           0.00015625            0.01625000            0.01421875 
     1.44769121849116      1.44889234688456      1.45317034273597 
           0.00015625            0.00015625            0.00015625 
     1.45756717172523      1.46514717542552      1.48152004641465 
           0.00015625            0.01359375            0.00015625 
     1.48210471217649       1.4854271336131      1.49691410201524 
           0.00187500            0.00015625            0.00031250 
     1.50460499505036          1.5159104855      1.51944062018193 
           0.00015625            0.00062500            0.00015625 
     1.51951797036384      1.52322014302823      1.52914361888698 
           0.00015625            0.00015625            0.00015625 
     1.53094696259391      1.53185854523801      1.54534195968881 
           0.00015625            0.00015625            0.00015625 
     1.55198480359028      1.55950143190504      1.56497982317259 
           0.00031250            0.00015625            0.00015625 
     1.58262031982126      1.59616721426295      1.60437565730193 
           0.00062500            0.00015625            0.00015625 
     1.61266940307664      1.61805143272205      1.63593441495235 
           0.00015625            0.00015625            0.00390625 
     1.66020775786113      1.67542635415394      1.67673538939901 
           0.00046875            0.00015625            0.00437500 
     1.68035708519021      1.68346836697786      1.68837599513398 
           0.00015625            0.00015625            0.00015625 
     1.68938234802037      1.70189867028665      1.70300688645049 
           0.00015625            0.00015625            0.00015625 
     1.70487078400102      1.71353493899627      1.72834558905075 
           0.00015625            0.00015625            0.00015625 
     1.72915591888238      1.73426417234817      1.74021109248258 
           0.00015625            0.00015625            0.00015625 
     1.74232222740301      1.74349939634561       1.7580041756475 
           0.00015625            0.00015625            0.00015625 
     1.76113921780106      1.76617520172517      1.77211632108358 
           0.00015625            0.00015625            0.00015625 
     1.77514993495452      1.79958280830507      1.81629669477704 
           0.00015625            0.00015625            0.00031250 
     1.81990457312901      1.83656963213994      1.83724270780201 
           0.00015625            0.01140625            0.00015625 
     1.84610801109783      1.87127556838068      1.87941151145041 
           0.00015625            0.00031250            0.00015625 
     1.88207392317223      1.89017691499225      1.91733288828094 
           0.00031250            0.00015625            0.00015625 
     1.94867279430132      1.95578696468731      1.95652907096428 
           0.00687500            0.00015625            0.00015625 
     1.96029188648611      1.97337415011671      1.97682872944693 
           0.00015625            0.00015625            0.00015625 
     1.97898223695928      2.01790204562771      2.04143987127407 
           0.00015625            0.00015625            0.00171875 
     2.04788306887298      2.07547273185274      2.09309957494449 
           0.00062500            0.00031250            0.00015625 
     2.09950420993508      2.10052429104874      2.10697756530747 
           0.00031250            0.00015625            0.00015625 
     2.11999156344762      2.12917389303477      2.15933629269958 
           0.00015625            0.00015625            0.00015625 
     2.18306393167287      2.18323513022319      2.18704108088277 
           0.00187500            0.00015625            0.00015625 
     2.23887211958444      2.24380917557826      2.28051444339884 
           0.00015625            0.00015625            0.00562500 
     2.28417103037285      2.30954548348617      2.34561980157645 
           0.00015625            0.00125000            0.00015625 
     2.52385907644018      3.01185818638057      3.23514293488871 
           0.00015625            0.00015625            0.00031250 
     3.52347021972545      4.91171482734768      5.33930094132038 
           0.00015625            0.00015625            0.00015625 
     6.39137994453622      6.97999767626588 
           0.00015625            0.00015625 

> prop.table(table(trainClass))
trainClass
   Strong      Weak 
0.4449761 0.5550239 

> dim(trainDescr)
[1] 209  20

> dim(testDescr)
[1] 111  20

> ## Check Near-zero variance
> 
> nzv <- nearZeroVar(trainDescr, saveMetrics= TRUE)

> stopifnot( all(nzv$nzv == FALSE) )

> # It's imputed and behaves well, no need for this.
> # descrCorr <- cor(scale(trainDescr), use = "pairwise.complete.obs")
> 
> descrCorr <- cor(scale(trainDescr))

> ## This cut-off should be under src.adjust control.
> ## I'm under Git, so I can tinker with it.
> highCorr <- findCorrelation(descrCorr, cutoff = .65, verbose = TRUE)
Considering row	 1 column	 11 value	 0.988 
  Flagging column	 1 
Considering row	 11 column	 10 value	 0.353 
Considering row	 11 column	 17 value	 0.312 
Considering row	 11 column	 16 value	 0.284 
Considering row	 11 column	 6 value	 0.953 
  Flagging column	 11 
Considering row	 10 column	 17 value	 0.63 
Considering row	 10 column	 16 value	 0.547 
Considering row	 10 column	 6 value	 0.362 
Considering row	 10 column	 12 value	 0.33 
Considering row	 10 column	 14 value	 0.299 
Considering row	 10 column	 2 value	 0.354 
Considering row	 10 column	 8 value	 0.363 
Considering row	 10 column	 9 value	 0.386 
Considering row	 10 column	 13 value	 0.27 
Considering row	 10 column	 18 value	 0.222 
Considering row	 10 column	 19 value	 0.135 
Considering row	 10 column	 3 value	 0.435 
Considering row	 10 column	 20 value	 0.069 
Considering row	 10 column	 15 value	 0.25 
Considering row	 10 column	 7 value	 0.182 
Considering row	 10 column	 5 value	 0.082 
Considering row	 10 column	 4 value	 0.041 
Considering row	 17 column	 16 value	 0.873 
  Flagging column	 17 
Considering row	 16 column	 6 value	 0.22 
Considering row	 16 column	 12 value	 0.231 
Considering row	 16 column	 14 value	 0.24 
Considering row	 16 column	 2 value	 0.341 
Considering row	 16 column	 8 value	 0.605 
Considering row	 16 column	 9 value	 0.657 
  Flagging column	 16 
Considering row	 6 column	 12 value	 0.891 
  Flagging column	 6 
Considering row	 12 column	 14 value	 0.167 
Considering row	 12 column	 2 value	 0.103 
Considering row	 12 column	 8 value	 0.14 
Considering row	 12 column	 9 value	 0.076 
Considering row	 12 column	 13 value	 0.154 
Considering row	 12 column	 18 value	 0.145 
Considering row	 12 column	 19 value	 0.108 
Considering row	 12 column	 3 value	 0.111 
Considering row	 12 column	 20 value	 0.145 
Considering row	 12 column	 15 value	 0.187 
Considering row	 12 column	 7 value	 0.159 
Considering row	 12 column	 5 value	 0.093 
Considering row	 12 column	 4 value	 0.005 
Considering row	 14 column	 2 value	 0.593 
Considering row	 14 column	 8 value	 0.122 
Considering row	 14 column	 9 value	 0.098 
Considering row	 14 column	 13 value	 0.668 
  Flagging column	 14 
Considering row	 2 column	 8 value	 0.24 
Considering row	 2 column	 9 value	 0.485 
Considering row	 2 column	 13 value	 0.585 
Considering row	 2 column	 18 value	 0.187 
Considering row	 2 column	 19 value	 0.085 
Considering row	 2 column	 3 value	 0.262 
Considering row	 2 column	 20 value	 0.022 
Considering row	 2 column	 15 value	 0.117 
Considering row	 2 column	 7 value	 0.05 
Considering row	 2 column	 5 value	 0.104 
Considering row	 2 column	 4 value	 0.165 
Considering row	 8 column	 9 value	 0.481 
Considering row	 8 column	 13 value	 0.11 
Considering row	 8 column	 18 value	 0.175 
Considering row	 8 column	 19 value	 0.297 
Considering row	 8 column	 3 value	 0.265 
Considering row	 8 column	 20 value	 0.22 
Considering row	 8 column	 15 value	 0.043 
Considering row	 8 column	 7 value	 0.1 
Considering row	 8 column	 5 value	 0.045 
Considering row	 8 column	 4 value	 0.007 
Considering row	 9 column	 13 value	 0.139 
Considering row	 9 column	 18 value	 0.014 
Considering row	 9 column	 19 value	 0.351 
Considering row	 9 column	 3 value	 0.279 
Considering row	 9 column	 20 value	 0.223 
Considering row	 9 column	 15 value	 0.033 
Considering row	 9 column	 7 value	 0.141 
Considering row	 9 column	 5 value	 0.115 
Considering row	 9 column	 4 value	 0.002 
Considering row	 13 column	 18 value	 0.185 
Considering row	 13 column	 19 value	 0.105 
Considering row	 13 column	 3 value	 0.167 
Considering row	 13 column	 20 value	 0.143 
Considering row	 13 column	 15 value	 0.178 
Considering row	 13 column	 7 value	 0.073 
Considering row	 13 column	 5 value	 0.014 
Considering row	 13 column	 4 value	 0.152 
Considering row	 18 column	 19 value	 0.146 
Considering row	 18 column	 3 value	 0.012 
Considering row	 18 column	 20 value	 0.032 
Considering row	 18 column	 15 value	 0.186 
Considering row	 18 column	 7 value	 0.09 
Considering row	 18 column	 5 value	 0.047 
Considering row	 18 column	 4 value	 0.04 
Considering row	 19 column	 3 value	 0.151 
Considering row	 19 column	 20 value	 0.854 
  Flagging column	 19 
Considering row	 3 column	 20 value	 0.025 
Considering row	 3 column	 15 value	 0.063 
Considering row	 3 column	 7 value	 0.127 
Considering row	 3 column	 5 value	 0.076 
Considering row	 3 column	 4 value	 0.127 
Considering row	 20 column	 15 value	 0.023 
Considering row	 20 column	 7 value	 0.034 
Considering row	 20 column	 5 value	 0.084 
Considering row	 20 column	 4 value	 0.029 
Considering row	 15 column	 7 value	 0.076 
Considering row	 15 column	 5 value	 0.082 
Considering row	 15 column	 4 value	 0.029 
Considering row	 7 column	 5 value	 0.009 
Considering row	 7 column	 4 value	 0.006 
Considering row	 5 column	 4 value	 0.211 

> colnames(trainDescr)[highCorr]
[1] "SDEPHR"       "DEPBUCKET"    "ARRSPOKE"     "DEPSPOKE"     "AVGSQ"       
[6] "TRNRANKGRP"   "xAVAILBUCKET"

> descr.ncol0 <- ncol(trainDescr)

> # I've switched off the correlation remover and the results are better.
> if (sum(highCorr) > 0) {
+     warning("overfitting: correlations: err.trainDescr: ", paste(colnames(trainDescr)[highCorr], collapse = ", ") )
+     err.trainDescr <- trainDescr
+     trainDescr <- trainDescr[,-highCorr]
+ }

> descr.ncol1 <- ncol(trainDescr)

> paste("Dropped: ", as.character(descr.ncol0 - descr.ncol1))
[1] "Dropped:  7"

> descrCorr <- cor(trainDescr)

> summary(descrCorr[upper.tri(descrCorr)])
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.480800 -0.123900 -0.009124 -0.005226  0.104300  0.585100 

> ## Dominant correlations
> ## At 0.9, there are some big ones that might need re-thinking.
> 
> table.descrCorr <- as.data.frame(as.table(descrCorr))

> table.descrCorr <- table.descrCorr[which(table.descrCorr$Var1 != table.descrCorr$Var2),]

> table.descrCorr[order(abs(table.descrCorr$Freq), decreasing = TRUE),]
              Var1           Var2         Freq
10      DEPRANKGRP      SKDDEPSTA  0.585062502
118      SKDDEPSTA     DEPRANKGRP  0.585062502
7     DEPSTAATCIMP      SKDDEPSTA  0.484804073
79       SKDDEPSTA   DEPSTAATCIMP  0.484804073
72    DEPSTAATCIMP   UPLINEATCIMP -0.480791418
84    UPLINEATCIMP   DEPSTAATCIMP -0.480791418
21  DOWNLINEATCIMP      SKDARRSTA  0.434797243
93       SKDARRSTA DOWNLINEATCIMP  0.434797243
86  DOWNLINEATCIMP   DEPSTAATCIMP -0.385976171
98    DEPSTAATCIMP DOWNLINEATCIMP -0.385976171
73  DOWNLINEATCIMP   UPLINEATCIMP  0.363095078
97    UPLINEATCIMP DOWNLINEATCIMP  0.363095078
8   DOWNLINEATCIMP      SKDDEPSTA -0.354153144
92       SKDDEPSTA DOWNLINEATCIMP -0.354153144
100      ARRBUCKET DOWNLINEATCIMP  0.330120221
112 DOWNLINEATCIMP      ARRBUCKET  0.330120221
20    DEPSTAATCIMP      SKDARRSTA -0.279028496
80       SKDARRSTA   DEPSTAATCIMP -0.279028496
101     DEPRANKGRP DOWNLINEATCIMP -0.269803961
125 DOWNLINEATCIMP     DEPRANKGRP -0.269803961
19    UPLINEATCIMP      SKDARRSTA  0.264657060
67       SKDARRSTA   UPLINEATCIMP  0.264657060
2        SKDARRSTA      SKDDEPSTA -0.261984855
14       SKDDEPSTA      SKDARRSTA -0.261984855
102     ARRRANKGRP DOWNLINEATCIMP -0.250417711
138 DOWNLINEATCIMP     ARRRANKGRP -0.250417711
6     UPLINEATCIMP      SKDDEPSTA -0.239643735
66       SKDDEPSTA   UPLINEATCIMP -0.239643735
91    xAVGSKDAVAIL   DEPSTAATCIMP -0.222706877
163   DEPSTAATCIMP   xAVGSKDAVAIL -0.222706877
103         xDURN2 DOWNLINEATCIMP -0.221781577
151 DOWNLINEATCIMP         xDURN2 -0.221781577
78    xAVGSKDAVAIL   UPLINEATCIMP  0.219674015
162   UPLINEATCIMP   xAVGSKDAVAIL  0.219674015
30          SKDEPS         SKDEQP  0.210956794
42          SKDEQP         SKDEPS  0.210956794
12          xDURN2      SKDDEPSTA  0.187430706
144      SKDDEPSTA         xDURN2  0.187430706
115     ARRRANKGRP      ARRBUCKET -0.187028885
139      ARRBUCKET     ARRRANKGRP -0.187028885
142         xDURN2     ARRRANKGRP  0.185835094
154     ARRRANKGRP         xDURN2  0.185835094
129         xDURN2     DEPRANKGRP  0.184991436
153     DEPRANKGRP         xDURN2  0.184991436
60  DOWNLINEATCIMP      AVGLOFATC -0.181924349
96       AVGLOFATC DOWNLINEATCIMP -0.181924349
128     ARRRANKGRP     DEPRANKGRP  0.177915590
140     DEPRANKGRP     ARRRANKGRP  0.177915590
77          xDURN2   UPLINEATCIMP -0.174824454
149   UPLINEATCIMP         xDURN2 -0.174824454
23      DEPRANKGRP      SKDARRSTA -0.167141066
119      SKDARRSTA     DEPRANKGRP -0.167141066
3           SKDEQP      SKDDEPSTA  0.164894903
27       SKDDEPSTA         SKDEQP  0.164894903
61       ARRBUCKET      AVGLOFATC -0.158812104
109      AVGLOFATC      ARRBUCKET -0.158812104
114     DEPRANKGRP      ARRBUCKET -0.154476581
126      ARRBUCKET     DEPRANKGRP -0.154476581
36      DEPRANKGRP         SKDEQP  0.152214336
120         SKDEQP     DEPRANKGRP  0.152214336
116         xDURN2      ARRBUCKET -0.145215791
152      ARRBUCKET         xDURN2 -0.145215791
117   xAVGSKDAVAIL      ARRBUCKET -0.144677002
165      ARRBUCKET   xAVGSKDAVAIL -0.144677002
130   xAVGSKDAVAIL     DEPRANKGRP  0.142956616
166     DEPRANKGRP   xAVGSKDAVAIL  0.142956616
59    DEPSTAATCIMP      AVGLOFATC -0.141107173
83       AVGLOFATC   DEPSTAATCIMP -0.141107173
74       ARRBUCKET   UPLINEATCIMP  0.140056918
110   UPLINEATCIMP      ARRBUCKET  0.140056918
88      DEPRANKGRP   DEPSTAATCIMP  0.139329660
124   DEPSTAATCIMP     DEPRANKGRP  0.139329660
18       AVGLOFATC      SKDARRSTA -0.126735710
54       SKDARRSTA      AVGLOFATC -0.126735710
16          SKDEQP      SKDARRSTA  0.126617684
28       SKDARRSTA         SKDEQP  0.126617684
11      ARRRANKGRP      SKDDEPSTA  0.116715200
131      SKDDEPSTA     ARRRANKGRP  0.116715200
46    DEPSTAATCIMP         SKDEPS -0.115428724
82          SKDEPS   DEPSTAATCIMP -0.115428724
22       ARRBUCKET      SKDARRSTA  0.111222093
106      SKDARRSTA      ARRBUCKET  0.111222093
75      DEPRANKGRP   UPLINEATCIMP -0.109652113
123   UPLINEATCIMP     DEPRANKGRP -0.109652113
4           SKDEPS      SKDDEPSTA -0.103573343
40       SKDDEPSTA         SKDEPS -0.103573343
9        ARRBUCKET      SKDDEPSTA -0.103178190
105      SKDDEPSTA      ARRBUCKET -0.103178190
58    UPLINEATCIMP      AVGLOFATC -0.099921957
70       AVGLOFATC   UPLINEATCIMP -0.099921957
48       ARRBUCKET         SKDEPS -0.093262124
108         SKDEPS      ARRBUCKET -0.093262124
64          xDURN2      AVGLOFATC -0.089998526
148      AVGLOFATC         xDURN2 -0.089998526
52    xAVGSKDAVAIL         SKDEPS  0.083630672
160         SKDEPS   xAVGSKDAVAIL  0.083630672
50      ARRRANKGRP         SKDEPS  0.081740209
134         SKDEPS     ARRRANKGRP  0.081740209
47  DOWNLINEATCIMP         SKDEPS -0.081550414
95          SKDEPS DOWNLINEATCIMP -0.081550414
87       ARRBUCKET   DEPSTAATCIMP -0.076383973
111   DEPSTAATCIMP      ARRBUCKET -0.076383973
17          SKDEPS      SKDARRSTA -0.076186486
41       SKDARRSTA         SKDEPS -0.076186486
63      ARRRANKGRP      AVGLOFATC -0.075502916
135      AVGLOFATC     ARRRANKGRP -0.075502916
62      DEPRANKGRP      AVGLOFATC  0.073089053
122      AVGLOFATC     DEPRANKGRP  0.073089053
104   xAVGSKDAVAIL DOWNLINEATCIMP  0.069107989
164 DOWNLINEATCIMP   xAVGSKDAVAIL  0.069107989
24      ARRRANKGRP      SKDARRSTA  0.063294417
132      SKDARRSTA     ARRRANKGRP  0.063294417
5        AVGLOFATC      SKDDEPSTA -0.049562063
53       SKDDEPSTA      AVGLOFATC -0.049562063
51          xDURN2         SKDEPS  0.046951938
147         SKDEPS         xDURN2  0.046951938
45    UPLINEATCIMP         SKDEPS  0.045346781
69          SKDEPS   UPLINEATCIMP  0.045346781
76      ARRRANKGRP   UPLINEATCIMP  0.043157477
136   UPLINEATCIMP     ARRRANKGRP  0.043157477
34  DOWNLINEATCIMP         SKDEQP -0.041016354
94          SKDEQP DOWNLINEATCIMP -0.041016354
38          xDURN2         SKDEQP  0.039910387
146         SKDEQP         xDURN2  0.039910387
65    xAVGSKDAVAIL      AVGLOFATC -0.033981120
161      AVGLOFATC   xAVGSKDAVAIL -0.033981120
89      ARRRANKGRP   DEPSTAATCIMP  0.032959657
137   DEPSTAATCIMP     ARRRANKGRP  0.032959657
156   xAVGSKDAVAIL         xDURN2 -0.031789386
168         xDURN2   xAVGSKDAVAIL -0.031789386
39    xAVGSKDAVAIL         SKDEQP  0.029020869
159         SKDEQP   xAVGSKDAVAIL  0.029020869
37      ARRRANKGRP         SKDEQP -0.028886971
133         SKDEQP     ARRRANKGRP -0.028886971
26    xAVGSKDAVAIL      SKDARRSTA  0.024887817
158      SKDARRSTA   xAVGSKDAVAIL  0.024887817
143   xAVGSKDAVAIL     ARRRANKGRP -0.022846170
167     ARRRANKGRP   xAVGSKDAVAIL -0.022846170
13    xAVGSKDAVAIL      SKDDEPSTA  0.022173013
157      SKDDEPSTA   xAVGSKDAVAIL  0.022173013
90          xDURN2   DEPSTAATCIMP  0.013934108
150   DEPSTAATCIMP         xDURN2  0.013934108
49      DEPRANKGRP         SKDEPS -0.013622262
121         SKDEPS     DEPRANKGRP -0.013622262
25          xDURN2      SKDARRSTA -0.012137713
145      SKDARRSTA         xDURN2 -0.012137713
44       AVGLOFATC         SKDEPS  0.008864044
56          SKDEPS      AVGLOFATC  0.008864044
32    UPLINEATCIMP         SKDEQP  0.006900743
68          SKDEQP   UPLINEATCIMP  0.006900743
31       AVGLOFATC         SKDEQP -0.006110755
55          SKDEQP      AVGLOFATC -0.006110755
35       ARRBUCKET         SKDEQP -0.005395458
107         SKDEQP      ARRBUCKET -0.005395458
33    DEPSTAATCIMP         SKDEQP  0.002281473
81          SKDEQP   DEPSTAATCIMP  0.002281473

> ### Models
> 
> ## Try GBM (gradient boosting). Works well for mixed data.
> ## And there is a tutorial for it with caret.
> 
> ## Training controller and big grid
> ## Check the ROC (my preferred.)
> 
> fitControl <- trainControl(## 10-fold CV
+     method = "repeatedcv",
+     number = 10,
+     .... [TRUNCATED] 

> ## Some trial and error with variables to branch and boost.
> ## I'm just going to try the airports and the planes and the duration
> ## of the flight. There may be some distance relationship there that
> ## air traffic control use.
> 
> ## Annoying because I drop variables, this needs to be looke .... [TRUNCATED] 

> tr.cols
 [1] "SKDDEPSTA"      "SKDARRSTA"      "SKDEQP"         "SKDEPS"        
 [5] "AVGLOFATC"      "UPLINEATCIMP"   "DEPSTAATCIMP"   "DOWNLINEATCIMP"
 [9] "ARRBUCKET"      "DEPRANKGRP"     "ARRRANKGRP"     "xDURN2"        
[13] "xAVGSKDAVAIL"  

> tr.icols <- grep("((STA|EQP)$)|(^xD)", tr.cols)

> tr.icols <- rev(tr.icols)

> gbmGrid <- expand.grid(interaction.depth = tr.icols,
+                         n.trees = (1:30)*90,
+                         shrinkage = 0.1,
+                         n.minobsinnode = 20)

> set.seed(seed.mine)

> gbmFit1 <- train(trainDescr, trainClass,
+                  method = "gbm",
+                  trControl = fitControl,
+                  ## This last option is actually one
+                  ## for gbm() that passes through
+                  tuneGrid = gbmGrid,
+                  metric = "ROC" .... [TRUNCATED] 
Loading required package: gbm
Loading required package: survival

Attaching package: 'survival'

The following object is masked from 'package:caret':

    cluster

Loading required package: splines
Loaded gbm 2.1.1
Loading required package: plyr

> gbmFit1
Stochastic Gradient Boosting 

209 samples
 13 predictor
  2 classes: 'Strong', 'Weak' 

No pre-processing
Resampling: Cross-Validated (10 fold, repeated 10 times) 

Summary of sample sizes: 188, 189, 189, 188, 187, 187, ... 

Resampling results across tuning parameters:

  interaction.depth  n.trees  ROC        Sens       Spec       ROC SD    
   1                   90     0.8052130  0.6434444  0.8043182  0.10799201
   1                  180     0.8035800  0.6533333  0.7835606  0.09548318
   1                  270     0.7950859  0.6562222  0.7757576  0.09810573
   1                  360     0.7851153  0.6445556  0.7560606  0.10635870
   1                  450     0.7854024  0.6523333  0.7576515  0.10225473
   1                  540     0.7854554  0.6507778  0.7438636  0.09437604
   1                  630     0.7815724  0.6533333  0.7516667  0.09811955
   1                  720     0.7763653  0.6508889  0.7439394  0.09871516
   1                  810     0.7735581  0.6620000  0.7401515  0.09889700
   1                  900     0.7743729  0.6493333  0.7403030  0.09397323
   1                  990     0.7730269  0.6567778  0.7400000  0.09320800
   1                 1080     0.7697163  0.6478889  0.7350000  0.09276792
   1                 1170     0.7665918  0.6414444  0.7439394  0.09485351
   1                 1260     0.7660253  0.6351111  0.7340909  0.10003273
   1                 1350     0.7597761  0.6415556  0.7428030  0.10568854
   1                 1440     0.7594983  0.6420000  0.7375000  0.09966823
   1                 1530     0.7592837  0.6415556  0.7324242  0.10241857
   1                 1620     0.7576111  0.6374444  0.7381061  0.10072406
   1                 1710     0.7522635  0.6353333  0.7374242  0.11081613
   1                 1800     0.7529285  0.6364444  0.7262121  0.10075030
   1                 1890     0.7547340  0.6362222  0.7323485  0.09294794
   1                 1980     0.7522576  0.6386667  0.7354545  0.09743972
   1                 2070     0.7510943  0.6415556  0.7278788  0.10493207
   1                 2160     0.7501810  0.6331111  0.7270455  0.10169597
   1                 2250     0.7524082  0.6364444  0.7193182  0.10023037
   1                 2340     0.7497542  0.6344444  0.7159091  0.10004356
   1                 2430     0.7503721  0.6405556  0.7175758  0.09265081
   1                 2520     0.7490135  0.6374444  0.7148485  0.10324272
   1                 2610     0.7501911  0.6387778  0.7114394  0.09539009
   1                 2700     0.7484832  0.6364444  0.7124242  0.09514993
   2                   90     0.8083577  0.6597778  0.7794697  0.08731123
   2                  180     0.7897374  0.6531111  0.7557576  0.10248585
   2                  270     0.7835337  0.6521111  0.7578788  0.09883789
   2                  360     0.7795093  0.6436667  0.7515152  0.09186345
   2                  450     0.7791944  0.6358889  0.7478030  0.09112458
   2                  540     0.7688207  0.6394444  0.7437121  0.10683444
   2                  630     0.7649251  0.6304444  0.7435606  0.10446893
   2                  720     0.7607660  0.6363333  0.7401515  0.10535391
   2                  810     0.7599865  0.6394444  0.7334091  0.10555376
   2                  900     0.7602298  0.6352222  0.7382576  0.10707535
   2                  990     0.7599116  0.6350000  0.7338636  0.10030388
   2                 1080     0.7583476  0.6382222  0.7313636  0.10321239
   2                 1170     0.7587340  0.6338889  0.7306061  0.09738346
   2                 1260     0.7605126  0.6361111  0.7306061  0.09566843
   2                 1350     0.7575051  0.6362222  0.7331818  0.09666182
   2                 1440     0.7572887  0.6370000  0.7298485  0.09934764
   2                 1530     0.7585749  0.6360000  0.7297727  0.09612526
   2                 1620     0.7551684  0.6348889  0.7332576  0.10070739
   2                 1710     0.7554125  0.6370000  0.7366667  0.09910638
   2                 1800     0.7530875  0.6306667  0.7393182  0.10344470
   2                 1890     0.7539487  0.6328889  0.7332576  0.10257209
   2                 1980     0.7528418  0.6360000  0.7360606  0.10222263
   2                 2070     0.7526776  0.6295556  0.7373485  0.10234769
   2                 2160     0.7521692  0.6337778  0.7358333  0.10239971
   2                 2250     0.7519823  0.6307778  0.7365152  0.10157762
   2                 2340     0.7510833  0.6293333  0.7392424  0.10349976
   2                 2430     0.7513148  0.6303333  0.7382576  0.10392728
   2                 2520     0.7520808  0.6294444  0.7340152  0.10186765
   2                 2610     0.7519832  0.6292222  0.7358333  0.10198085
   2                 2700     0.7516810  0.6314444  0.7314394  0.10160094
   3                   90     0.7981768  0.6440000  0.7637879  0.10869580
   3                  180     0.7804217  0.6420000  0.7548485  0.10799027
   3                  270     0.7742584  0.6402222  0.7506818  0.10704864
   3                  360     0.7697820  0.6386667  0.7418182  0.10733863
   3                  450     0.7672719  0.6398889  0.7431061  0.10424576
   3                  540     0.7635808  0.6397778  0.7429545  0.09910957
   3                  630     0.7559924  0.6313333  0.7479545  0.11164937
   3                  720     0.7633645  0.6355556  0.7515909  0.09673764
   3                  810     0.7579933  0.6324444  0.7470455  0.10262027
   3                  900     0.7566582  0.6354444  0.7420455  0.10369394
   3                  990     0.7525791  0.6292222  0.7408333  0.10593356
   3                 1080     0.7543544  0.6282222  0.7435606  0.10465011
   3                 1170     0.7544158  0.6345556  0.7483333  0.10226434
   3                 1260     0.7530404  0.6356667  0.7500000  0.10243788
   3                 1350     0.7555741  0.6376667  0.7506818  0.10175991
   3                 1440     0.7562163  0.6357778  0.7531061  0.10101281
   3                 1530     0.7552534  0.6380000  0.7480303  0.10095143
   3                 1620     0.7529933  0.6390000  0.7461364  0.10198569
   3                 1710     0.7533081  0.6412222  0.7453788  0.10347174
   3                 1800     0.7516246  0.6442222  0.7506061  0.10290108
   3                 1890     0.7508628  0.6380000  0.7488636  0.10372679
   3                 1980     0.7497449  0.6325556  0.7488636  0.10349684
   3                 2070     0.7494613  0.6402222  0.7489394  0.10424587
   3                 2160     0.7476498  0.6418889  0.7453788  0.10368837
   3                 2250     0.7490724  0.6400000  0.7427273  0.10068616
   3                 2340     0.7497862  0.6410000  0.7382576  0.10040240
   3                 2430     0.7462820  0.6421111  0.7418182  0.10449342
   3                 2520     0.7459495  0.6421111  0.7412121  0.10277196
   3                 2610     0.7477399  0.6431111  0.7402273  0.10184056
   3                 2700     0.7466717  0.6408889  0.7409091  0.10214768
  12                   90     0.7976785  0.6488889  0.7629545  0.08805776
  12                  180     0.7797357  0.6575556  0.7553788  0.09848107
  12                  270     0.7789840  0.6464444  0.7543939  0.09134672
  12                  360     0.7726633  0.6484444  0.7572727  0.09835707
  12                  450     0.7727155  0.6410000  0.7504545  0.09889167
  12                  540     0.7709032  0.6475556  0.7512879  0.09657661
  12                  630     0.7658451  0.6421111  0.7548485  0.09562078
  12                  720     0.7641313  0.6400000  0.7419697  0.09705908
  12                  810     0.7614503  0.6411111  0.7420455  0.09772468
  12                  900     0.7623552  0.6411111  0.7405303  0.09776753
  12                  990     0.7592921  0.6432222  0.7433333  0.09904558
  12                 1080     0.7585311  0.6387778  0.7403788  0.09855337
  12                 1170     0.7590934  0.6411111  0.7431061  0.09731014
  12                 1260     0.7568754  0.6368889  0.7440909  0.09654773
  12                 1350     0.7568897  0.6368889  0.7475758  0.09837119
  12                 1440     0.7513577  0.6391111  0.7414394  0.10417493
  12                 1530     0.7539242  0.6377778  0.7406818  0.10104776
  12                 1620     0.7547458  0.6370000  0.7421970  0.09813161
  12                 1710     0.7537980  0.6391111  0.7404545  0.09821255
  12                 1800     0.7529057  0.6365556  0.7437879  0.09860736
  12                 1890     0.7506077  0.6421111  0.7405303  0.10465633
  12                 1980     0.7496431  0.6333333  0.7447727  0.10322867
  12                 2070     0.7492239  0.6344444  0.7414394  0.10355206
  12                 2160     0.7508544  0.6367778  0.7397727  0.10197556
  12                 2250     0.7513653  0.6400000  0.7397727  0.10219556
  12                 2340     0.7501237  0.6388889  0.7397727  0.10123531
  12                 2430     0.7502003  0.6345556  0.7355303  0.10149926
  12                 2520     0.7493998  0.6356667  0.7389394  0.10207323
  12                 2610     0.7488779  0.6334444  0.7379545  0.10188311
  12                 2700     0.7481380  0.6281111  0.7371212  0.10121741
  Sens SD    Spec SD  
  0.1428348  0.1228136
  0.1477773  0.1211512
  0.1427101  0.1261616
  0.1456309  0.1163013
  0.1378608  0.1231880
  0.1397917  0.1266829
  0.1419143  0.1279618
  0.1298188  0.1311364
  0.1282240  0.1288329
  0.1323412  0.1331896
  0.1330890  0.1269535
  0.1265157  0.1314542
  0.1322332  0.1264416
  0.1334149  0.1337344
  0.1399911  0.1271063
  0.1327295  0.1252594
  0.1294575  0.1262207
  0.1310091  0.1262546
  0.1307110  0.1245905
  0.1310892  0.1266661
  0.1249279  0.1175855
  0.1340932  0.1242385
  0.1367740  0.1223625
  0.1330429  0.1278570
  0.1297698  0.1302020
  0.1314542  0.1265034
  0.1320682  0.1307294
  0.1334330  0.1288330
  0.1375819  0.1305653
  0.1384906  0.1290820
  0.1462997  0.1255992
  0.1436574  0.1254063
  0.1387121  0.1214602
  0.1392823  0.1259500
  0.1426493  0.1228855
  0.1383671  0.1358229
  0.1423497  0.1299970
  0.1375036  0.1325632
  0.1324924  0.1347199
  0.1323387  0.1379586
  0.1343060  0.1404956
  0.1349077  0.1399323
  0.1333929  0.1327765
  0.1354248  0.1395959
  0.1351136  0.1358934
  0.1389489  0.1352376
  0.1368241  0.1474039
  0.1386610  0.1462202
  0.1385624  0.1446410
  0.1345448  0.1450011
  0.1375223  0.1469716
  0.1364773  0.1451994
  0.1383567  0.1343121
  0.1399136  0.1429458
  0.1388034  0.1373657
  0.1373190  0.1369456
  0.1392698  0.1396418
  0.1373631  0.1428332
  0.1383516  0.1398753
  0.1382110  0.1432607
  0.1541941  0.1306243
  0.1431530  0.1336130
  0.1374666  0.1328105
  0.1350662  0.1308784
  0.1334090  0.1401917
  0.1352295  0.1368443
  0.1331778  0.1339309
  0.1376590  0.1343606
  0.1359606  0.1397892
  0.1390802  0.1421761
  0.1322030  0.1386457
  0.1387545  0.1385540
  0.1429291  0.1423196
  0.1413181  0.1429148
  0.1388397  0.1370679
  0.1390702  0.1389873
  0.1370159  0.1379050
  0.1339445  0.1427626
  0.1347409  0.1390240
  0.1343766  0.1381908
  0.1362767  0.1385791
  0.1375253  0.1377820
  0.1381995  0.1362404
  0.1379653  0.1323023
  0.1373506  0.1322322
  0.1429709  0.1301619
  0.1375166  0.1318184
  0.1393185  0.1353982
  0.1388611  0.1304285
  0.1411378  0.1298883
  0.1336509  0.1276476
  0.1390146  0.1274840
  0.1393282  0.1328326
  0.1384676  0.1331454
  0.1301404  0.1308568
  0.1303068  0.1329150
  0.1350368  0.1350072
  0.1349971  0.1346990
  0.1375004  0.1301307
  0.1375004  0.1370691
  0.1389384  0.1361478
  0.1397314  0.1371430
  0.1337769  0.1426716
  0.1368402  0.1352177
  0.1406510  0.1330232
  0.1414432  0.1315410
  0.1397716  0.1368722
  0.1369237  0.1353372
  0.1378715  0.1384756
  0.1372443  0.1388842
  0.1334856  0.1397953
  0.1426942  0.1421326
  0.1389708  0.1410022
  0.1382709  0.1423758
  0.1405989  0.1428676
  0.1372371  0.1440315
  0.1392254  0.1436112
  0.1383033  0.1408860
  0.1397493  0.1412299
  0.1410015  0.1414039

Tuning parameter 'shrinkage' was held constant at a value of 0.1

Tuning parameter 'n.minobsinnode' was held constant at a value of 20
ROC was used to select the optimal model using  the largest value.
The final values used for the model were n.trees = 90, interaction.depth =
 2, shrinkage = 0.1 and n.minobsinnode = 20. 

> ## The acid test is dissapointing, but I've seen worse.
> 
> testPred <- predict(gbmFit1, testDescr)

> postResample(testPred, testClass)
  Accuracy      Kappa 
0.54954955 0.08021213 

> confusionMatrix(testPred, testClass, positive = "Weak")
Confusion Matrix and Statistics

          Reference
Prediction Strong Weak
    Strong     22   22
    Weak       28   39
                                          
               Accuracy : 0.5495          
                 95% CI : (0.4522, 0.6441)
    No Information Rate : 0.5495          
    P-Value [Acc > NIR] : 0.5392          
                                          
                  Kappa : 0.0802          
 Mcnemar's Test P-Value : 0.4795          
                                          
            Sensitivity : 0.6393          
            Specificity : 0.4400          
         Pos Pred Value : 0.5821          
         Neg Pred Value : 0.5000          
             Prevalence : 0.5495          
         Detection Rate : 0.3514          
   Detection Prevalence : 0.6036          
      Balanced Accuracy : 0.5397          
                                          
       'Positive' Class : Weak            
                                          

> ## The training set is exact even with the correlation cut-offs
> ## As one would hope - but 
> trainPred <- predict(gbmFit1, trainDescr)

> postResample(trainPred, trainClass)
 Accuracy     Kappa 
0.8516746 0.6987492 

> confusionMatrix(trainPred, trainClass, positive = "Weak")
Confusion Matrix and Statistics

          Reference
Prediction Strong Weak
    Strong     76   14
    Weak       17  102
                                          
               Accuracy : 0.8517          
                 95% CI : (0.7961, 0.8969)
    No Information Rate : 0.555           
    P-Value [Acc > NIR] : <2e-16          
                                          
                  Kappa : 0.6987          
 Mcnemar's Test P-Value : 0.7194          
                                          
            Sensitivity : 0.8793          
            Specificity : 0.8172          
         Pos Pred Value : 0.8571          
         Neg Pred Value : 0.8444          
             Prevalence : 0.5550          
         Detection Rate : 0.4880          
   Detection Prevalence : 0.5694          
      Balanced Accuracy : 0.8483          
                                          
       'Positive' Class : Weak            
                                          
Warning messages:
1: In eval(expr, envir, enclos) : adjusting
2: In eval(expr, envir, enclos) :
  overfitting: correlations: err.trainDescr: SDEPHR, DEPBUCKET, ARRSPOKE, DEPSPOKE, AVGSQ, TRNRANKGRP, xAVAILBUCKET
> 