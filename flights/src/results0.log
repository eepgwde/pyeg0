
R version 3.2.5 (2016-04-14) -- "Very, Very Secure Dishes"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

During startup - Warning messages:
1: Setting LC_TIME failed, using "C" 
2: Setting LC_MONETARY failed, using "C" 
3: Setting LC_PAPER failed, using "C" 
4: Setting LC_MEASUREMENT failed, using "C" 
> > options(STERM='iESS', str.dendrogram.last="'", editor='emacsclient', show.error.locations=TRUE)
> ### weaves
> 
> ## Processing for flights data.
> 
> ## Following the caret vignette.
> 
> ###################################################
> ### code chunk number 1: loadLibs
> ###################################################
> library(MASS)
> library(caret)
Loading required package: lattice
Loading required package: ggplot2
> library(mlbench)
> library(pROC)
Type 'citation("pROC")' for a citation.

Attaching package: 'pROC'

The following objects are masked from 'package:stats':

    cov, smooth, var

> library(pls)

Attaching package: 'pls'

The following object is masked from 'package:caret':

    R2

The following object is masked from 'package:stats':

    loadings

> 
> library(doMC)
Loading required package: foreach
foreach: simple, scalable parallel programming from Revolution Analytics
Use Revolution R for scalability, fault tolerance and more.
http://www.revolutionanalytics.com
Loading required package: iterators
Loading required package: parallel
> registerDoMC(cores = 4)
> 
> options(useFancyQuotes = FALSE) 
> 
> # Accounting info.
> getInfo <- function(what = "Suggests")
+ {
+   text <- packageDescription("caret")[what][[1]]
+   text <- gsub("\n", ", ", text, fixed = TRUE)
+   text <- gsub(">=", "$\\\\ge$", text, fixed = TRUE)
+   eachPkg <- strsplit(text, ", ", fixed = TRUE)[[1]]
+   eachPkg <- gsub(",", "", eachPkg, fixed = TRUE)
+   # out <- paste("\\\\pkg{", eachPkg[order(tolower(eachPkg))], "}", sep = "")
+   # paste(out, collapse = ", ")
+   length(eachPkg)
+ }
> 
> ### project-specific: begin
> ## Set-seed, load original CSV file, order it
> ## and do some simple-cleaning
> ## Various datasets 
> 
> seed.mine = 107
> set.seed(seed.mine)                     # helpful for testing
> 
> flight <- read.csv("../bak/flight.csv")
> flight <- flight[order(flight$D00),]
> 
> # Backup
> flight.raw <- flight
> 
> source(file = "flight1.R")
> 
> # Some additions
> 
> flight$DEPSPOKE <- flight$DEPGRP == "Spoke"
> flight$ARRSPOKE <- flight$ARRGRP == "Spoke"
> 
> # And some deletions
> 
> t.cols <- colnames(flight)
> 
> t.drops <- t.cols[grep("^RANK*", t.cols)]
> t.drops <- c(t.drops, t.cols[grep("^(ARR|DEP)GRP$", t.cols)])
> t.drops <- c(t.drops, "D80THPCTL")
> 
> flight <- flight[ , t.cols[!(t.cols %in% t.drops)] ]
> 
> ## Let's do the flight duration logic see the flight logic the notes.
> 
> flight$xDURN <- flight$SARRHR - flight$SDEPHR
> flight$xHNGR <- flight$xDURN < 0
> 
> ## I don't think there is any hangaring. I have to clean this up.
> 
> ## Max flight time is 8 hours for the positives, but red-eyes can
> ## take longer
> 
> hr.wrap <- function(d0, a0) {
+     t0 <- a0 - d0
+     if (t0 >= 0) return(t0)
+     t0 <- 24 - d0
+     t0 <- t0 + a0
+     return(t0)
+ }
> 
> flight$xDURN2 <- apply(flight[,c("SDEPHR", "SARRHR")], 1, 
+                        function(y) hr.wrap(y['SDEPHR'], y['SARRHR']))
> 
> flight[which(flight$xDURN2 != flight$xDURN), c("SDEPHR", "SARRHR", "xDURN","xDURN2", "xHNGR")]
     SDEPHR SARRHR xDURN xDURN2 xHNGR
19       22      0   -22      2  TRUE
107      22      0   -22      2  TRUE
111      23      5   -18      6  TRUE
121      21      0   -21      3  TRUE
186      22      0   -22      2  TRUE
203      20      0   -20      4  TRUE
220      21      0   -21      3  TRUE
261      23      7   -16      8  TRUE
285      22      6   -16      8  TRUE
328      18      9    -9     15  TRUE
367      22      6   -16      8  TRUE
443      22      6   -16      8  TRUE
554      22     11   -11     13  TRUE
559      19      0   -19      5  TRUE
595      21     15    -6     18  TRUE
611      22      6   -16      8  TRUE
621      22      0   -22      2  TRUE
625      22      6   -16      8  TRUE
636      20      8   -12     12  TRUE
652      18      7   -11     13  TRUE
654      20     11    -9     15  TRUE
666      21      8   -13     11  TRUE
670      22      5   -17      7  TRUE
686      21      9   -12     12  TRUE
718      18      8   -10     14  TRUE
722      18      7   -11     13  TRUE
742      22      6   -16      8  TRUE
748      18      8   -10     14  TRUE
749      20     10   -10     14  TRUE
785      19      1   -18      6  TRUE
799      18      8   -10     14  TRUE
853      22      6   -16      8  TRUE
855      23      7   -16      8  TRUE
863      18      7   -11     13  TRUE
883      16      6   -10     14  TRUE
905      22      0   -22      2  TRUE
967      22      7   -15      9  TRUE
984      22      0   -22      2  TRUE
1011     22      6   -16      8  TRUE
1012     22      6   -16      8  TRUE
1043     23      6   -17      7  TRUE
1096     22      6   -16      8  TRUE
1148     22      5   -17      7  TRUE
1288     23      8   -15      9  TRUE
1372     23      8   -15      9  TRUE
1384     23      8   -15      9  TRUE
1386     23      5   -18      6  TRUE
1388     23      8   -15      9  TRUE
> t.cols <- colnames(flight)
> 
> t.drops <- c("SARRHR", "xDURN")
> flight <- flight[ , t.cols[!(t.cols %in% t.drops)] ]
> 
> ## Backup
> 
> flight00 <- flight
> 
> # And we drop many, many rows because R slows with large datasets.
> # These are the ranges we have been asked to predict on.
> 
> flight <- flight[flight$AVGLOFATC >= 3.1 & flight$AVGLOFATC <= 4.4,]
> 
> ## Take another copy - this is all we need as the training/prediction
> ## set.
> 
> flight1 <- flight
> 
> ## Data insights
> 
> ## Run from here.
> 
> ## Using the D00 and LEGTYPE dataset, I have this concern that D00 is
> ## a derived probit and we should ignore it.
> 
> flight <- flight1
> 
> ## So something is defining the behaviour.
> 
> ## Try to simplify structure
> 
> head(model.matrix(LEGTYPE ~ ., data = flight))
   (Intercept) SDEPHR SKDDEPSTAALB SKDDEPSTAAMS SKDDEPSTAANC SKDDEPSTAATT
2            1     14            0            0            0            0
5            1     11            0            0            0            0
7            1     14            0            0            0            0
13           1     13            0            0            0            0
14           1     16            0            0            0            0
17           1     15            0            0            0            0
   SKDDEPSTAAUA SKDDEPSTAAUS SKDDEPSTABDA SKDDEPSTABDL SKDDEPSTABNA
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTABOI SKDDEPSTABOS SKDDEPSTABRU SKDDEPSTABUF SKDDEPSTABWI
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTACCC SKDDEPSTACDG SKDDEPSTACHS SKDDEPSTACLE SKDDEPSTACMH
2             1            0            0            0            0
5             0            0            0            0            0
7             1            0            0            0            0
13            0            0            0            0            0
14            1            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTACUN SKDDEPSTADDD SKDDEPSTADEN SKDDEPSTADFW SKDDEPSTADSM
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            1            0            0            0
   SKDDEPSTADTW SKDDEPSTADUB SKDDEPSTAEWR SKDDEPSTAFCO SKDDEPSTAFLL
2             0            0            0            0            0
5             1            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAFRA SKDDEPSTAGCM SKDDEPSTAGDL SKDDEPSTAGEG SKDDEPSTAGIG
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAHNL SKDDEPSTAIAH SKDDEPSTAILM SKDDEPSTAIND SKDDEPSTAJAX
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAJFK SKDDEPSTAKOA SKDDEPSTALAS SKDDEPSTALAX SKDDEPSTALGA
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTALGB SKDDEPSTALGW SKDDEPSTALHR SKDDEPSTALIH SKDDEPSTAMAD
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAMAN SKDDEPSTAMBJ SKDDEPSTAMCI SKDDEPSTAMCO SKDDEPSTAMDT
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAMEX SKDDEPSTAMHT SKDDEPSTAMIA SKDDEPSTAMKE SKDDEPSTAMSP
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAMSY SKDDEPSTAMUC SKDDEPSTAMZT SKDDEPSTANAS SKDDEPSTAOAK
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAOGG SKDDEPSTAOMA SKDDEPSTAONT SKDDEPSTAORD SKDDEPSTAORF
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAPBI SKDDEPSTAPDX SKDDEPSTAPIT SKDDEPSTAPLS SKDDEPSTAPPP
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            1
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAPUJ SKDDEPSTAPVD SKDDEPSTAPVR SKDDEPSTAPWM SKDDEPSTARDU
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTARIC SKDDEPSTARNO SKDDEPSTAROC SKDDEPSTARSW SKDDEPSTASAN
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTASAT SKDDEPSTASEA SKDDEPSTASFO SKDDEPSTASJC SKDDEPSTASJD
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTASJO SKDDEPSTASJU SKDDEPSTASLC SKDDEPSTASMF SKDDEPSTASNA
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTASRQ SKDDEPSTASTL SKDDEPSTASTT SKDDEPSTASXM SKDDEPSTASYR
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTATLV SKDDEPSTATPA SKDDEPSTAXHP SKDDEPSTAYEG SKDDEPSTAYVR
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAYYC SKDDEPSTAZRH SKDARRSTAALB SKDARRSTAAMS SKDARRSTAANC
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAATT SKDARRSTAAUA SKDARRSTAAUS SKDARRSTABDA SKDARRSTABDL
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTABNA SKDARRSTABOI SKDARRSTABOS SKDARRSTABRU SKDARRSTABUF
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            1            0            0
17            0            0            0            0            0
   SKDARRSTABWI SKDARRSTACCC SKDARRSTACDG SKDARRSTACHS SKDARRSTACLE
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            1            0            0            0
   SKDARRSTACMH SKDARRSTACUN SKDARRSTADDD SKDARRSTADEN SKDARRSTADFW
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTADSM SKDARRSTADTW SKDARRSTADUB SKDARRSTAEWR SKDARRSTAFCO
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAFLL SKDARRSTAFRA SKDARRSTAGCM SKDARRSTAGDL SKDARRSTAGEG
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAGIG SKDARRSTAHNL SKDARRSTAIAH SKDARRSTAILM SKDARRSTAIND
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAJAX SKDARRSTAJFK SKDARRSTAKOA SKDARRSTALAS SKDARRSTALAX
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTALGA SKDARRSTALGB SKDARRSTALGW SKDARRSTALHR SKDARRSTALIH
2             0            0            0            0            0
5             0            0            0            0            0
7             1            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAMAD SKDARRSTAMAN SKDARRSTAMBJ SKDARRSTAMCI SKDARRSTAMCO
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAMDT SKDARRSTAMEX SKDARRSTAMHT SKDARRSTAMIA SKDARRSTAMKE
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAMSP SKDARRSTAMSY SKDARRSTAMUC SKDARRSTAMZT SKDARRSTANAS
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAOAK SKDARRSTAOGG SKDARRSTAOMA SKDARRSTAONT SKDARRSTAORD
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            1
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAORF SKDARRSTAPBI SKDARRSTAPDX SKDARRSTAPIT SKDARRSTAPLS
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAPPP SKDARRSTAPUJ SKDARRSTAPVD SKDARRSTAPVR SKDARRSTAPWM
2             1            0            0            0            0
5             1            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTARDU SKDARRSTARIC SKDARRSTARNO SKDARRSTAROC SKDARRSTARSW
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTASAN SKDARRSTASAT SKDARRSTASEA SKDARRSTASFO SKDARRSTASJC
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTASJD SKDARRSTASJO SKDARRSTASJU SKDARRSTASLC SKDARRSTASMF
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTASNA SKDARRSTASRQ SKDARRSTASTL SKDARRSTASTT SKDARRSTASXM
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTASYR SKDARRSTATLV SKDARRSTATPA SKDARRSTAXHP SKDARRSTAYEG
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAYVR SKDARRSTAYYC SKDARRSTAZRH SKDEQP319 SKDEQP320 SKDEQP321
2             0            0            0         0         0         0
5             0            0            0         0         0         0
7             0            0            0         0         0         1
13            0            0            0         0         0         0
14            0            0            0         0         0         1
17            0            0            0         0         0         0
   SKDEQP332 SKDEQP333 SKDEQP734 SKDEQP75E SKDEQP75H SKDEQP767 SKDEQPA01
2          0         0         1         0         0         0         0
5          0         0         0         0         0         0         0
7          0         0         0         0         0         0         0
13         0         0         1         0         0         0         0
14         0         0         0         0         0         0         0
17         0         0         0         0         0         0         0
   SKDEQPA05 SKDEQPA19 SKDEQPA21 SKDEQPE90 SKDEPS       D00    AVGSQ AVGLOFATC
2          0         0         0         0     32 0.2500000 3.258065  3.258065
5          0         0         0         1     72 0.2916667 2.986111  3.805556
7          0         0         0         0     88 0.3295455 2.551724  3.701149
13         0         0         0         0     32 0.3750000 3.000000  3.903226
14         0         0         0         0     72 0.3750000 3.295775  3.859155
17         0         0         0         0     84 0.3809524 3.939759  3.361446
   UPLINEATCIMPLow UPLINEATCIMPMed UPLINEATCIMPMedHigh UPLINEATCIMPMedLow
2                0               1                   0                  0
5                0               0                   0                  0
7                0               0                   0                  1
13               0               1                   0                  0
14               0               0                   0                  1
17               1               0                   0                  0
   DEPSTAATCIMPLow DOWNLINEATCIMPLow AVGSKDAVAIL AVAILBUCKETA05 AVAILBUCKETA10
2                0                 0   10.903226              0              1
5                1                 0    2.000000              0              0
7                0                 0    9.647059              1              0
13               0                 0   17.354839              0              0
14               0                 0   17.057143              0              0
17               0                 0   10.621951              0              1
   AVAILBUCKETA15 AVAILBUCKETA20 AVAILBUCKETA25 AVAILBUCKETA30 AVAILBUCKETA<0
2               0              0              0              0              0
5               0              0              0              0              0
7               0              0              0              0              0
13              1              0              0              0              0
14              1              0              0              0              0
17              0              0              0              0              0
   DEPBUCKETD2 DEPBUCKETD3 DEPBUCKETD4 DEPBUCKETD5 DEPBUCKETD6 DEPBUCKETD7
2            0           0           0           1           0           0
5            0           0           1           0           0           0
7            0           0           0           1           0           0
13           0           0           0           1           0           0
14           0           0           0           0           1           0
17           0           0           0           0           1           0
   DEPBUCKETD8 ARRBUCKETA2 ARRBUCKETA3 ARRBUCKETA4 ARRBUCKETA5 ARRBUCKETA6
2            0           0           0           0           0           1
5            0           0           0           0           1           0
7            0           0           0           0           0           1
13           0           0           0           0           0           1
14           0           0           0           0           0           0
17           0           0           0           0           0           1
   ARRBUCKETA7 ARRBUCKETA8 DEPRANKGRPLow DEPRANKGRPMed DEPRANKGRPMedHigh
2            0           0             1             0                 0
5            0           0             0             1                 0
7            0           0             1             0                 0
13           0           0             0             0                 0
14           1           0             1             0                 0
17           0           0             0             0                 0
   DEPRANKGRPMedLow TRNRANKGRPLow TRNRANKGRPMed TRNRANKGRPMedHigh
2                 0             1             0                 0
5                 0             1             0                 0
7                 0             1             0                 0
13                1             0             0                 0
14                0             1             0                 0
17                1             0             1                 0
   TRNRANKGRPMedLow ARRRANKGRPLow ARRRANKGRPMed ARRRANKGRPMedHigh
2                 0             0             0                 1
5                 0             0             0                 1
7                 0             0             1                 0
13                1             0             0                 0
14                0             0             0                 1
17                0             0             0                 1
   ARRRANKGRPMedLow DEPSPOKETRUE ARRSPOKETRUE xHNGRTRUE xDURN2
2                 0            0            0         0      2
5                 0            1            0         0      2
7                 0            0            1         0      2
13                1            0            1         0      2
14                0            0            1         0      2
17                0            0            0         0      2
> 
> dummies <- dummyVars(LEGTYPE ~ ., data = flight)
> flight.dum <- predict(dummies, newdata = flight)
> 
> ## It may be too big to use, but useful for inspection.
> 
> ### Numeric variables
> 
> ## Check some more numeric correlations, I haven't scaled yet.
> ## I'd cut correlations above 0.75 because of overfitting.
> 
> x1 <- as.data.frame(as.matrix(sapply(flight, class)))
> 
> flight.num <- flight[,names(x1[which(x1$V1 %in% c("numeric", "integer")),])]
> 
> flight.nzv <- nearZeroVar(flight.num, saveMetrics = TRUE)
> flight.nzv
            freqRatio percentUnique zeroVar   nzv
SDEPHR       1.038462        5.9375   FALSE FALSE
SKDEPS       1.000000       19.0625   FALSE FALSE
D00          1.166667       75.3125   FALSE FALSE
AVGSQ        6.333333       82.8125   FALSE FALSE
AVGLOFATC    1.000000       78.4375   FALSE FALSE
AVGSKDAVAIL  1.000000       87.5000   FALSE FALSE
xDURN2       1.428571        2.5000   FALSE FALSE
> 
> # annoying NA
> flight.cor <- cor(flight.num, use = "pairwise.complete.obs")
> 
> descrCorr <- findCorrelation(flight.cor, cutoff = .75, verbose=TRUE)
Considering row	 1 column	 4 value	 0.956 
  Flagging column	 1 
Considering row	 4 column	 3 value	 0.414 
Considering row	 4 column	 6 value	 0.173 
Considering row	 4 column	 7 value	 0.201 
Considering row	 4 column	 5 value	 0.103 
Considering row	 4 column	 2 value	 0.082 
Considering row	 3 column	 6 value	 0.266 
Considering row	 3 column	 7 value	 0.071 
Considering row	 3 column	 5 value	 0.114 
Considering row	 3 column	 2 value	 0.006 
Considering row	 6 column	 7 value	 0.031 
Considering row	 6 column	 5 value	 0.094 
Considering row	 6 column	 2 value	 0.067 
Considering row	 7 column	 5 value	 0.137 
Considering row	 7 column	 2 value	 0.005 
Considering row	 5 column	 2 value	 0.041 
> 
> colnames(flight.num)[descrCorr]
[1] "SDEPHR"
> 
> ## Which tells me that departure time is very highly correlated to AVGSQ.
> ## AVGSQ is average stand queue?
> 
> ### Try and impute the AVG, it might have more information than the
> ### bucket.
> 
> flight$xAVAILBUCKET <- as.numeric(gsub("^[A<]+", "", flight$AVAILBUCKET))
> 
> ## Arbitrary choice to set to -1.
> flight[which(flight$AVAILBUCKET == 'A<0'), "xAVAILBUCKET" ] <- -1
> 
> flight.na <- flight[, c("AVGSKDAVAIL", "xAVAILBUCKET")]
> 
> preProcValues <- preProcess(flight.na, method = c("knnImpute"))
> flight.na1 <- predict(preProcValues, flight.na)
> 
> flight$xAVGSKDAVAIL <- flight.na1$AVGSKDAVAIL
> 
> ## And I'll leave the centered and scale values in for now.
> ## and delete the troublesome ones
> 
> flight$AVGSKDAVAIL <- NULL
> flight$xHNGR <- NULL
> flight$AVAILBUCKET <- NULL
> 
> # This should be deleted, leave it in and the results are ideal because it defines LEGTYPE.
> flight$D00 <- NULL
> 
> ## Keep the results but don't change the order.
> outcomes.flight <- flight$LEGTYPE
> 
> flight$LEGTYPE <- NULL
> 
> ## Try converting all the factors to numerics
> 
> flight[,names(x1[which(x1$V1 %in% c("factor")),])]
Error in `[.data.frame`(flight, , names(x1[which(x1$V1 %in% c("factor")),  : 
  undefined columns selected
> 
> ## If you know your factors are definitely factors, you don't need this
> ##  asNumeric <- function(x) as.numeric(as.character(x))
> 
> factors.numeric <- function(d) modifyList(d, lapply(d[, sapply(d, is.factor)], as.numeric))
> 
> flight.num0 <- factors.numeric(flight)
> 
> flight.scl0 <- scale(flight.num0)
> 
> ## Now split the results
> 
> inTrain <- createDataPartition(outcomes.flight, p = 0.75, list = FALSE)
> 
> trainDescr <- flight.scl0[inTrain,]
> testDescr <- flight.scl0[-inTrain,]
> 
> trainClass <- outcomes.flight[inTrain]
> testClass <- outcomes.flight[-inTrain]
> 
> prop.table(table(flight.scl0))
flight.scl0
    -2.99546983996958     -2.98604368384811     -2.82110052361751 
           0.00281250            0.00015625            0.00015625 
    -2.64037641778924     -2.37742331516569     -2.09431321436608 
           0.00015625            0.00015625            0.00031250 
    -2.02525208119049     -2.02364615961949     -1.96706162425765 
           0.00046875            0.00093750            0.00015625 
    -1.94787383036273     -1.91934227796699     -1.87162293167633 
           0.00125000            0.00015625            0.00015625 
    -1.80813803757891      -1.8064397520718     -1.76880294648328 
           0.00093750            0.00093750            0.00453125 
     -1.7104004231695     -1.67620690253875     -1.63572266525187 
           0.00312500            0.00015625            0.00078125 
    -1.60554554037119     -1.58829697245811     -1.58375887562806 
           0.00265625            0.00062500            0.00031250 
    -1.56068940274137     -1.55266802930898     -1.55257138616628 
           0.00593750            0.00015625            0.00015625 
    -1.54865734259279     -1.54635333101763     -1.54295794614133 
           0.00015625            0.00015625            0.00015625 
    -1.53179508600425     -1.53074294246617     -1.50769426210174 
           0.00203125            0.00015625            0.00015625 
    -1.49330986644838     -1.47983129638045     -1.47646498237513 
           0.00015625            0.00171875            0.00015625 
    -1.44796824755814     -1.43812707979848     -1.43616463590287 
           0.00015625            0.00031250            0.00015625 
     -1.4311495031078     -1.42786750675664     -1.42754311366228 
           0.00062500            0.00031250            0.00015625 
     -1.4230237164245     -1.42196682798086     -1.40691590144974 
           0.00015625            0.00015625            0.00750000 
    -1.40295304316347     -1.39839761187043     -1.38337483337197 
           0.00343750            0.00015625            0.00015625 
    -1.37828409873765     -1.37590371713284      -1.3753288895824 
           0.00031250            0.00078125            0.00015625 
    -1.37383369560894     -1.37045453151584     -1.35466334686085 
           0.00015625            0.00015625            0.00015625 
    -1.33716625322094     -1.33398496346823     -1.33080367371552 
           0.00015625            0.00015625            0.00015625 
    -1.32393992750903      -1.3160853172316     -1.31578091655701 
           0.00093750            0.00015625            0.00015625 
    -1.31443367614047      -1.3133256164209     -1.30151560934568 
           0.00015625            0.00015625            0.00015625 
    -1.30111163600234     -1.29600486257245     -1.28619597667342 
           0.00015625            0.00031250            0.00031250 
    -1.28367748081635     -1.28186181839242      -1.2799413346293 
           0.00031250            0.00015625            0.00015625 
    -1.27197613788523     -1.26773489691459      -1.2671778786613 
           0.00109375            0.00015625            0.00015625 
     -1.2615812276646     -1.25974760485758     -1.25283365916062 
           0.00031250            0.00078125            0.00015625 
    -1.25178454113998     -1.24659260411695     -1.24079645146543 
           0.00015625            0.00015625            0.00015625 
     -1.2302338686483     -1.23020377865797      -1.2268968080815 
           0.00015625            0.00687500            0.00031250 
    -1.22001234826142     -1.21809512250389     -1.21512040999215 
           0.00046875            0.00015625            0.00015625 
    -1.21024953572476     -1.20647153886774     -1.20560405725029 
           0.00015625            0.00015625            0.00015625 
    -1.20188627600106     -1.20036054595575     -1.20011285144544 
           0.00031250            0.00140625            0.00015625 
    -1.19042311450129     -1.18991798468508     -1.18966337127103 
           0.00015625            0.00015625            0.00062500 
    -1.16804855863761     -1.16764210792351     -1.16749679150174 
           0.00093750            0.00015625            0.00015625 
    -1.16258400593847     -1.16018257780086     -1.15839829359119 
           0.00015625            0.00640625            0.00015625 
    -1.14179763548495     -1.13992628855288     -1.13935994002253 
           0.00015625            0.00031250            0.00031250 
    -1.13310730700243     -1.13102279477938     -1.12993289335973 
           0.00015625            0.00015625            0.00015625 
    -1.12915754122589     -1.12753063368423     -1.12667091460446 
           0.00015625            0.00015625            0.00015625 
    -1.12622940836933     -1.12368140470519     -1.12361616254288 
           0.00031250            0.00015625            0.00062500 
    -1.12145428351456     -1.11910330109794     -1.11800948418703 
           0.00015625            0.00015625            0.00015625 
    -1.11608476901381     -1.11429923219746     -1.09261479989672 
           0.00062500            0.00015625            0.00015625 
    -1.09084552937417     -1.09012044993392      -1.0895833019642 
           0.00015625            0.00015625            0.00031250 
    -1.08549109658463     -1.06938028371369     -1.06604781193988 
           0.00031250            0.00015625            0.00015625 
    -1.06587003530766        -1.06412097939     -1.05534288054392 
           0.00015625            0.00046875            0.00015625 
    -1.04945721011816     -1.04845626690162     -1.04766888572427 
           0.00015625            0.00015625            0.00015625 
    -1.04755297964098     -1.04598728075964     -1.04536609890991 
           0.00031250            0.00031250            0.00031250 
    -1.02993885350447     -1.02151758080685     -1.01733580186582 
           0.00015625            0.00203125            0.02453125 
    -1.01577847702439      -1.0138904262493      -1.0121571897662 
           0.00015625            0.00015625            0.00062500 
    -1.00929178081963     -1.00745946934895     -1.00714202059705 
           0.00015625            0.00015625            0.00015625 
    -1.00664275166081     -1.00407661804032     -1.00110637205939 
           0.00046875            0.00015625            0.00015625 
   -0.997768048748026    -0.991929422812267    -0.989060788495757 
           0.00328125            0.00015625            0.00031250 
    -0.98572380365604    -0.979554261682366    -0.976324799963229 
           0.00015625            0.00031250            0.00875000 
   -0.973173077974651    -0.971118460177678     -0.96975725707502 
           0.01640625            0.00015625            0.00015625 
   -0.963461694934854    -0.961159884505833    -0.960193400142389 
           0.00015625            0.00015625            0.00046875 
   -0.958010282948452    -0.957720936633644    -0.955230663538487 
           0.00015625            0.00015625            0.00015625 
   -0.953451859649493    -0.952397629449069    -0.951677411170411 
           0.00031250            0.00015625            0.01765625 
   -0.947281520180146    -0.946066444247069    -0.942123167843126 
           0.00015625            0.00015625            0.00015625 
   -0.941185041055857    -0.939666457415937    -0.937914389255748 
           0.00015625            0.00031250            0.00015625 
   -0.937428692031181    -0.937143144639067    -0.929006249994557 
           0.00015625            0.00203125            0.00031250 
   -0.928956547037233    -0.927234345076844    -0.926325405165677 
           0.00015625            0.00015625            0.00015625 
   -0.926208874394783     -0.92432711582923    -0.923751900565718 
           0.00015625            0.00015625            0.00015625 
   -0.921447647976772    -0.920026610901552    -0.919775930100724 
           0.00015625            0.00015625            0.00031250 
   -0.919418999070816    -0.918979533540974    -0.918834367344145 
           0.00093750            0.00015625            0.00015625 
   -0.918602057207572    -0.918233359080158    -0.916620305783416 
           0.00015625            0.00015625            0.00031250 
   -0.908229610518583    -0.907879271266391    -0.907626204980156 
           0.00031250            0.00015625            0.00015625 
   -0.906631706666217    -0.905610577820333    -0.905104725277818 
           0.00015625            0.00015625            0.00015625 
   -0.904170844231002    -0.902563699445797    -0.902495470961171 
           0.00031250            0.00015625            0.00046875 
   -0.902207570970879    -0.900277820755885    -0.900269127160796 
           0.00015625            0.00609375            0.00015625 
   -0.900105713501894    -0.897103060359799    -0.896252308815885 
           0.00015625            0.00015625            0.00015625 
   -0.895759768448355    -0.895685333371447    -0.891948830933419 
           0.00015625            0.00015625            0.00015625 
   -0.891482707849845     -0.89086838304768    -0.889814536282523 
           0.00015625            0.02343750            0.00015625 
   -0.886894039811436    -0.885423108336021    -0.885386138492139 
           0.00093750            0.00015625            0.01593750 
   -0.884574764423174    -0.881181388644532    -0.881133728915611 
           0.00015625            0.00015625            0.00015625 
   -0.879323305434347    -0.878872666379052    -0.877901133624378 
           0.00015625            0.00015625            0.00015625 
   -0.876749332956921    -0.876685019263073    -0.875765771148607 
           0.00031250            0.00015625            0.00031250 
   -0.875473779114446     -0.87537693015952    -0.872246314823305 
           0.00015625            0.00015625            0.00015625 
   -0.871001261435858    -0.870353841103083    -0.869162583211394 
           0.00015625            0.00015625            0.00015625 
   -0.866780745576637    -0.866244907634358    -0.858819232798091 
           0.00015625            0.00015625            0.00015625 
   -0.856265820894777    -0.844253476212177    -0.844066341550782 
           0.00078125            0.00015625            0.00015625 
   -0.842025743633279    -0.831738843759029    -0.830837909586882 
           0.02921875            0.00015625            0.02515625 
   -0.829374923233683    -0.828920190368225    -0.827915178181078 
           0.00015625            0.00093750            0.00015625 
   -0.827728686266157    -0.826039032973297    -0.822416105203804 
           0.00015625            0.00015625            0.00015625 
   -0.821797313281808    -0.819285769008092    -0.816336564086851 
           0.00015625            0.00015625            0.00015625 
   -0.814051297945908    -0.811605617460827    -0.809148421270981 
           0.00015625            0.00015625            0.00015625 
   -0.804302031270971    -0.800154571238789    -0.795175551540305 
           0.00062500            0.00015625            0.00171875 
   -0.792845872277945    -0.790185643279993    -0.789212464897955 
           0.02015625            0.00859375            0.00046875 
   -0.787996109659257    -0.785742695872334    -0.783287556756109 
           0.00015625            0.00015625            0.00015625 
    -0.78222517242437    -0.777611190965241    -0.777259256743858 
           0.00015625            0.00015625            0.00015625 
   -0.775052088417874    -0.768725111385422      -0.7653899578722 
           0.00031250            0.00015625            0.00015625 
   -0.764328853007072    -0.759372004638613    -0.759121665238872 
           0.00015625            0.00015625            0.00015625 
   -0.758171518227594    -0.752387355098689    -0.752338241647165 
           0.00015625            0.00015625            0.00031250 
   -0.751716727129916    -0.750007134146443    -0.748171465050933 
           0.00015625            0.00562500            0.00015625 
   -0.743693425437366     -0.74226506946404    -0.738477819728135 
           0.00718750            0.00015625            0.00015625 
   -0.735940818773818    -0.734501921638923    -0.723911474638978 
           0.00015625            0.00015625            0.00015625 
   -0.720697236097384    -0.718445199078953    -0.715142805531928 
           0.00031250            0.00015625            0.00031250 
   -0.713461500253351    -0.710452171936934    -0.708684788599593 
           0.00015625            0.00015625            0.00015625 
   -0.708003561812545    -0.702080356630785     -0.70037445202336 
           0.00015625            0.00015625            0.00203125 
    -0.69602539257426     -0.69280361708918    -0.687853983052082 
           0.00015625            0.03375000            0.00015625 
    -0.68694861300278    -0.684622918007104    -0.682222958529648 
           0.00015625            0.00015625            0.00015625 
   -0.681188975020078    -0.673798181086569     -0.66884926915034 
           0.00187500            0.00015625            0.00015625 
     -0.6653122497357    -0.654779601264497    -0.648410662399554 
           0.00015625            0.00015625            0.00078125 
   -0.647068571912601    -0.646559789740211    -0.633905116384853 
           0.00015625            0.00015625            0.00015625 
   -0.633276439235621    -0.626480919280269    -0.624813955253419 
           0.00015625            0.00015625            0.00015625 
   -0.621563193776932    -0.615573756562581    -0.613123253862724 
           0.00015625            0.00015625            0.00171875 
   -0.604038319371604    -0.596446872775748    -0.596237216599971 
           0.00015625            0.00046875            0.00015625 
   -0.596137826610777    -0.592583054332584    -0.590968847296576 
           0.00015625            0.00359375            0.00015625 
   -0.581016668721787     -0.57842864719944    -0.577046832499099 
           0.00015625            0.00015625            0.00015625 
   -0.576399963736262    -0.567294133064953    -0.562646449882806 
           0.00187500            0.00015625            0.00031250 
   -0.559949234902497    -0.553868745195444    -0.551562209118441 
           0.00031250            0.00015625            0.00859375 
   -0.548486073402725    -0.545057532705371    -0.544483083151942 
           0.00015625            0.00046875            0.00093750 
   -0.543553164656681    -0.542887786706365    -0.542791834600063 
           0.00015625            0.00015625            0.03859375 
   -0.535816263171991    -0.529620965141671    -0.523583345339874 
           0.00031250            0.00015625            0.00015625 
   -0.522876883678594    -0.515144874010522    -0.511242837482551 
           0.00015625            0.00015625            0.00015625 
   -0.511062050911504    -0.509452501139644    -0.507981951223969 
           0.00500000            0.00015625            0.00015625 
   -0.506004946851197    -0.504251327555701    -0.503668338010739 
           0.00015625            0.00203125            0.00015625 
   -0.497665904683127    -0.492519293528136    -0.488304476973275 
           0.00015625            0.00062500            0.00015625 
   -0.486275884354524    -0.480531685495119    -0.479070530598709 
           0.00015625            0.00015625            0.00015625 
   -0.476991811548017    -0.475764665500524    -0.473473045518126 
           0.00078125            0.00015625            0.00015625 
   -0.472612890303562    -0.464757185992567    -0.456186401194196 
           0.00015625            0.00015625            0.00015625 
   -0.454553689487183    -0.453074332488957    -0.452195518537862 
           0.00015625            0.00015625            0.00015625 
   -0.450040882361118    -0.446015592229304    -0.443168278929009 
           0.00015625            0.00015625            0.00015625 
    -0.44055550390433    -0.439275967288811    -0.439064986884659 
           0.00093750            0.00015625            0.00031250 
   -0.436572045333686    -0.433356062339654     -0.43210269137514 
           0.00015625            0.00015625            0.00031250 
   -0.429159183376661     -0.42811270638386    -0.424489571114943 
           0.00015625            0.00015625            0.00015625 
   -0.424136094192972    -0.422368710855631    -0.422286506964679 
           0.00015625            0.00015625            0.00015625 
     -0.4217879739841     -0.42160028367728    -0.408926090390664 
           0.00015625            0.00015625            0.00062500 
   -0.406238662084726    -0.405337563546837    -0.402845924603104 
           0.00015625            0.00015625            0.00015625 
   -0.398392401687235    -0.392753100892855    -0.392721940787981 
           0.00015625            0.00015625            0.00015625 
   -0.389990557124863    -0.383778543291898    -0.381829344162238 
           0.00203125            0.00031250            0.00031250 
   -0.378610740922975    -0.377352421209284     -0.37278098800314 
           0.00015625            0.00015625            0.00015625 
   -0.368704530397105    -0.364033384865912    -0.363121805899083 
           0.00015625            0.00015625            0.00015625 
   -0.361905601371654    -0.360992312891898     -0.36077985218898 
           0.00015625            0.00015625            0.00015625 
    -0.35995405519458    -0.354602189779798    -0.354221703071568 
           0.00046875            0.00015625            0.00015625 
   -0.354125613590753     -0.35383985286255    -0.350820163721666 
           0.00015625            0.00015625            0.00015625 
   -0.347880750045415    -0.347682518083072    -0.344794514479224 
           0.00031250            0.00015625            0.00015625 
   -0.344246401931106    -0.340586009596143    -0.338241270869783 
           0.00015625            0.00015625            0.00031250 
   -0.336627924656718    -0.333999550987416    -0.331679860754818 
           0.00015625            0.00015625            0.00015625 
   -0.327473828580897    -0.325591270635287    -0.320604647133837 
           0.00015625            0.00015625            0.00015625 
   -0.320293393650012    -0.318998347766866    -0.313800886365509 
           0.00015625            0.00015625            0.00015625 
   -0.308729731711204     -0.30775968479621    -0.307488803472333 
           0.00015625            0.00062500            0.00015625 
   -0.305912488397539    -0.300040013990283    -0.299281804870489 
           0.00015625            0.00015625            0.00015625 
   -0.297576089117692    -0.294612153988498    -0.290886990303406 
           0.00015625            0.00015625            0.00015625 
   -0.289476667647491    -0.287805419014019    -0.284664135032912 
           0.00015625            0.00031250            0.00062500 
   -0.283279035792871    -0.278947445070673    -0.278430676385642 
           0.00015625            0.00015625            0.01140625 
   -0.277028655971768    -0.274352800845479    -0.269810489634915 
           0.00015625            0.00015625            0.00875000 
   -0.268327804913194    -0.264273008183568    -0.263991250766728 
           0.00015625            0.00015625            0.00015625 
   -0.263633329101249    -0.256569345435893    -0.255210887064625 
           0.00015625            0.00015625            0.00015625 
   -0.254264930167697    -0.253205544043426    -0.250717006205447 
           0.00015625            0.00015625            0.00015625 
   -0.250531752899298    -0.249985351299549    -0.247578088366761 
           0.00015625            0.00015625            0.00015625 
   -0.244437996150226    -0.243268618233703    -0.242824942853484 
           0.00015625            0.00015625            0.00015625 
   -0.233740722783471    -0.232700345409106    -0.232349973253986 
           0.00015625            0.00015625            0.00015625 
   -0.231815214890401    -0.231309362347886     -0.23037548130107 
           0.00015625            0.00015625            0.00015625 
   -0.228412208040947    -0.226589859802479    -0.224837647995068 
           0.00015625            0.01656250            0.00015625 
   -0.223464759128966     -0.22331717855311    -0.222588752387258 
           0.00015625            0.00015625            0.00015625 
   -0.222456945885953    -0.220222816737245    -0.217487288707678 
           0.00015625            0.00031250            0.00046875 
   -0.216388232760497    -0.213098676881504    -0.212807560710942 
           0.00015625            0.00093750            0.00015625 
   -0.205527942504415    -0.202889656333141    -0.199061273711729 
           0.00015625            0.00015625            0.00015625 
   -0.197285663071406    -0.196655198635886    -0.187398059917142 
           0.00015625            0.00015625            0.00328125 
    -0.18553936273967    -0.184426534107832      -0.1807365557853 
           0.00015625            0.00015625            0.00031250 
   -0.173455385110242    -0.170696066339926    -0.167983070845547 
           0.00953125            0.00062500            0.00015625 
    -0.16706735776498     -0.16549287956689    -0.163323851054559 
           0.00015625            0.00015625            0.00015625 
   -0.163005226779217    -0.155721964916119     -0.15557956030375 
           0.00015625            0.00015625            0.00015625 
   -0.145050220201077    -0.140627037006184    -0.136663205761249 
           0.00015625            0.00015625            0.00015625 
   -0.135547666352963    -0.135353058341049    -0.135168941442998 
           0.00015625            0.00015625            0.00015625 
    -0.13422823788067    -0.128983100398563    -0.128772766161494 
           0.00015625            0.00015625            0.00062500 
   -0.128276147190878    -0.124732071896041    -0.122750748897942 
           0.00015625            0.00015625            0.00015625 
   -0.121913567685457    -0.114572129500928    -0.113273027561381 
           0.00015625            0.00015625            0.00015625 
   -0.107405286684043    -0.105529863556612    -0.103356043915892 
           0.00015625            0.00953125            0.00015625 
  -0.0959919473132286   -0.0946576344451732   -0.0921610479659292 
           0.00015625            0.00031250            0.00015625 
  -0.0897276946329045    -0.082082912166815   -0.0820786945748793 
           0.00015625            0.00015625            0.00031250 
  -0.0807439358161152   -0.0768089765376881   -0.0759616047321375 
           0.00015625            0.00140625            0.00015625 
  -0.0741942213947964   -0.0733788467156504   -0.0726315828860554 
           0.00015625            0.00718750            0.00015625 
  -0.0685974846038955   -0.0532150311664168   -0.0498043335027671 
           0.00093750            0.00015625            0.00015625 
  -0.0497543467601004   -0.0473016251818649   -0.0451490777305966 
           0.00015625            0.00015625            0.00031250 
  -0.0446498361490209   -0.0392160026639466   -0.0373582346840002 
           0.00015625            0.00015625            0.00015625 
  -0.0352851923820555   -0.0345646240252186   -0.0326438116903773 
           0.00031250            0.00031250            0.00015625 
  -0.0248451869138821   -0.0188880173129063    -0.013807090586871 
           0.00109375            0.00015625            0.00015625 
  -0.0119657325121257   -0.0114810502208166  -0.00721676013122688 
           0.00015625            0.00015625            0.00015625 
 -0.00368424503602545 -0.000580656453063986   0.00425466589044258 
           0.00015625            0.00015625            0.00015625 
  0.00624696207963468   0.00661720265702806    0.0104887638020741 
           0.00015625            0.00015625            0.00015625 
   0.0151944372905789    0.0177528116242494    0.0194770878491831 
           0.00421875            0.00015625            0.00015625 
   0.0217087977522383    0.0235168212825711    0.0255537765734798 
           0.00015625            0.00015625            0.00015625 
   0.0264730080152699    0.0271186027099238    0.0361351573082595 
           0.00015625            0.00031250            0.00015625 
   0.0362911121323546    0.0368634437985054    0.0454309894047899 
           0.00015625            0.00015625            0.00015625 
   0.0533298995579193    0.0570581595639766    0.0585759323236618 
           0.00015625            0.00937500            0.00015625 
   0.0675339577108118    0.0702113818864803    0.0729377618887858 
           0.00046875            0.00015625            0.00062500 
   0.0788793134968683    0.0789059252411879    0.0790823923337298 
           0.00015625            0.02343750            0.00046875 
   0.0797510873183287    0.0806069942083428    0.0841639835120876 
           0.00015625            0.00015625            0.00015625 
   0.0899621750174284    0.0966606496804153    0.0972018193465008 
           0.00015625            0.00015625            0.00015625 
    0.101566818289489     0.108411810410797     0.109012079979066 
           0.00062500            0.00015625            0.00046875 
     0.11244290268093     0.119444894039026     0.131046181957536 
           0.00015625            0.00015625            0.00203125 
    0.134889340170799     0.135028927523559     0.136658265622521 
           0.00015625            0.00015625            0.00015625 
    0.144157938789208     0.146258849789861     0.147318188850963 
           0.00015625            0.00015625            0.02984375 
    0.151115033119933     0.152349655315244     0.154426066228552 
           0.00015625            0.00015625            0.00015625 
     0.15737266071083     0.162873929857665     0.162973153669365 
           0.00015625            0.00015625            0.00015625 
    0.164891939398059     0.165580765616732     0.173693095305534 
           0.00015625            0.00015625            0.00015625 
    0.183009971581342     0.186789363756051     0.187969991368742 
           0.00093750            0.00015625            0.00015625 
    0.192709893790261     0.194724832331223     0.194735738184732 
           0.00015625            0.00015625            0.00015625 
    0.195991364801127     0.206802781312992     0.210386154876613 
           0.00015625            0.00015625            0.00500000 
    0.217235034249908       0.2177869344983     0.234906769563277 
           0.00031250            0.00203125            0.00015625 
    0.234973761205148     0.238837237065174     0.241127733319099 
           0.00031250            0.00015625            0.00015625 
    0.250135635132824      0.25028785413495     0.253309352340188 
           0.00015625            0.00015625            0.00078125 
    0.254814769298151     0.260835355687548     0.264960519475955 
           0.00015625            0.00015625            0.00015625 
    0.266044692238248      0.27127954776092     0.273304013334367 
           0.00015625            0.00015625            0.00015625 
    0.273531307307048     0.274822103147971     0.280770740587068 
           0.00015625            0.00015625            0.00015625 
    0.284591080073122     0.285810915205503     0.286937550828954 
           0.00015625            0.00015625            0.00046875 
    0.289640625615739     0.301307082566931     0.302882181759369 
           0.00015625            0.00015625            0.00015625 
    0.304256560508303     0.309710068792923     0.311251030414092 
           0.00015625            0.00015625            0.00015625 
    0.311802268812853     0.318128929047187     0.318922298138204 
           0.00015625            0.00031250            0.00015625 
    0.320852365313198     0.322875645177539     0.334350357273903 
           0.00015625            0.00015625            0.00015625 
    0.337167536402539     0.338400625416362     0.338901340452759 
           0.00015625            0.00031250            0.00140625 
    0.346939027258188     0.348766831423466     0.358991725758732 
           0.00015625            0.00015625            0.00015625 
    0.364034892089946     0.365884194608935     0.368674799710984 
           0.00015625            0.00015625            0.00015625 
    0.369643258716518     0.373829702918903     0.379821273586168 
           0.00015625            0.00062500            0.00015625 
    0.382087226815338      0.38685609839469       0.3878539441829 
           0.00015625            0.00015625            0.00015625 
     0.38923354153609     0.390865130076565     0.393785793790202 
           0.00015625            0.00093750            0.00015625 
    0.402956322412276     0.404247945632944      0.40569298299336 
           0.00015625            0.00015625            0.00015625 
    0.406064629649282      0.40786256349758     0.408056423319527 
           0.00015625            0.00109375            0.00015625 
    0.412247177017014     0.414419483912049     0.416346031539166 
           0.00015625            0.00046875            0.00015625 
     0.41794166276908     0.419463447191946     0.420106603846799 
           0.00015625            0.01078125            0.00015625 
    0.420379431706021     0.420869449539072     0.431214346889845 
           0.00406250            0.00015625            0.00015625 
    0.433937840525743     0.440278644951702     0.441895424076257 
           0.00031250            0.00015625            0.00015625 
    0.442828919700371     0.443274873059508     0.446173888246631 
           0.00046875            0.00984375            0.00015625 
    0.450718587802467     0.456900610463576     0.459555681956315 
           0.00015625            0.00031250            0.00015625 
    0.460696686048428     0.467876105484108     0.472728746197005 
           0.00015625            0.00015625            0.00015625 
    0.474472217743954     0.474601080341499     0.474734089218203 
           0.00015625            0.00031250            0.00015625 
    0.477973490467994     0.484307789443022     0.484652344952628 
           0.00015625            0.00015625            0.00015625 
    0.494792709324177     0.498497691565453     0.500784787450151 
           0.00109375            0.00515625            0.00015625 
    0.504691880000581     0.508425703980646      0.50861676779181 
           0.00031250            0.00015625            0.00015625 
     0.50996114523361     0.514344382856681     0.516995457862692 
           0.00015625            0.00015625            0.00015625 
    0.518586102739047     0.521829770584971     0.523840570430114 
           0.00015625            0.00015625            0.00015625 
    0.524285913333902     0.525227742436545     0.527917885589494 
           0.00015625            0.00015625            0.00015625 
    0.531983533422768     0.539966728864973     0.541903897062432 
           0.00015625            0.00015625            0.00046875 
    0.543994005812287     0.545724786000498     0.546756498947983 
           0.00125000            0.00015625            0.00203125 
    0.548923619243861     0.549353970396232       0.5588553176537 
           0.00015625            0.00015625            0.00031250 
    0.564138483610525     0.566992546543754     0.569133261860447 
           0.00015625            0.00015625            0.00015625 
    0.574903744908869     0.577978215152712     0.578343495716271 
           0.00031250            0.00109375            0.00015625 
    0.580241024741447     0.581634314964003     0.583204933976379 
           0.00015625            0.00015625            0.00015625 
     0.58873859479558     0.595455758634415     0.597057916427158 
           0.00015625            0.00031250            0.00015625 
    0.598720288571789     0.599162991111384     0.599578938399305 
           0.00031250            0.00015625            0.00015625 
     0.60342049593258     0.604292419065582     0.607847397763963 
           0.00015625            0.00015625            0.00015625 
    0.611956869618315     0.612059726969641     0.612784292101807 
           0.00015625            0.00062500            0.00015625 
    0.613557486760981     0.620580331763515     0.622971928913742 
           0.00015625            0.00015625            0.00375000 
     0.63588348041021     0.641390081029809     0.643182929950686 
           0.00015625            0.00015625            0.00015625 
    0.648293425210027     0.650684078195595     0.657754904789885 
           0.00015625            0.00046875            0.00015625 
    0.664732625480728     0.665678528246394     0.665791697835918 
           0.00015625            0.00984375            0.00015625 
    0.666578602798705     0.678050028820375     0.678379635730825 
           0.00015625            0.00015625            0.00015625 
    0.679808655934455     0.680412565586961     0.680711498268701 
           0.00328125            0.00015625            0.00015625 
    0.684080216155581     0.684149053017272     0.685295140133807 
           0.00281250            0.00015625            0.00031250 
    0.686201169423553     0.690582799388141     0.692180702201577 
           0.00015625            0.00421875            0.00015625 
    0.696595449900374     0.697435597111395     0.698914306548046 
           0.00015625            0.00015625            0.00015625 
     0.70193206265865     0.702647867819401     0.707754986014002 
           0.00015625            0.00062500            0.00015625 
    0.711210346763156     0.712920206015224     0.713369947147153 
           0.00015625            0.00015625            0.00015625 
    0.715327471836729     0.722275487513834     0.722728216151602 
           0.00031250            0.00156250            0.00015625 
      0.7239248415172      0.72708089915877     0.729737150343281 
           0.00015625            0.00015625            0.00015625 
    0.735388003016973     0.740385327518889     0.741422651587756 
           0.00031250            0.00015625            0.00015625 
    0.741444754160499     0.747108762937508     0.748191169284348 
           0.00015625            0.00031250            0.00015625 
    0.751436430272142     0.752533256420978     0.752674676426801 
           0.00015625            0.00015625            0.00015625 
    0.754611657443207     0.754889027400603     0.756349639135923 
           0.00125000            0.00015625            0.00015625 
    0.763526062479594     0.768717423291569     0.770997182276433 
           0.00015625            0.00015625            0.00015625 
     0.77805655959217     0.780455501601279      0.79111659134251 
           0.00015625            0.00015625            0.00015625 
    0.794424123694395     0.794542595446869     0.797594367513394 
           0.00046875            0.00015625            0.00015625 
    0.806459604893308     0.806575447067013     0.815325824113437 
           0.00015625            0.00171875            0.00031250 
    0.820054212719794     0.821566079066492     0.822735985643791 
           0.00015625            0.00015625            0.00015625 
    0.824910396049865     0.825564426121463     0.827093295015157 
           0.00015625            0.00281250            0.00015625 
    0.830498441784675     0.839706577696515     0.854374875678462 
           0.00031250            0.00015625            0.00015625 
    0.857045424718981     0.857046899457354     0.858539236690819 
           0.00031250            0.00015625            0.00109375 
    0.861958482401254     0.864973903806387     0.868060666977836 
           0.00015625            0.00031250            0.00015625 
    0.871547517399078     0.877907606552374     0.878620392468042 
           0.00015625            0.00031250            0.00015625 
    0.882079910398028     0.886773165429333     0.895872264013794 
           0.00015625            0.00015625            0.00031250 
    0.902874892971196     0.909893594892982     0.910503026314625 
           0.00015625            0.00015625            0.00015625 
    0.918355472177732     0.923930998062757     0.928610132228083 
           0.00156250            0.00015625            0.00015625 
    0.930580294371997     0.932353440099381     0.933043163131344 
           0.00015625            0.00015625            0.00015625 
    0.935865275090846     0.938721396055517      0.94732667023698 
           0.00015625            0.00015625            0.00015625 
    0.952388332756409     0.953472399517577     0.960457391255192 
           0.00046875            0.00015625            0.00015625 
    0.962466815938431     0.974608403263273     0.977273131185975 
           0.00031250            0.00015625            0.00015625 
    0.979887858238853     0.981765099822977     0.982533764258785 
           0.02546875            0.00015625            0.00015625 
    0.986421193335086     0.991131333762411      0.99464772824313 
           0.00046875            0.00015625            0.00015625 
     1.00529335053186      1.01443060556224       1.0145402019372 
           0.00015625            0.00062500            0.00015625 
     1.02257036343242      1.02480443153783      1.02810330735672 
           0.00015625            0.00015625            0.00015625 
     1.02815692332918       1.0286099206142      1.03278708868866 
           0.00265625            0.00015625            0.00015625 
     1.03867605371823      1.04030809775545      1.05026762861212 
           0.00015625            0.00046875            0.00015625 
     1.05448691449244       1.0552263521649      1.05588258974527 
           0.00125000            0.00015625            0.00015625 
     1.06000513122926      1.06639439518604      1.07107601485988 
           0.00906250            0.00078125            0.00015625 
     1.07323792501438      1.07985999257921      1.08185178624946 
           0.00015625            0.00015625            0.00015625 
     1.08200577310599      1.08501442587133      1.08924264046828 
           0.00015625            0.00015625            0.00015625 
     1.09237983879524      1.09858922192811      1.09934822043348 
           0.00015625            0.00015625            0.00015625 
      1.1078948637414      1.11407400788163      1.11835818480985 
           0.00015625            0.00015625            0.00093750 
     1.11909298650692      1.12255263564979      1.13098492845703 
           0.00125000            0.00640625            0.00718750 
     1.13520899613199      1.13659865262031      1.14324263811607 
           0.00015625            0.00031250            0.00015625 
      1.1444495252129       1.1551673045972      1.15841602768456 
           0.00578125            0.00046875            0.00015625 
     1.17032197443365      1.17077944389967      1.17660425916148 
           0.00156250            0.01546875            0.00015625 
     1.17671971786951      1.18390085758965      1.19061835680715 
           0.00031250            0.02078125            0.00078125 
     1.19124162268748      1.19491419845781      1.20187158527135 
           0.00046875            0.01000000            0.00015625 
     1.20935820034015      1.21534749252995      1.21684078311872 
           0.00015625            0.00015625            0.00015625 
     1.22228576405746      1.22358524293339       1.2307494205369 
           0.00046875            0.00375000            0.00359375 
     1.23190824585799      1.23309624815214       1.2482497077686 
           0.00015625            0.00015625            0.00015625 
     1.24914605564843      1.25030062698194      1.25167385090479 
           0.00015625            0.00015625            0.00015625 
      1.2521388586462      1.25403638767138      1.25696184836792 
           0.00015625            0.00015625            0.00015625 
     1.25865710330342      1.26219503016375      1.26339025886804 
           0.00015625            0.00015625            0.00062500 
     1.27424955368127      1.27429889692881      1.27581391381442 
           0.00062500            0.01093750            0.00015625 
     1.28103448636196      1.28422435170195      1.28502302740832 
           0.00015625            0.00015625            0.00015625 
     1.28694332261892      1.28862136579613      1.29135133286724 
           0.00015625            0.00015625            0.00015625 
     1.29271693854318      1.29352984392642      1.29416501801516 
           0.00093750            0.00015625            0.00015625 
     1.32000923372796      1.32621334330507      1.32674979912185 
           0.00015625            0.00031250            0.00031250 
      1.3355388950486      1.33819762355126      1.34572143844383 
           0.00703125            0.00015625            0.00015625 
     1.34900429115538      1.35106912963136      1.35909050306374 
           0.00015625            0.00015625            0.00015625 
     1.36740896432616      1.37732504122682      1.37817713292888 
           0.00015625            0.00015625            0.00171875 
     1.38155034894393      1.38244688032714      1.38971756538262 
           0.00015625            0.00015625            0.00015625 
     1.39337346848199      1.39481552027921      1.39920925968592 
           0.00015625            0.00015625            0.00015625 
     1.40401019415033      1.40768753122916      1.42034462702771 
           0.00015625            0.00046875            0.00031250 
     1.42884838085788      1.43014092255268      1.43175470937195 
           0.00062500            0.00078125            0.00015625 
     1.43334191774463      1.43396654425843      1.43750664054499 
           0.00046875            0.00015625            0.00015625 
     1.43754219334743       1.4388998201083      1.44153927902681 
           0.00015625            0.01625000            0.01421875 
     1.44769121849116      1.44889234688456      1.45317034273597 
           0.00015625            0.00015625            0.00015625 
     1.45756717172523      1.46514717542552      1.48152004641465 
           0.00015625            0.01359375            0.00015625 
     1.48210471217649       1.4854271336131      1.49691410201524 
           0.00187500            0.00015625            0.00031250 
     1.50460499505036          1.5159104855      1.51944062018193 
           0.00015625            0.00062500            0.00015625 
     1.51951797036384      1.52322014302823      1.52914361888698 
           0.00015625            0.00015625            0.00015625 
     1.53094696259391      1.53185854523801      1.54534195968881 
           0.00015625            0.00015625            0.00015625 
     1.55198480359028      1.55950143190504      1.56497982317259 
           0.00031250            0.00015625            0.00015625 
     1.58262031982126      1.59616721426295      1.60437565730193 
           0.00062500            0.00015625            0.00015625 
     1.61266940307664      1.61805143272205      1.63593441495235 
           0.00015625            0.00015625            0.00390625 
     1.66020775786113      1.67542635415394      1.67673538939901 
           0.00046875            0.00015625            0.00437500 
     1.68035708519021      1.68346836697786      1.68837599513398 
           0.00015625            0.00015625            0.00015625 
     1.68938234802037      1.70189867028665      1.70300688645049 
           0.00015625            0.00015625            0.00015625 
     1.70487078400102      1.71353493899627      1.72834558905075 
           0.00015625            0.00015625            0.00015625 
     1.72915591888238      1.73426417234817      1.74021109248258 
           0.00015625            0.00015625            0.00015625 
     1.74232222740301      1.74349939634561       1.7580041756475 
           0.00015625            0.00015625            0.00015625 
     1.76113921780106      1.76617520172517      1.77211632108358 
           0.00015625            0.00015625            0.00015625 
     1.77514993495452      1.79958280830507      1.81629669477704 
           0.00015625            0.00015625            0.00031250 
     1.81990457312901      1.83656963213994      1.83724270780201 
           0.00015625            0.01140625            0.00015625 
     1.84610801109783      1.87127556838068      1.87941151145041 
           0.00015625            0.00031250            0.00015625 
     1.88207392317223      1.89017691499225      1.91733288828094 
           0.00031250            0.00015625            0.00015625 
     1.94867279430132      1.95578696468731      1.95652907096428 
           0.00687500            0.00015625            0.00015625 
     1.96029188648611      1.97337415011671      1.97682872944693 
           0.00015625            0.00015625            0.00015625 
     1.97898223695928      2.01790204562771      2.04143987127407 
           0.00015625            0.00015625            0.00171875 
     2.04788306887298      2.07547273185274      2.09309957494449 
           0.00062500            0.00031250            0.00015625 
     2.09950420993508      2.10052429104874      2.10697756530747 
           0.00031250            0.00015625            0.00015625 
     2.11999156344762      2.12917389303477      2.15933629269958 
           0.00015625            0.00015625            0.00015625 
     2.18306393167287      2.18323513022319      2.18704108088277 
           0.00187500            0.00015625            0.00015625 
     2.23887211958444      2.24380917557826      2.28051444339884 
           0.00015625            0.00015625            0.00562500 
     2.28417103037285      2.30954548348617      2.34561980157645 
           0.00015625            0.00125000            0.00015625 
     2.52385907644018      3.01185818638057      3.23514293488871 
           0.00015625            0.00015625            0.00031250 
     3.52347021972545      4.91171482734768      5.33930094132038 
           0.00015625            0.00015625            0.00015625 
     6.39137994453622      6.97999767626588 
           0.00015625            0.00015625 
> 
> prop.table(table(trainClass))
trainClass
  Strong     Weak 
0.746888 0.253112 
> 
> dim(trainDescr)
[1] 241  20
> dim(testDescr)
[1] 79 20
> 
> ## Check Near-zero variance
> 
> nzv <- nearZeroVar(trainDescr, saveMetrics= TRUE)
> stopifnot( all(nzv$nzv == FALSE) )
> 
> # It's imputed and behaves well, no need for this.
> # descrCorr <- cor(scale(trainDescr), use = "pairwise.complete.obs")
> 
> descrCorr <- cor(scale(trainDescr))
> 
> highCorr <- findCorrelation(descrCorr, cutoff = .80, verbose = TRUE)
Considering row	 16 column	 1 value	 0.269 
Considering row	 16 column	 17 value	 0.859 
  Flagging column	 16 
Considering row	 1 column	 17 value	 0.295 
Considering row	 1 column	 10 value	 0.305 
Considering row	 1 column	 11 value	 0.988 
  Flagging column	 1 
Considering row	 17 column	 10 value	 0.65 
Considering row	 17 column	 11 value	 0.298 
Considering row	 17 column	 6 value	 0.257 
Considering row	 17 column	 12 value	 0.266 
Considering row	 17 column	 14 value	 0.25 
Considering row	 17 column	 2 value	 0.224 
Considering row	 17 column	 9 value	 0.524 
Considering row	 17 column	 8 value	 0.494 
Considering row	 17 column	 13 value	 0.219 
Considering row	 17 column	 3 value	 0.27 
Considering row	 17 column	 18 value	 0.259 
Considering row	 17 column	 19 value	 0.13 
Considering row	 17 column	 20 value	 0.041 
Considering row	 17 column	 4 value	 0.038 
Considering row	 17 column	 7 value	 0.097 
Considering row	 17 column	 15 value	 0.042 
Considering row	 17 column	 5 value	 0.024 
Considering row	 10 column	 11 value	 0.314 
Considering row	 10 column	 6 value	 0.34 
Considering row	 10 column	 12 value	 0.258 
Considering row	 10 column	 14 value	 0.225 
Considering row	 10 column	 2 value	 0.231 
Considering row	 10 column	 9 value	 0.359 
Considering row	 10 column	 8 value	 0.386 
Considering row	 10 column	 13 value	 0.177 
Considering row	 10 column	 3 value	 0.43 
Considering row	 10 column	 18 value	 0.198 
Considering row	 10 column	 19 value	 0.133 
Considering row	 10 column	 20 value	 0.07 
Considering row	 10 column	 4 value	 0.023 
Considering row	 10 column	 7 value	 0.208 
Considering row	 10 column	 15 value	 0.253 
Considering row	 10 column	 5 value	 0.117 
Considering row	 11 column	 6 value	 0.951 
  Flagging column	 11 
Considering row	 6 column	 12 value	 0.92 
  Flagging column	 6 
Considering row	 12 column	 14 value	 0.101 
Considering row	 12 column	 2 value	 0.138 
Considering row	 12 column	 9 value	 0.156 
Considering row	 12 column	 8 value	 0.07 
Considering row	 12 column	 13 value	 0.1 
Considering row	 12 column	 3 value	 0.149 
Considering row	 12 column	 18 value	 0.063 
Considering row	 12 column	 19 value	 0.115 
Considering row	 12 column	 20 value	 0.165 
Considering row	 12 column	 4 value	 0.066 
Considering row	 12 column	 7 value	 0.102 
Considering row	 12 column	 15 value	 0.108 
Considering row	 12 column	 5 value	 0.018 
Considering row	 14 column	 2 value	 0.593 
Considering row	 14 column	 9 value	 0.152 
Considering row	 14 column	 8 value	 0.164 
Considering row	 14 column	 13 value	 0.68 
Considering row	 14 column	 3 value	 0.026 
Considering row	 14 column	 18 value	 0.416 
Considering row	 14 column	 19 value	 0.03 
Considering row	 14 column	 20 value	 0.123 
Considering row	 14 column	 4 value	 0.26 
Considering row	 14 column	 7 value	 0.129 
Considering row	 14 column	 15 value	 0.085 
Considering row	 14 column	 5 value	 0.007 
Considering row	 2 column	 9 value	 0.397 
Considering row	 2 column	 8 value	 0.154 
Considering row	 2 column	 13 value	 0.604 
Considering row	 2 column	 3 value	 0.202 
Considering row	 2 column	 18 value	 0.149 
Considering row	 2 column	 19 value	 0.036 
Considering row	 2 column	 20 value	 0.129 
Considering row	 2 column	 4 value	 0.185 
Considering row	 2 column	 7 value	 0.047 
Considering row	 2 column	 15 value	 0.065 
Considering row	 2 column	 5 value	 0.056 
Considering row	 9 column	 8 value	 0.376 
Considering row	 9 column	 13 value	 0.137 
Considering row	 9 column	 3 value	 0.314 
Considering row	 9 column	 18 value	 0.036 
Considering row	 9 column	 19 value	 0.155 
Considering row	 9 column	 20 value	 0.052 
Considering row	 9 column	 4 value	 0.025 
Considering row	 9 column	 7 value	 0.115 
Considering row	 9 column	 15 value	 0.059 
Considering row	 9 column	 5 value	 0.087 
Considering row	 8 column	 13 value	 0.138 
Considering row	 8 column	 3 value	 0.231 
Considering row	 8 column	 18 value	 0.189 
Considering row	 8 column	 19 value	 0.24 
Considering row	 8 column	 20 value	 0.167 
Considering row	 8 column	 4 value	 0.073 
Considering row	 8 column	 7 value	 0.106 
Considering row	 8 column	 15 value	 0.075 
Considering row	 8 column	 5 value	 0.03 
Considering row	 13 column	 3 value	 0.087 
Considering row	 13 column	 18 value	 0.224 
Considering row	 13 column	 19 value	 0.095 
Considering row	 13 column	 20 value	 0.165 
Considering row	 13 column	 4 value	 0.22 
Considering row	 13 column	 7 value	 0.052 
Considering row	 13 column	 15 value	 0.134 
Considering row	 13 column	 5 value	 0.007 
Considering row	 3 column	 18 value	 0.046 
Considering row	 3 column	 19 value	 0.123 
Considering row	 3 column	 20 value	 0.029 
Considering row	 3 column	 4 value	 0.121 
Considering row	 3 column	 7 value	 0.118 
Considering row	 3 column	 15 value	 0.029 
Considering row	 3 column	 5 value	 0.128 
Considering row	 18 column	 19 value	 0.169 
Considering row	 18 column	 20 value	 0.021 
Considering row	 18 column	 4 value	 0.1 
Considering row	 18 column	 7 value	 0.134 
Considering row	 18 column	 15 value	 0.082 
Considering row	 18 column	 5 value	 0.01 
Considering row	 19 column	 20 value	 0.855 
  Flagging column	 19 
Considering row	 20 column	 4 value	 0.029 
Considering row	 20 column	 7 value	 0.072 
Considering row	 20 column	 15 value	 0.031 
Considering row	 20 column	 5 value	 0.07 
Considering row	 4 column	 7 value	 0.026 
Considering row	 4 column	 15 value	 0.09 
Considering row	 4 column	 5 value	 0.237 
Considering row	 7 column	 15 value	 0.052 
Considering row	 7 column	 5 value	 0.001 
Considering row	 15 column	 5 value	 0.036 
> 
> colnames(trainDescr)[highCorr]
[1] "DEPSPOKE"     "SDEPHR"       "DEPBUCKET"    "AVGSQ"        "xAVAILBUCKET"
> 
> descr.ncol0 <- ncol(trainDescr)
> 
> # I've switched off the correlation remover and the results are better.
> if (sum(highCorr) > 0) {
+     warning("overfitting: correlations: err.trainDescr: ", paste(colnames(trainDescr)[highCorr], collapse = ", ") )
+     err.trainDescr <- trainDescr
+     trainDescr <- trainDescr[,-highCorr]
+ }
Warning message:
overfitting: correlations: err.trainDescr: DEPSPOKE, SDEPHR, DEPBUCKET, AVGSQ, xAVAILBUCKET 
> 
> descr.ncol1 <- ncol(trainDescr)
> 
> descr.ncol1 - descr.ncol0
[1] -5
> 
> descrCorr <- cor(trainDescr)
> summary(descrCorr[upper.tri(descrCorr)])
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.52440 -0.11740 -0.02409  0.01626  0.12310  0.67970 
> paste(c("Dropped", descr.ncol0 - descr.ncol1, collapse = ", ")
+ )
[1] "Dropped" "5"       ", "     
> paste(c("Dropped", descr.ncol0 - descr.ncol1, collapse = " ")
+ )
[1] "Dropped" "5"       " "      
> paste(c("Dropped: ", descr.ncol0 - descr.ncol1))
[1] "Dropped: " "5"        
> (c("Dropped: ", descr.ncol0 - descr.ncol1)
+ )
[1] "Dropped: " "5"        
> paste( (c("Dropped: ", as.character(descr.ncol0 - descr.ncol1)) )
+ paste("Dropped: ", as.character(descr.ncol0 - descr.ncol1))
Error: unexpected symbol in:
"paste( (c("Dropped: ", as.character(descr.ncol0 - descr.ncol1)) )
paste"
> paste("Dropped: ", as.character(descr.ncol0 - descr.ncol1))
[1] "Dropped:  5"
> ### weaves
> 
> ## Processing for flights data.
> 
> ## Following the caret vignette.
> 
> ###################################################
> ### code chunk number 1: loadLibs
> ###################################################
> library(MASS)
> library(caret)
> library(mlbench)
> library(pROC)
> library(pls)
> 
> library(doMC)
> registerDoMC(cores = 4)
> 
> options(useFancyQuotes = FALSE) 
> 
> # Accounting info.
> getInfo <- function(what = "Suggests")
+ {
+   text <- packageDescription("caret")[what][[1]]
+   text <- gsub("\n", ", ", text, fixed = TRUE)
+   text <- gsub(">=", "$\\\\ge$", text, fixed = TRUE)
+   eachPkg <- strsplit(text, ", ", fixed = TRUE)[[1]]
+   eachPkg <- gsub(",", "", eachPkg, fixed = TRUE)
+   # out <- paste("\\\\pkg{", eachPkg[order(tolower(eachPkg))], "}", sep = "")
+   # paste(out, collapse = ", ")
+   length(eachPkg)
+ }
> 
> ### project-specific: begin
> ## Set-seed, load original CSV file, order it
> ## and do some simple-cleaning
> ## Various datasets 
> 
> seed.mine = 107
> set.seed(seed.mine)                     # helpful for testing
> 
> flight <- read.csv("../bak/flight.csv")
> flight <- flight[order(flight$D00),]
> 
> # Backup
> flight.raw <- flight
> 
> source(file = "flight1.R")
> 
> # Some additions
> 
> flight$DEPSPOKE <- flight$DEPGRP == "Spoke"
> flight$ARRSPOKE <- flight$ARRGRP == "Spoke"
> 
> # And some deletions
> 
> t.cols <- colnames(flight)
> 
> t.drops <- t.cols[grep("^RANK*", t.cols)]
> t.drops <- c(t.drops, t.cols[grep("^(ARR|DEP)GRP$", t.cols)])
> t.drops <- c(t.drops, "D80THPCTL")
> 
> flight <- flight[ , t.cols[!(t.cols %in% t.drops)] ]
> 
> ## Let's do the flight duration logic see the flight logic the notes.
> 
> flight$xDURN <- flight$SARRHR - flight$SDEPHR
> flight$xHNGR <- flight$xDURN < 0
> 
> ## I don't think there is any hangaring. I have to clean this up.
> 
> ## Max flight time is 8 hours for the positives, but red-eyes can
> ## take longer
> 
> hr.wrap <- function(d0, a0) {
+     t0 <- a0 - d0
+     if (t0 >= 0) return(t0)
+     t0 <- 24 - d0
+     t0 <- t0 + a0
+     return(t0)
+ }
> 
> flight$xDURN2 <- apply(flight[,c("SDEPHR", "SARRHR")], 1, 
+                        function(y) hr.wrap(y['SDEPHR'], y['SARRHR']))
> 
> flight[which(flight$xDURN2 != flight$xDURN), c("SDEPHR", "SARRHR", "xDURN","xDURN2", "xHNGR")]
     SDEPHR SARRHR xDURN xDURN2 xHNGR
19       22      0   -22      2  TRUE
107      22      0   -22      2  TRUE
111      23      5   -18      6  TRUE
121      21      0   -21      3  TRUE
186      22      0   -22      2  TRUE
203      20      0   -20      4  TRUE
220      21      0   -21      3  TRUE
261      23      7   -16      8  TRUE
285      22      6   -16      8  TRUE
328      18      9    -9     15  TRUE
367      22      6   -16      8  TRUE
443      22      6   -16      8  TRUE
554      22     11   -11     13  TRUE
559      19      0   -19      5  TRUE
595      21     15    -6     18  TRUE
611      22      6   -16      8  TRUE
621      22      0   -22      2  TRUE
625      22      6   -16      8  TRUE
636      20      8   -12     12  TRUE
652      18      7   -11     13  TRUE
654      20     11    -9     15  TRUE
666      21      8   -13     11  TRUE
670      22      5   -17      7  TRUE
686      21      9   -12     12  TRUE
718      18      8   -10     14  TRUE
722      18      7   -11     13  TRUE
742      22      6   -16      8  TRUE
748      18      8   -10     14  TRUE
749      20     10   -10     14  TRUE
785      19      1   -18      6  TRUE
799      18      8   -10     14  TRUE
853      22      6   -16      8  TRUE
855      23      7   -16      8  TRUE
863      18      7   -11     13  TRUE
883      16      6   -10     14  TRUE
905      22      0   -22      2  TRUE
967      22      7   -15      9  TRUE
984      22      0   -22      2  TRUE
1011     22      6   -16      8  TRUE
1012     22      6   -16      8  TRUE
1043     23      6   -17      7  TRUE
1096     22      6   -16      8  TRUE
1148     22      5   -17      7  TRUE
1288     23      8   -15      9  TRUE
1372     23      8   -15      9  TRUE
1384     23      8   -15      9  TRUE
1386     23      5   -18      6  TRUE
1388     23      8   -15      9  TRUE
> t.cols <- colnames(flight)
> 
> t.drops <- c("SARRHR", "xDURN")
> flight <- flight[ , t.cols[!(t.cols %in% t.drops)] ]
> 
> ## Backup
> 
> flight00 <- flight
> 
> # And we drop many, many rows because R slows with large datasets.
> # These are the ranges we have been asked to predict on.
> 
> flight <- flight[flight$AVGLOFATC >= 3.1 & flight$AVGLOFATC <= 4.4,]
> 
> ## Take another copy - this is all we need as the training/prediction
> ## set.
> 
> flight1 <- flight
> 
> ## Data insights
> 
> ## Run from here.
> 
> ## Using the D00 and LEGTYPE dataset, I have this concern that D00 is
> ## a derived probit and we should ignore it.
> 
> flight <- flight1
> 
> ## So something is defining the behaviour.
> 
> ## Try to simplify structure
> 
> head(model.matrix(LEGTYPE ~ ., data = flight))
   (Intercept) SDEPHR SKDDEPSTAALB SKDDEPSTAAMS SKDDEPSTAANC SKDDEPSTAATT
2            1     14            0            0            0            0
5            1     11            0            0            0            0
7            1     14            0            0            0            0
13           1     13            0            0            0            0
14           1     16            0            0            0            0
17           1     15            0            0            0            0
   SKDDEPSTAAUA SKDDEPSTAAUS SKDDEPSTABDA SKDDEPSTABDL SKDDEPSTABNA
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTABOI SKDDEPSTABOS SKDDEPSTABRU SKDDEPSTABUF SKDDEPSTABWI
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTACCC SKDDEPSTACDG SKDDEPSTACHS SKDDEPSTACLE SKDDEPSTACMH
2             1            0            0            0            0
5             0            0            0            0            0
7             1            0            0            0            0
13            0            0            0            0            0
14            1            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTACUN SKDDEPSTADDD SKDDEPSTADEN SKDDEPSTADFW SKDDEPSTADSM
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            1            0            0            0
   SKDDEPSTADTW SKDDEPSTADUB SKDDEPSTAEWR SKDDEPSTAFCO SKDDEPSTAFLL
2             0            0            0            0            0
5             1            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAFRA SKDDEPSTAGCM SKDDEPSTAGDL SKDDEPSTAGEG SKDDEPSTAGIG
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAHNL SKDDEPSTAIAH SKDDEPSTAILM SKDDEPSTAIND SKDDEPSTAJAX
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAJFK SKDDEPSTAKOA SKDDEPSTALAS SKDDEPSTALAX SKDDEPSTALGA
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTALGB SKDDEPSTALGW SKDDEPSTALHR SKDDEPSTALIH SKDDEPSTAMAD
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAMAN SKDDEPSTAMBJ SKDDEPSTAMCI SKDDEPSTAMCO SKDDEPSTAMDT
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAMEX SKDDEPSTAMHT SKDDEPSTAMIA SKDDEPSTAMKE SKDDEPSTAMSP
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAMSY SKDDEPSTAMUC SKDDEPSTAMZT SKDDEPSTANAS SKDDEPSTAOAK
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAOGG SKDDEPSTAOMA SKDDEPSTAONT SKDDEPSTAORD SKDDEPSTAORF
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAPBI SKDDEPSTAPDX SKDDEPSTAPIT SKDDEPSTAPLS SKDDEPSTAPPP
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            1
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAPUJ SKDDEPSTAPVD SKDDEPSTAPVR SKDDEPSTAPWM SKDDEPSTARDU
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTARIC SKDDEPSTARNO SKDDEPSTAROC SKDDEPSTARSW SKDDEPSTASAN
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTASAT SKDDEPSTASEA SKDDEPSTASFO SKDDEPSTASJC SKDDEPSTASJD
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTASJO SKDDEPSTASJU SKDDEPSTASLC SKDDEPSTASMF SKDDEPSTASNA
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTASRQ SKDDEPSTASTL SKDDEPSTASTT SKDDEPSTASXM SKDDEPSTASYR
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTATLV SKDDEPSTATPA SKDDEPSTAXHP SKDDEPSTAYEG SKDDEPSTAYVR
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDDEPSTAYYC SKDDEPSTAZRH SKDARRSTAALB SKDARRSTAAMS SKDARRSTAANC
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAATT SKDARRSTAAUA SKDARRSTAAUS SKDARRSTABDA SKDARRSTABDL
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTABNA SKDARRSTABOI SKDARRSTABOS SKDARRSTABRU SKDARRSTABUF
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            1            0            0
17            0            0            0            0            0
   SKDARRSTABWI SKDARRSTACCC SKDARRSTACDG SKDARRSTACHS SKDARRSTACLE
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            1            0            0            0
   SKDARRSTACMH SKDARRSTACUN SKDARRSTADDD SKDARRSTADEN SKDARRSTADFW
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTADSM SKDARRSTADTW SKDARRSTADUB SKDARRSTAEWR SKDARRSTAFCO
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAFLL SKDARRSTAFRA SKDARRSTAGCM SKDARRSTAGDL SKDARRSTAGEG
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAGIG SKDARRSTAHNL SKDARRSTAIAH SKDARRSTAILM SKDARRSTAIND
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAJAX SKDARRSTAJFK SKDARRSTAKOA SKDARRSTALAS SKDARRSTALAX
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTALGA SKDARRSTALGB SKDARRSTALGW SKDARRSTALHR SKDARRSTALIH
2             0            0            0            0            0
5             0            0            0            0            0
7             1            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAMAD SKDARRSTAMAN SKDARRSTAMBJ SKDARRSTAMCI SKDARRSTAMCO
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAMDT SKDARRSTAMEX SKDARRSTAMHT SKDARRSTAMIA SKDARRSTAMKE
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAMSP SKDARRSTAMSY SKDARRSTAMUC SKDARRSTAMZT SKDARRSTANAS
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAOAK SKDARRSTAOGG SKDARRSTAOMA SKDARRSTAONT SKDARRSTAORD
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            1
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAORF SKDARRSTAPBI SKDARRSTAPDX SKDARRSTAPIT SKDARRSTAPLS
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAPPP SKDARRSTAPUJ SKDARRSTAPVD SKDARRSTAPVR SKDARRSTAPWM
2             1            0            0            0            0
5             1            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTARDU SKDARRSTARIC SKDARRSTARNO SKDARRSTAROC SKDARRSTARSW
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTASAN SKDARRSTASAT SKDARRSTASEA SKDARRSTASFO SKDARRSTASJC
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTASJD SKDARRSTASJO SKDARRSTASJU SKDARRSTASLC SKDARRSTASMF
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTASNA SKDARRSTASRQ SKDARRSTASTL SKDARRSTASTT SKDARRSTASXM
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTASYR SKDARRSTATLV SKDARRSTATPA SKDARRSTAXHP SKDARRSTAYEG
2             0            0            0            0            0
5             0            0            0            0            0
7             0            0            0            0            0
13            0            0            0            0            0
14            0            0            0            0            0
17            0            0            0            0            0
   SKDARRSTAYVR SKDARRSTAYYC SKDARRSTAZRH SKDEQP319 SKDEQP320 SKDEQP321
2             0            0            0         0         0         0
5             0            0            0         0         0         0
7             0            0            0         0         0         1
13            0            0            0         0         0         0
14            0            0            0         0         0         1
17            0            0            0         0         0         0
   SKDEQP332 SKDEQP333 SKDEQP734 SKDEQP75E SKDEQP75H SKDEQP767 SKDEQPA01
2          0         0         1         0         0         0         0
5          0         0         0         0         0         0         0
7          0         0         0         0         0         0         0
13         0         0         1         0         0         0         0
14         0         0         0         0         0         0         0
17         0         0         0         0         0         0         0
   SKDEQPA05 SKDEQPA19 SKDEQPA21 SKDEQPE90 SKDEPS       D00    AVGSQ AVGLOFATC
2          0         0         0         0     32 0.2500000 3.258065  3.258065
5          0         0         0         1     72 0.2916667 2.986111  3.805556
7          0         0         0         0     88 0.3295455 2.551724  3.701149
13         0         0         0         0     32 0.3750000 3.000000  3.903226
14         0         0         0         0     72 0.3750000 3.295775  3.859155
17         0         0         0         0     84 0.3809524 3.939759  3.361446
   UPLINEATCIMPLow UPLINEATCIMPMed UPLINEATCIMPMedHigh UPLINEATCIMPMedLow
2                0               1                   0                  0
5                0               0                   0                  0
7                0               0                   0                  1
13               0               1                   0                  0
14               0               0                   0                  1
17               1               0                   0                  0
   DEPSTAATCIMPLow DOWNLINEATCIMPLow AVGSKDAVAIL AVAILBUCKETA05 AVAILBUCKETA10
2                0                 0   10.903226              0              1
5                1                 0    2.000000              0              0
7                0                 0    9.647059              1              0
13               0                 0   17.354839              0              0
14               0                 0   17.057143              0              0
17               0                 0   10.621951              0              1
   AVAILBUCKETA15 AVAILBUCKETA20 AVAILBUCKETA25 AVAILBUCKETA30 AVAILBUCKETA<0
2               0              0              0              0              0
5               0              0              0              0              0
7               0              0              0              0              0
13              1              0              0              0              0
14              1              0              0              0              0
17              0              0              0              0              0
   DEPBUCKETD2 DEPBUCKETD3 DEPBUCKETD4 DEPBUCKETD5 DEPBUCKETD6 DEPBUCKETD7
2            0           0           0           1           0           0
5            0           0           1           0           0           0
7            0           0           0           1           0           0
13           0           0           0           1           0           0
14           0           0           0           0           1           0
17           0           0           0           0           1           0
   DEPBUCKETD8 ARRBUCKETA2 ARRBUCKETA3 ARRBUCKETA4 ARRBUCKETA5 ARRBUCKETA6
2            0           0           0           0           0           1
5            0           0           0           0           1           0
7            0           0           0           0           0           1
13           0           0           0           0           0           1
14           0           0           0           0           0           0
17           0           0           0           0           0           1
   ARRBUCKETA7 ARRBUCKETA8 DEPRANKGRPLow DEPRANKGRPMed DEPRANKGRPMedHigh
2            0           0             1             0                 0
5            0           0             0             1                 0
7            0           0             1             0                 0
13           0           0             0             0                 0
14           1           0             1             0                 0
17           0           0             0             0                 0
   DEPRANKGRPMedLow TRNRANKGRPLow TRNRANKGRPMed TRNRANKGRPMedHigh
2                 0             1             0                 0
5                 0             1             0                 0
7                 0             1             0                 0
13                1             0             0                 0
14                0             1             0                 0
17                1             0             1                 0
   TRNRANKGRPMedLow ARRRANKGRPLow ARRRANKGRPMed ARRRANKGRPMedHigh
2                 0             0             0                 1
5                 0             0             0                 1
7                 0             0             1                 0
13                1             0             0                 0
14                0             0             0                 1
17                0             0             0                 1
   ARRRANKGRPMedLow DEPSPOKETRUE ARRSPOKETRUE xHNGRTRUE xDURN2
2                 0            0            0         0      2
5                 0            1            0         0      2
7                 0            0            1         0      2
13                1            0            1         0      2
14                0            0            1         0      2
17                0            0            0         0      2
> 
> dummies <- dummyVars(LEGTYPE ~ ., data = flight)
> flight.dum <- predict(dummies, newdata = flight)
> 
> ## It may be too big to use, but useful for inspection.
> 
> ### Numeric variables
> 
> ## Check some more numeric correlations, I haven't scaled yet.
> ## I'd cut correlations above 0.75 because of overfitting.
> 
> x1 <- as.data.frame(as.matrix(sapply(flight, class)))
> 
> flight.num <- flight[,names(x1[which(x1$V1 %in% c("numeric", "integer")),])]
> 
> flight.nzv <- nearZeroVar(flight.num, saveMetrics = TRUE)
> flight.nzv
            freqRatio percentUnique zeroVar   nzv
SDEPHR       1.038462        5.9375   FALSE FALSE
SKDEPS       1.000000       19.0625   FALSE FALSE
D00          1.166667       75.3125   FALSE FALSE
AVGSQ        6.333333       82.8125   FALSE FALSE
AVGLOFATC    1.000000       78.4375   FALSE FALSE
AVGSKDAVAIL  1.000000       87.5000   FALSE FALSE
xDURN2       1.428571        2.5000   FALSE FALSE
> 
> # annoying NA
> flight.cor <- cor(flight.num, use = "pairwise.complete.obs")
> 
> descrCorr <- findCorrelation(flight.cor, cutoff = .75, verbose=TRUE)
Considering row	 1 column	 4 value	 0.956 
  Flagging column	 1 
Considering row	 4 column	 3 value	 0.414 
Considering row	 4 column	 6 value	 0.173 
Considering row	 4 column	 7 value	 0.201 
Considering row	 4 column	 5 value	 0.103 
Considering row	 4 column	 2 value	 0.082 
Considering row	 3 column	 6 value	 0.266 
Considering row	 3 column	 7 value	 0.071 
Considering row	 3 column	 5 value	 0.114 
Considering row	 3 column	 2 value	 0.006 
Considering row	 6 column	 7 value	 0.031 
Considering row	 6 column	 5 value	 0.094 
Considering row	 6 column	 2 value	 0.067 
Considering row	 7 column	 5 value	 0.137 
Considering row	 7 column	 2 value	 0.005 
Considering row	 5 column	 2 value	 0.041 
> 
> colnames(flight.num)[descrCorr]
[1] "SDEPHR"
> 
> ## Which tells me that departure time is very highly correlated to AVGSQ.
> ## AVGSQ is average stand queue?
> 
> ### Try and impute the AVG, it might have more information than the
> ### bucket.
> 
> flight$xAVAILBUCKET <- as.numeric(gsub("^[A<]+", "", flight$AVAILBUCKET))
> 
> ## Arbitrary choice to set to -1.
> flight[which(flight$AVAILBUCKET == 'A<0'), "xAVAILBUCKET" ] <- -1
> 
> flight.na <- flight[, c("AVGSKDAVAIL", "xAVAILBUCKET")]
> 
> preProcValues <- preProcess(flight.na, method = c("knnImpute"))
> flight.na1 <- predict(preProcValues, flight.na)
> 
> flight$xAVGSKDAVAIL <- flight.na1$AVGSKDAVAIL
> 
> ## And I'll leave the centered and scale values in for now.
> ## and delete the troublesome ones
> 
> flight$AVGSKDAVAIL <- NULL
> flight$xHNGR <- NULL
> flight$AVAILBUCKET <- NULL
> 
> # This should be deleted, leave it in and the results are ideal because it defines LEGTYPE.
> flight$D00 <- NULL
> 
> ## Keep the results but don't change the order.
> outcomes.flight <- flight$LEGTYPE
> 
> flight$LEGTYPE <- NULL
> 
> ## Try converting all the factors to numerics
> 
> flight[,names(x1[which(x1$V1 %in% c("factor")),])]
Error in `[.data.frame`(flight, , names(x1[which(x1$V1 %in% c("factor")),  : 
  undefined columns selected
> 
> ## If you know your factors are definitely factors, you don't need this
> ##  asNumeric <- function(x) as.numeric(as.character(x))
> 
> factors.numeric <- function(d) modifyList(d, lapply(d[, sapply(d, is.factor)], as.numeric))
> 
> flight.num0 <- factors.numeric(flight)
> 
> flight.scl0 <- scale(flight.num0)
> 
> ## Now split the results
> 
> inTrain <- createDataPartition(outcomes.flight, p = 0.75, list = FALSE)
> 
> trainDescr <- flight.scl0[inTrain,]
> testDescr <- flight.scl0[-inTrain,]
> 
> trainClass <- outcomes.flight[inTrain]
> testClass <- outcomes.flight[-inTrain]
> 
> prop.table(table(flight.scl0))
flight.scl0
    -2.99546983996958     -2.98604368384811     -2.82110052361751 
           0.00281250            0.00015625            0.00015625 
    -2.64037641778924     -2.37742331516569     -2.09431321436608 
           0.00015625            0.00015625            0.00031250 
    -2.02525208119049     -2.02364615961949     -1.96706162425765 
           0.00046875            0.00093750            0.00015625 
    -1.94787383036273     -1.91934227796699     -1.87162293167633 
           0.00125000            0.00015625            0.00015625 
    -1.80813803757891      -1.8064397520718     -1.76880294648328 
           0.00093750            0.00093750            0.00453125 
     -1.7104004231695     -1.67620690253875     -1.63572266525187 
           0.00312500            0.00015625            0.00078125 
    -1.60554554037119     -1.58829697245811     -1.58375887562806 
           0.00265625            0.00062500            0.00031250 
    -1.56068940274137     -1.55266802930898     -1.55257138616628 
           0.00593750            0.00015625            0.00015625 
    -1.54865734259279     -1.54635333101763     -1.54295794614133 
           0.00015625            0.00015625            0.00015625 
    -1.53179508600425     -1.53074294246617     -1.50769426210174 
           0.00203125            0.00015625            0.00015625 
    -1.49330986644838     -1.47983129638045     -1.47646498237513 
           0.00015625            0.00171875            0.00015625 
    -1.44796824755814     -1.43812707979848     -1.43616463590287 
           0.00015625            0.00031250            0.00015625 
     -1.4311495031078     -1.42786750675664     -1.42754311366228 
           0.00062500            0.00031250            0.00015625 
     -1.4230237164245     -1.42196682798086     -1.40691590144974 
           0.00015625            0.00015625            0.00750000 
    -1.40295304316347     -1.39839761187043     -1.38337483337197 
           0.00343750            0.00015625            0.00015625 
    -1.37828409873765     -1.37590371713284      -1.3753288895824 
           0.00031250            0.00078125            0.00015625 
    -1.37383369560894     -1.37045453151584     -1.35466334686085 
           0.00015625            0.00015625            0.00015625 
    -1.33716625322094     -1.33398496346823     -1.33080367371552 
           0.00015625            0.00015625            0.00015625 
    -1.32393992750903      -1.3160853172316     -1.31578091655701 
           0.00093750            0.00015625            0.00015625 
    -1.31443367614047      -1.3133256164209     -1.30151560934568 
           0.00015625            0.00015625            0.00015625 
    -1.30111163600234     -1.29600486257245     -1.28619597667342 
           0.00015625            0.00031250            0.00031250 
    -1.28367748081635     -1.28186181839242      -1.2799413346293 
           0.00031250            0.00015625            0.00015625 
    -1.27197613788523     -1.26773489691459      -1.2671778786613 
           0.00109375            0.00015625            0.00015625 
     -1.2615812276646     -1.25974760485758     -1.25283365916062 
           0.00031250            0.00078125            0.00015625 
    -1.25178454113998     -1.24659260411695     -1.24079645146543 
           0.00015625            0.00015625            0.00015625 
     -1.2302338686483     -1.23020377865797      -1.2268968080815 
           0.00015625            0.00687500            0.00031250 
    -1.22001234826142     -1.21809512250389     -1.21512040999215 
           0.00046875            0.00015625            0.00015625 
    -1.21024953572476     -1.20647153886774     -1.20560405725029 
           0.00015625            0.00015625            0.00015625 
    -1.20188627600106     -1.20036054595575     -1.20011285144544 
           0.00031250            0.00140625            0.00015625 
    -1.19042311450129     -1.18991798468508     -1.18966337127103 
           0.00015625            0.00015625            0.00062500 
    -1.16804855863761     -1.16764210792351     -1.16749679150174 
           0.00093750            0.00015625            0.00015625 
    -1.16258400593847     -1.16018257780086     -1.15839829359119 
           0.00015625            0.00640625            0.00015625 
    -1.14179763548495     -1.13992628855288     -1.13935994002253 
           0.00015625            0.00031250            0.00031250 
    -1.13310730700243     -1.13102279477938     -1.12993289335973 
           0.00015625            0.00015625            0.00015625 
    -1.12915754122589     -1.12753063368423     -1.12667091460446 
           0.00015625            0.00015625            0.00015625 
    -1.12622940836933     -1.12368140470519     -1.12361616254288 
           0.00031250            0.00015625            0.00062500 
    -1.12145428351456     -1.11910330109794     -1.11800948418703 
           0.00015625            0.00015625            0.00015625 
    -1.11608476901381     -1.11429923219746     -1.09261479989672 
           0.00062500            0.00015625            0.00015625 
    -1.09084552937417     -1.09012044993392      -1.0895833019642 
           0.00015625            0.00015625            0.00031250 
    -1.08549109658463     -1.06938028371369     -1.06604781193988 
           0.00031250            0.00015625            0.00015625 
    -1.06587003530766        -1.06412097939     -1.05534288054392 
           0.00015625            0.00046875            0.00015625 
    -1.04945721011816     -1.04845626690162     -1.04766888572427 
           0.00015625            0.00015625            0.00015625 
    -1.04755297964098     -1.04598728075964     -1.04536609890991 
           0.00031250            0.00031250            0.00031250 
    -1.02993885350447     -1.02151758080685     -1.01733580186582 
           0.00015625            0.00203125            0.02453125 
    -1.01577847702439      -1.0138904262493      -1.0121571897662 
           0.00015625            0.00015625            0.00062500 
    -1.00929178081963     -1.00745946934895     -1.00714202059705 
           0.00015625            0.00015625            0.00015625 
    -1.00664275166081     -1.00407661804032     -1.00110637205939 
           0.00046875            0.00015625            0.00015625 
   -0.997768048748026    -0.991929422812267    -0.989060788495757 
           0.00328125            0.00015625            0.00031250 
    -0.98572380365604    -0.979554261682366    -0.976324799963229 
           0.00015625            0.00031250            0.00875000 
   -0.973173077974651    -0.971118460177678     -0.96975725707502 
           0.01640625            0.00015625            0.00015625 
   -0.963461694934854    -0.961159884505833    -0.960193400142389 
           0.00015625            0.00015625            0.00046875 
   -0.958010282948452    -0.957720936633644    -0.955230663538487 
           0.00015625            0.00015625            0.00015625 
   -0.953451859649493    -0.952397629449069    -0.951677411170411 
           0.00031250            0.00015625            0.01765625 
   -0.947281520180146    -0.946066444247069    -0.942123167843126 
           0.00015625            0.00015625            0.00015625 
   -0.941185041055857    -0.939666457415937    -0.937914389255748 
           0.00015625            0.00031250            0.00015625 
   -0.937428692031181    -0.937143144639067    -0.929006249994557 
           0.00015625            0.00203125            0.00031250 
   -0.928956547037233    -0.927234345076844    -0.926325405165677 
           0.00015625            0.00015625            0.00015625 
   -0.926208874394783     -0.92432711582923    -0.923751900565718 
           0.00015625            0.00015625            0.00015625 
   -0.921447647976772    -0.920026610901552    -0.919775930100724 
           0.00015625            0.00015625            0.00031250 
   -0.919418999070816    -0.918979533540974    -0.918834367344145 
           0.00093750            0.00015625            0.00015625 
   -0.918602057207572    -0.918233359080158    -0.916620305783416 
           0.00015625            0.00015625            0.00031250 
   -0.908229610518583    -0.907879271266391    -0.907626204980156 
           0.00031250            0.00015625            0.00015625 
   -0.906631706666217    -0.905610577820333    -0.905104725277818 
           0.00015625            0.00015625            0.00015625 
   -0.904170844231002    -0.902563699445797    -0.902495470961171 
           0.00031250            0.00015625            0.00046875 
   -0.902207570970879    -0.900277820755885    -0.900269127160796 
           0.00015625            0.00609375            0.00015625 
   -0.900105713501894    -0.897103060359799    -0.896252308815885 
           0.00015625            0.00015625            0.00015625 
   -0.895759768448355    -0.895685333371447    -0.891948830933419 
           0.00015625            0.00015625            0.00015625 
   -0.891482707849845     -0.89086838304768    -0.889814536282523 
           0.00015625            0.02343750            0.00015625 
   -0.886894039811436    -0.885423108336021    -0.885386138492139 
           0.00093750            0.00015625            0.01593750 
   -0.884574764423174    -0.881181388644532    -0.881133728915611 
           0.00015625            0.00015625            0.00015625 
   -0.879323305434347    -0.878872666379052    -0.877901133624378 
           0.00015625            0.00015625            0.00015625 
   -0.876749332956921    -0.876685019263073    -0.875765771148607 
           0.00031250            0.00015625            0.00031250 
   -0.875473779114446     -0.87537693015952    -0.872246314823305 
           0.00015625            0.00015625            0.00015625 
   -0.871001261435858    -0.870353841103083    -0.869162583211394 
           0.00015625            0.00015625            0.00015625 
   -0.866780745576637    -0.866244907634358    -0.858819232798091 
           0.00015625            0.00015625            0.00015625 
   -0.856265820894777    -0.844253476212177    -0.844066341550782 
           0.00078125            0.00015625            0.00015625 
   -0.842025743633279    -0.831738843759029    -0.830837909586882 
           0.02921875            0.00015625            0.02515625 
   -0.829374923233683    -0.828920190368225    -0.827915178181078 
           0.00015625            0.00093750            0.00015625 
   -0.827728686266157    -0.826039032973297    -0.822416105203804 
           0.00015625            0.00015625            0.00015625 
   -0.821797313281808    -0.819285769008092    -0.816336564086851 
           0.00015625            0.00015625            0.00015625 
   -0.814051297945908    -0.811605617460827    -0.809148421270981 
           0.00015625            0.00015625            0.00015625 
   -0.804302031270971    -0.800154571238789    -0.795175551540305 
           0.00062500            0.00015625            0.00171875 
   -0.792845872277945    -0.790185643279993    -0.789212464897955 
           0.02015625            0.00859375            0.00046875 
   -0.787996109659257    -0.785742695872334    -0.783287556756109 
           0.00015625            0.00015625            0.00015625 
    -0.78222517242437    -0.777611190965241    -0.777259256743858 
           0.00015625            0.00015625            0.00015625 
   -0.775052088417874    -0.768725111385422      -0.7653899578722 
           0.00031250            0.00015625            0.00015625 
   -0.764328853007072    -0.759372004638613    -0.759121665238872 
           0.00015625            0.00015625            0.00015625 
   -0.758171518227594    -0.752387355098689    -0.752338241647165 
           0.00015625            0.00015625            0.00031250 
   -0.751716727129916    -0.750007134146443    -0.748171465050933 
           0.00015625            0.00562500            0.00015625 
   -0.743693425437366     -0.74226506946404    -0.738477819728135 
           0.00718750            0.00015625            0.00015625 
   -0.735940818773818    -0.734501921638923    -0.723911474638978 
           0.00015625            0.00015625            0.00015625 
   -0.720697236097384    -0.718445199078953    -0.715142805531928 
           0.00031250            0.00015625            0.00031250 
   -0.713461500253351    -0.710452171936934    -0.708684788599593 
           0.00015625            0.00015625            0.00015625 
   -0.708003561812545    -0.702080356630785     -0.70037445202336 
           0.00015625            0.00015625            0.00203125 
    -0.69602539257426     -0.69280361708918    -0.687853983052082 
           0.00015625            0.03375000            0.00015625 
    -0.68694861300278    -0.684622918007104    -0.682222958529648 
           0.00015625            0.00015625            0.00015625 
   -0.681188975020078    -0.673798181086569     -0.66884926915034 
           0.00187500            0.00015625            0.00015625 
     -0.6653122497357    -0.654779601264497    -0.648410662399554 
           0.00015625            0.00015625            0.00078125 
   -0.647068571912601    -0.646559789740211    -0.633905116384853 
           0.00015625            0.00015625            0.00015625 
   -0.633276439235621    -0.626480919280269    -0.624813955253419 
           0.00015625            0.00015625            0.00015625 
   -0.621563193776932    -0.615573756562581    -0.613123253862724 
           0.00015625            0.00015625            0.00171875 
   -0.604038319371604    -0.596446872775748    -0.596237216599971 
           0.00015625            0.00046875            0.00015625 
   -0.596137826610777    -0.592583054332584    -0.590968847296576 
           0.00015625            0.00359375            0.00015625 
   -0.581016668721787     -0.57842864719944    -0.577046832499099 
           0.00015625            0.00015625            0.00015625 
   -0.576399963736262    -0.567294133064953    -0.562646449882806 
           0.00187500            0.00015625            0.00031250 
   -0.559949234902497    -0.553868745195444    -0.551562209118441 
           0.00031250            0.00015625            0.00859375 
   -0.548486073402725    -0.545057532705371    -0.544483083151942 
           0.00015625            0.00046875            0.00093750 
   -0.543553164656681    -0.542887786706365    -0.542791834600063 
           0.00015625            0.00015625            0.03859375 
   -0.535816263171991    -0.529620965141671    -0.523583345339874 
           0.00031250            0.00015625            0.00015625 
   -0.522876883678594    -0.515144874010522    -0.511242837482551 
           0.00015625            0.00015625            0.00015625 
   -0.511062050911504    -0.509452501139644    -0.507981951223969 
           0.00500000            0.00015625            0.00015625 
   -0.506004946851197    -0.504251327555701    -0.503668338010739 
           0.00015625            0.00203125            0.00015625 
   -0.497665904683127    -0.492519293528136    -0.488304476973275 
           0.00015625            0.00062500            0.00015625 
   -0.486275884354524    -0.480531685495119    -0.479070530598709 
           0.00015625            0.00015625            0.00015625 
   -0.476991811548017    -0.475764665500524    -0.473473045518126 
           0.00078125            0.00015625            0.00015625 
   -0.472612890303562    -0.464757185992567    -0.456186401194196 
           0.00015625            0.00015625            0.00015625 
   -0.454553689487183    -0.453074332488957    -0.452195518537862 
           0.00015625            0.00015625            0.00015625 
   -0.450040882361118    -0.446015592229304    -0.443168278929009 
           0.00015625            0.00015625            0.00015625 
    -0.44055550390433    -0.439275967288811    -0.439064986884659 
           0.00093750            0.00015625            0.00031250 
   -0.436572045333686    -0.433356062339654     -0.43210269137514 
           0.00015625            0.00015625            0.00031250 
   -0.429159183376661     -0.42811270638386    -0.424489571114943 
           0.00015625            0.00015625            0.00015625 
   -0.424136094192972    -0.422368710855631    -0.422286506964679 
           0.00015625            0.00015625            0.00015625 
     -0.4217879739841     -0.42160028367728    -0.408926090390664 
           0.00015625            0.00015625            0.00062500 
   -0.406238662084726    -0.405337563546837    -0.402845924603104 
           0.00015625            0.00015625            0.00015625 
   -0.398392401687235    -0.392753100892855    -0.392721940787981 
           0.00015625            0.00015625            0.00015625 
   -0.389990557124863    -0.383778543291898    -0.381829344162238 
           0.00203125            0.00031250            0.00031250 
   -0.378610740922975    -0.377352421209284     -0.37278098800314 
           0.00015625            0.00015625            0.00015625 
   -0.368704530397105    -0.364033384865912    -0.363121805899083 
           0.00015625            0.00015625            0.00015625 
   -0.361905601371654    -0.360992312891898     -0.36077985218898 
           0.00015625            0.00015625            0.00015625 
    -0.35995405519458    -0.354602189779798    -0.354221703071568 
           0.00046875            0.00015625            0.00015625 
   -0.354125613590753     -0.35383985286255    -0.350820163721666 
           0.00015625            0.00015625            0.00015625 
   -0.347880750045415    -0.347682518083072    -0.344794514479224 
           0.00031250            0.00015625            0.00015625 
   -0.344246401931106    -0.340586009596143    -0.338241270869783 
           0.00015625            0.00015625            0.00031250 
   -0.336627924656718    -0.333999550987416    -0.331679860754818 
           0.00015625            0.00015625            0.00015625 
   -0.327473828580897    -0.325591270635287    -0.320604647133837 
           0.00015625            0.00015625            0.00015625 
   -0.320293393650012    -0.318998347766866    -0.313800886365509 
           0.00015625            0.00015625            0.00015625 
   -0.308729731711204     -0.30775968479621    -0.307488803472333 
           0.00015625            0.00062500            0.00015625 
   -0.305912488397539    -0.300040013990283    -0.299281804870489 
           0.00015625            0.00015625            0.00015625 
   -0.297576089117692    -0.294612153988498    -0.290886990303406 
           0.00015625            0.00015625            0.00015625 
   -0.289476667647491    -0.287805419014019    -0.284664135032912 
           0.00015625            0.00031250            0.00062500 
   -0.283279035792871    -0.278947445070673    -0.278430676385642 
           0.00015625            0.00015625            0.01140625 
   -0.277028655971768    -0.274352800845479    -0.269810489634915 
           0.00015625            0.00015625            0.00875000 
   -0.268327804913194    -0.264273008183568    -0.263991250766728 
           0.00015625            0.00015625            0.00015625 
   -0.263633329101249    -0.256569345435893    -0.255210887064625 
           0.00015625            0.00015625            0.00015625 
   -0.254264930167697    -0.253205544043426    -0.250717006205447 
           0.00015625            0.00015625            0.00015625 
   -0.250531752899298    -0.249985351299549    -0.247578088366761 
           0.00015625            0.00015625            0.00015625 
   -0.244437996150226    -0.243268618233703    -0.242824942853484 
           0.00015625            0.00015625            0.00015625 
   -0.233740722783471    -0.232700345409106    -0.232349973253986 
           0.00015625            0.00015625            0.00015625 
   -0.231815214890401    -0.231309362347886     -0.23037548130107 
           0.00015625            0.00015625            0.00015625 
   -0.228412208040947    -0.226589859802479    -0.224837647995068 
           0.00015625            0.01656250            0.00015625 
   -0.223464759128966     -0.22331717855311    -0.222588752387258 
           0.00015625            0.00015625            0.00015625 
   -0.222456945885953    -0.220222816737245    -0.217487288707678 
           0.00015625            0.00031250            0.00046875 
   -0.216388232760497    -0.213098676881504    -0.212807560710942 
           0.00015625            0.00093750            0.00015625 
   -0.205527942504415    -0.202889656333141    -0.199061273711729 
           0.00015625            0.00015625            0.00015625 
   -0.197285663071406    -0.196655198635886    -0.187398059917142 
           0.00015625            0.00015625            0.00328125 
    -0.18553936273967    -0.184426534107832      -0.1807365557853 
           0.00015625            0.00015625            0.00031250 
   -0.173455385110242    -0.170696066339926    -0.167983070845547 
           0.00953125            0.00062500            0.00015625 
    -0.16706735776498     -0.16549287956689    -0.163323851054559 
           0.00015625            0.00015625            0.00015625 
   -0.163005226779217    -0.155721964916119     -0.15557956030375 
           0.00015625            0.00015625            0.00015625 
   -0.145050220201077    -0.140627037006184    -0.136663205761249 
           0.00015625            0.00015625            0.00015625 
   -0.135547666352963    -0.135353058341049    -0.135168941442998 
           0.00015625            0.00015625            0.00015625 
    -0.13422823788067    -0.128983100398563    -0.128772766161494 
           0.00015625            0.00015625            0.00062500 
   -0.128276147190878    -0.124732071896041    -0.122750748897942 
           0.00015625            0.00015625            0.00015625 
   -0.121913567685457    -0.114572129500928    -0.113273027561381 
           0.00015625            0.00015625            0.00015625 
   -0.107405286684043    -0.105529863556612    -0.103356043915892 
           0.00015625            0.00953125            0.00015625 
  -0.0959919473132286   -0.0946576344451732   -0.0921610479659292 
           0.00015625            0.00031250            0.00015625 
  -0.0897276946329045    -0.082082912166815   -0.0820786945748793 
           0.00015625            0.00015625            0.00031250 
  -0.0807439358161152   -0.0768089765376881   -0.0759616047321375 
           0.00015625            0.00140625            0.00015625 
  -0.0741942213947964   -0.0733788467156504   -0.0726315828860554 
           0.00015625            0.00718750            0.00015625 
  -0.0685974846038955   -0.0532150311664168   -0.0498043335027671 
           0.00093750            0.00015625            0.00015625 
  -0.0497543467601004   -0.0473016251818649   -0.0451490777305966 
           0.00015625            0.00015625            0.00031250 
  -0.0446498361490209   -0.0392160026639466   -0.0373582346840002 
           0.00015625            0.00015625            0.00015625 
  -0.0352851923820555   -0.0345646240252186   -0.0326438116903773 
           0.00031250            0.00031250            0.00015625 
  -0.0248451869138821   -0.0188880173129063    -0.013807090586871 
           0.00109375            0.00015625            0.00015625 
  -0.0119657325121257   -0.0114810502208166  -0.00721676013122688 
           0.00015625            0.00015625            0.00015625 
 -0.00368424503602545 -0.000580656453063986   0.00425466589044258 
           0.00015625            0.00015625            0.00015625 
  0.00624696207963468   0.00661720265702806    0.0104887638020741 
           0.00015625            0.00015625            0.00015625 
   0.0151944372905789    0.0177528116242494    0.0194770878491831 
           0.00421875            0.00015625            0.00015625 
   0.0217087977522383    0.0235168212825711    0.0255537765734798 
           0.00015625            0.00015625            0.00015625 
   0.0264730080152699    0.0271186027099238    0.0361351573082595 
           0.00015625            0.00031250            0.00015625 
   0.0362911121323546    0.0368634437985054    0.0454309894047899 
           0.00015625            0.00015625            0.00015625 
   0.0533298995579193    0.0570581595639766    0.0585759323236618 
           0.00015625            0.00937500            0.00015625 
   0.0675339577108118    0.0702113818864803    0.0729377618887858 
           0.00046875            0.00015625            0.00062500 
   0.0788793134968683    0.0789059252411879    0.0790823923337298 
           0.00015625            0.02343750            0.00046875 
   0.0797510873183287    0.0806069942083428    0.0841639835120876 
           0.00015625            0.00015625            0.00015625 
   0.0899621750174284    0.0966606496804153    0.0972018193465008 
           0.00015625            0.00015625            0.00015625 
    0.101566818289489     0.108411810410797     0.109012079979066 
           0.00062500            0.00015625            0.00046875 
     0.11244290268093     0.119444894039026     0.131046181957536 
           0.00015625            0.00015625            0.00203125 
    0.134889340170799     0.135028927523559     0.136658265622521 
           0.00015625            0.00015625            0.00015625 
    0.144157938789208     0.146258849789861     0.147318188850963 
           0.00015625            0.00015625            0.02984375 
    0.151115033119933     0.152349655315244     0.154426066228552 
           0.00015625            0.00015625            0.00015625 
     0.15737266071083     0.162873929857665     0.162973153669365 
           0.00015625            0.00015625            0.00015625 
    0.164891939398059     0.165580765616732     0.173693095305534 
           0.00015625            0.00015625            0.00015625 
    0.183009971581342     0.186789363756051     0.187969991368742 
           0.00093750            0.00015625            0.00015625 
    0.192709893790261     0.194724832331223     0.194735738184732 
           0.00015625            0.00015625            0.00015625 
    0.195991364801127     0.206802781312992     0.210386154876613 
           0.00015625            0.00015625            0.00500000 
    0.217235034249908       0.2177869344983     0.234906769563277 
           0.00031250            0.00203125            0.00015625 
    0.234973761205148     0.238837237065174     0.241127733319099 
           0.00031250            0.00015625            0.00015625 
    0.250135635132824      0.25028785413495     0.253309352340188 
           0.00015625            0.00015625            0.00078125 
    0.254814769298151     0.260835355687548     0.264960519475955 
           0.00015625            0.00015625            0.00015625 
    0.266044692238248      0.27127954776092     0.273304013334367 
           0.00015625            0.00015625            0.00015625 
    0.273531307307048     0.274822103147971     0.280770740587068 
           0.00015625            0.00015625            0.00015625 
    0.284591080073122     0.285810915205503     0.286937550828954 
           0.00015625            0.00015625            0.00046875 
    0.289640625615739     0.301307082566931     0.302882181759369 
           0.00015625            0.00015625            0.00015625 
    0.304256560508303     0.309710068792923     0.311251030414092 
           0.00015625            0.00015625            0.00015625 
    0.311802268812853     0.318128929047187     0.318922298138204 
           0.00015625            0.00031250            0.00015625 
    0.320852365313198     0.322875645177539     0.334350357273903 
           0.00015625            0.00015625            0.00015625 
    0.337167536402539     0.338400625416362     0.338901340452759 
           0.00015625            0.00031250            0.00140625 
    0.346939027258188     0.348766831423466     0.358991725758732 
           0.00015625            0.00015625            0.00015625 
    0.364034892089946     0.365884194608935     0.368674799710984 
           0.00015625            0.00015625            0.00015625 
    0.369643258716518     0.373829702918903     0.379821273586168 
           0.00015625            0.00062500            0.00015625 
    0.382087226815338      0.38685609839469       0.3878539441829 
           0.00015625            0.00015625            0.00015625 
     0.38923354153609     0.390865130076565     0.393785793790202 
           0.00015625            0.00093750            0.00015625 
    0.402956322412276     0.404247945632944      0.40569298299336 
           0.00015625            0.00015625            0.00015625 
    0.406064629649282      0.40786256349758     0.408056423319527 
           0.00015625            0.00109375            0.00015625 
    0.412247177017014     0.414419483912049     0.416346031539166 
           0.00015625            0.00046875            0.00015625 
     0.41794166276908     0.419463447191946     0.420106603846799 
           0.00015625            0.01078125            0.00015625 
    0.420379431706021     0.420869449539072     0.431214346889845 
           0.00406250            0.00015625            0.00015625 
    0.433937840525743     0.440278644951702     0.441895424076257 
           0.00031250            0.00015625            0.00015625 
    0.442828919700371     0.443274873059508     0.446173888246631 
           0.00046875            0.00984375            0.00015625 
    0.450718587802467     0.456900610463576     0.459555681956315 
           0.00015625            0.00031250            0.00015625 
    0.460696686048428     0.467876105484108     0.472728746197005 
           0.00015625            0.00015625            0.00015625 
    0.474472217743954     0.474601080341499     0.474734089218203 
           0.00015625            0.00031250            0.00015625 
    0.477973490467994     0.484307789443022     0.484652344952628 
           0.00015625            0.00015625            0.00015625 
    0.494792709324177     0.498497691565453     0.500784787450151 
           0.00109375            0.00515625            0.00015625 
    0.504691880000581     0.508425703980646      0.50861676779181 
           0.00031250            0.00015625            0.00015625 
     0.50996114523361     0.514344382856681     0.516995457862692 
           0.00015625            0.00015625            0.00015625 
    0.518586102739047     0.521829770584971     0.523840570430114 
           0.00015625            0.00015625            0.00015625 
    0.524285913333902     0.525227742436545     0.527917885589494 
           0.00015625            0.00015625            0.00015625 
    0.531983533422768     0.539966728864973     0.541903897062432 
           0.00015625            0.00015625            0.00046875 
    0.543994005812287     0.545724786000498     0.546756498947983 
           0.00125000            0.00015625            0.00203125 
    0.548923619243861     0.549353970396232       0.5588553176537 
           0.00015625            0.00015625            0.00031250 
    0.564138483610525     0.566992546543754     0.569133261860447 
           0.00015625            0.00015625            0.00015625 
    0.574903744908869     0.577978215152712     0.578343495716271 
           0.00031250            0.00109375            0.00015625 
    0.580241024741447     0.581634314964003     0.583204933976379 
           0.00015625            0.00015625            0.00015625 
     0.58873859479558     0.595455758634415     0.597057916427158 
           0.00015625            0.00031250            0.00015625 
    0.598720288571789     0.599162991111384     0.599578938399305 
           0.00031250            0.00015625            0.00015625 
     0.60342049593258     0.604292419065582     0.607847397763963 
           0.00015625            0.00015625            0.00015625 
    0.611956869618315     0.612059726969641     0.612784292101807 
           0.00015625            0.00062500            0.00015625 
    0.613557486760981     0.620580331763515     0.622971928913742 
           0.00015625            0.00015625            0.00375000 
     0.63588348041021     0.641390081029809     0.643182929950686 
           0.00015625            0.00015625            0.00015625 
    0.648293425210027     0.650684078195595     0.657754904789885 
           0.00015625            0.00046875            0.00015625 
    0.664732625480728     0.665678528246394     0.665791697835918 
           0.00015625            0.00984375            0.00015625 
    0.666578602798705     0.678050028820375     0.678379635730825 
           0.00015625            0.00015625            0.00015625 
    0.679808655934455     0.680412565586961     0.680711498268701 
           0.00328125            0.00015625            0.00015625 
    0.684080216155581     0.684149053017272     0.685295140133807 
           0.00281250            0.00015625            0.00031250 
    0.686201169423553     0.690582799388141     0.692180702201577 
           0.00015625            0.00421875            0.00015625 
    0.696595449900374     0.697435597111395     0.698914306548046 
           0.00015625            0.00015625            0.00015625 
     0.70193206265865     0.702647867819401     0.707754986014002 
           0.00015625            0.00062500            0.00015625 
    0.711210346763156     0.712920206015224     0.713369947147153 
           0.00015625            0.00015625            0.00015625 
    0.715327471836729     0.722275487513834     0.722728216151602 
           0.00031250            0.00156250            0.00015625 
      0.7239248415172      0.72708089915877     0.729737150343281 
           0.00015625            0.00015625            0.00015625 
    0.735388003016973     0.740385327518889     0.741422651587756 
           0.00031250            0.00015625            0.00015625 
    0.741444754160499     0.747108762937508     0.748191169284348 
           0.00015625            0.00031250            0.00015625 
    0.751436430272142     0.752533256420978     0.752674676426801 
           0.00015625            0.00015625            0.00015625 
    0.754611657443207     0.754889027400603     0.756349639135923 
           0.00125000            0.00015625            0.00015625 
    0.763526062479594     0.768717423291569     0.770997182276433 
           0.00015625            0.00015625            0.00015625 
     0.77805655959217     0.780455501601279      0.79111659134251 
           0.00015625            0.00015625            0.00015625 
    0.794424123694395     0.794542595446869     0.797594367513394 
           0.00046875            0.00015625            0.00015625 
    0.806459604893308     0.806575447067013     0.815325824113437 
           0.00015625            0.00171875            0.00031250 
    0.820054212719794     0.821566079066492     0.822735985643791 
           0.00015625            0.00015625            0.00015625 
    0.824910396049865     0.825564426121463     0.827093295015157 
           0.00015625            0.00281250            0.00015625 
    0.830498441784675     0.839706577696515     0.854374875678462 
           0.00031250            0.00015625            0.00015625 
    0.857045424718981     0.857046899457354     0.858539236690819 
           0.00031250            0.00015625            0.00109375 
    0.861958482401254     0.864973903806387     0.868060666977836 
           0.00015625            0.00031250            0.00015625 
    0.871547517399078     0.877907606552374     0.878620392468042 
           0.00015625            0.00031250            0.00015625 
    0.882079910398028     0.886773165429333     0.895872264013794 
           0.00015625            0.00015625            0.00031250 
    0.902874892971196     0.909893594892982     0.910503026314625 
           0.00015625            0.00015625            0.00015625 
    0.918355472177732     0.923930998062757     0.928610132228083 
           0.00156250            0.00015625            0.00015625 
    0.930580294371997     0.932353440099381     0.933043163131344 
           0.00015625            0.00015625            0.00015625 
    0.935865275090846     0.938721396055517      0.94732667023698 
           0.00015625            0.00015625            0.00015625 
    0.952388332756409     0.953472399517577     0.960457391255192 
           0.00046875            0.00015625            0.00015625 
    0.962466815938431     0.974608403263273     0.977273131185975 
           0.00031250            0.00015625            0.00015625 
    0.979887858238853     0.981765099822977     0.982533764258785 
           0.02546875            0.00015625            0.00015625 
    0.986421193335086     0.991131333762411      0.99464772824313 
           0.00046875            0.00015625            0.00015625 
     1.00529335053186      1.01443060556224       1.0145402019372 
           0.00015625            0.00062500            0.00015625 
     1.02257036343242      1.02480443153783      1.02810330735672 
           0.00015625            0.00015625            0.00015625 
     1.02815692332918       1.0286099206142      1.03278708868866 
           0.00265625            0.00015625            0.00015625 
     1.03867605371823      1.04030809775545      1.05026762861212 
           0.00015625            0.00046875            0.00015625 
     1.05448691449244       1.0552263521649      1.05588258974527 
           0.00125000            0.00015625            0.00015625 
     1.06000513122926      1.06639439518604      1.07107601485988 
           0.00906250            0.00078125            0.00015625 
     1.07323792501438      1.07985999257921      1.08185178624946 
           0.00015625            0.00015625            0.00015625 
     1.08200577310599      1.08501442587133      1.08924264046828 
           0.00015625            0.00015625            0.00015625 
     1.09237983879524      1.09858922192811      1.09934822043348 
           0.00015625            0.00015625            0.00015625 
      1.1078948637414      1.11407400788163      1.11835818480985 
           0.00015625            0.00015625            0.00093750 
     1.11909298650692      1.12255263564979      1.13098492845703 
           0.00125000            0.00640625            0.00718750 
     1.13520899613199      1.13659865262031      1.14324263811607 
           0.00015625            0.00031250            0.00015625 
      1.1444495252129       1.1551673045972      1.15841602768456 
           0.00578125            0.00046875            0.00015625 
     1.17032197443365      1.17077944389967      1.17660425916148 
           0.00156250            0.01546875            0.00015625 
     1.17671971786951      1.18390085758965      1.19061835680715 
           0.00031250            0.02078125            0.00078125 
     1.19124162268748      1.19491419845781      1.20187158527135 
           0.00046875            0.01000000            0.00015625 
     1.20935820034015      1.21534749252995      1.21684078311872 
           0.00015625            0.00015625            0.00015625 
     1.22228576405746      1.22358524293339       1.2307494205369 
           0.00046875            0.00375000            0.00359375 
     1.23190824585799      1.23309624815214       1.2482497077686 
           0.00015625            0.00015625            0.00015625 
     1.24914605564843      1.25030062698194      1.25167385090479 
           0.00015625            0.00015625            0.00015625 
      1.2521388586462      1.25403638767138      1.25696184836792 
           0.00015625            0.00015625            0.00015625 
     1.25865710330342      1.26219503016375      1.26339025886804 
           0.00015625            0.00015625            0.00062500 
     1.27424955368127      1.27429889692881      1.27581391381442 
           0.00062500            0.01093750            0.00015625 
     1.28103448636196      1.28422435170195      1.28502302740832 
           0.00015625            0.00015625            0.00015625 
     1.28694332261892      1.28862136579613      1.29135133286724 
           0.00015625            0.00015625            0.00015625 
     1.29271693854318      1.29352984392642      1.29416501801516 
           0.00093750            0.00015625            0.00015625 
     1.32000923372796      1.32621334330507      1.32674979912185 
           0.00015625            0.00031250            0.00031250 
      1.3355388950486      1.33819762355126      1.34572143844383 
           0.00703125            0.00015625            0.00015625 
     1.34900429115538      1.35106912963136      1.35909050306374 
           0.00015625            0.00015625            0.00015625 
     1.36740896432616      1.37732504122682      1.37817713292888 
           0.00015625            0.00015625            0.00171875 
     1.38155034894393      1.38244688032714      1.38971756538262 
           0.00015625            0.00015625            0.00015625 
     1.39337346848199      1.39481552027921      1.39920925968592 
           0.00015625            0.00015625            0.00015625 
     1.40401019415033      1.40768753122916      1.42034462702771 
           0.00015625            0.00046875            0.00031250 
     1.42884838085788      1.43014092255268      1.43175470937195 
           0.00062500            0.00078125            0.00015625 
     1.43334191774463      1.43396654425843      1.43750664054499 
           0.00046875            0.00015625            0.00015625 
     1.43754219334743       1.4388998201083      1.44153927902681 
           0.00015625            0.01625000            0.01421875 
     1.44769121849116      1.44889234688456      1.45317034273597 
           0.00015625            0.00015625            0.00015625 
     1.45756717172523      1.46514717542552      1.48152004641465 
           0.00015625            0.01359375            0.00015625 
     1.48210471217649       1.4854271336131      1.49691410201524 
           0.00187500            0.00015625            0.00031250 
     1.50460499505036          1.5159104855      1.51944062018193 
           0.00015625            0.00062500            0.00015625 
     1.51951797036384      1.52322014302823      1.52914361888698 
           0.00015625            0.00015625            0.00015625 
     1.53094696259391      1.53185854523801      1.54534195968881 
           0.00015625            0.00015625            0.00015625 
     1.55198480359028      1.55950143190504      1.56497982317259 
           0.00031250            0.00015625            0.00015625 
     1.58262031982126      1.59616721426295      1.60437565730193 
           0.00062500            0.00015625            0.00015625 
     1.61266940307664      1.61805143272205      1.63593441495235 
           0.00015625            0.00015625            0.00390625 
     1.66020775786113      1.67542635415394      1.67673538939901 
           0.00046875            0.00015625            0.00437500 
     1.68035708519021      1.68346836697786      1.68837599513398 
           0.00015625            0.00015625            0.00015625 
     1.68938234802037      1.70189867028665      1.70300688645049 
           0.00015625            0.00015625            0.00015625 
     1.70487078400102      1.71353493899627      1.72834558905075 
           0.00015625            0.00015625            0.00015625 
     1.72915591888238      1.73426417234817      1.74021109248258 
           0.00015625            0.00015625            0.00015625 
     1.74232222740301      1.74349939634561       1.7580041756475 
           0.00015625            0.00015625            0.00015625 
     1.76113921780106      1.76617520172517      1.77211632108358 
           0.00015625            0.00015625            0.00015625 
     1.77514993495452      1.79958280830507      1.81629669477704 
           0.00015625            0.00015625            0.00031250 
     1.81990457312901      1.83656963213994      1.83724270780201 
           0.00015625            0.01140625            0.00015625 
     1.84610801109783      1.87127556838068      1.87941151145041 
           0.00015625            0.00031250            0.00015625 
     1.88207392317223      1.89017691499225      1.91733288828094 
           0.00031250            0.00015625            0.00015625 
     1.94867279430132      1.95578696468731      1.95652907096428 
           0.00687500            0.00015625            0.00015625 
     1.96029188648611      1.97337415011671      1.97682872944693 
           0.00015625            0.00015625            0.00015625 
     1.97898223695928      2.01790204562771      2.04143987127407 
           0.00015625            0.00015625            0.00171875 
     2.04788306887298      2.07547273185274      2.09309957494449 
           0.00062500            0.00031250            0.00015625 
     2.09950420993508      2.10052429104874      2.10697756530747 
           0.00031250            0.00015625            0.00015625 
     2.11999156344762      2.12917389303477      2.15933629269958 
           0.00015625            0.00015625            0.00015625 
     2.18306393167287      2.18323513022319      2.18704108088277 
           0.00187500            0.00015625            0.00015625 
     2.23887211958444      2.24380917557826      2.28051444339884 
           0.00015625            0.00015625            0.00562500 
     2.28417103037285      2.30954548348617      2.34561980157645 
           0.00015625            0.00125000            0.00015625 
     2.52385907644018      3.01185818638057      3.23514293488871 
           0.00015625            0.00015625            0.00031250 
     3.52347021972545      4.91171482734768      5.33930094132038 
           0.00015625            0.00015625            0.00015625 
     6.39137994453622      6.97999767626588 
           0.00015625            0.00015625 
> 
> prop.table(table(trainClass))
trainClass
  Strong     Weak 
0.746888 0.253112 
> 
> dim(trainDescr)
[1] 241  20
> dim(testDescr)
[1] 79 20
> 
> ## Check Near-zero variance
> 
> nzv <- nearZeroVar(trainDescr, saveMetrics= TRUE)
> stopifnot( all(nzv$nzv == FALSE) )
> 
> # It's imputed and behaves well, no need for this.
> # descrCorr <- cor(scale(trainDescr), use = "pairwise.complete.obs")
> 
> descrCorr <- cor(scale(trainDescr))
> 
> highCorr <- findCorrelation(descrCorr, cutoff = .80, verbose = TRUE)
Considering row	 16 column	 1 value	 0.269 
Considering row	 16 column	 17 value	 0.859 
  Flagging column	 16 
Considering row	 1 column	 17 value	 0.295 
Considering row	 1 column	 10 value	 0.305 
Considering row	 1 column	 11 value	 0.988 
  Flagging column	 1 
Considering row	 17 column	 10 value	 0.65 
Considering row	 17 column	 11 value	 0.298 
Considering row	 17 column	 6 value	 0.257 
Considering row	 17 column	 12 value	 0.266 
Considering row	 17 column	 14 value	 0.25 
Considering row	 17 column	 2 value	 0.224 
Considering row	 17 column	 9 value	 0.524 
Considering row	 17 column	 8 value	 0.494 
Considering row	 17 column	 13 value	 0.219 
Considering row	 17 column	 3 value	 0.27 
Considering row	 17 column	 18 value	 0.259 
Considering row	 17 column	 19 value	 0.13 
Considering row	 17 column	 20 value	 0.041 
Considering row	 17 column	 4 value	 0.038 
Considering row	 17 column	 7 value	 0.097 
Considering row	 17 column	 15 value	 0.042 
Considering row	 17 column	 5 value	 0.024 
Considering row	 10 column	 11 value	 0.314 
Considering row	 10 column	 6 value	 0.34 
Considering row	 10 column	 12 value	 0.258 
Considering row	 10 column	 14 value	 0.225 
Considering row	 10 column	 2 value	 0.231 
Considering row	 10 column	 9 value	 0.359 
Considering row	 10 column	 8 value	 0.386 
Considering row	 10 column	 13 value	 0.177 
Considering row	 10 column	 3 value	 0.43 
Considering row	 10 column	 18 value	 0.198 
Considering row	 10 column	 19 value	 0.133 
Considering row	 10 column	 20 value	 0.07 
Considering row	 10 column	 4 value	 0.023 
Considering row	 10 column	 7 value	 0.208 
Considering row	 10 column	 15 value	 0.253 
Considering row	 10 column	 5 value	 0.117 
Considering row	 11 column	 6 value	 0.951 
  Flagging column	 11 
Considering row	 6 column	 12 value	 0.92 
  Flagging column	 6 
Considering row	 12 column	 14 value	 0.101 
Considering row	 12 column	 2 value	 0.138 
Considering row	 12 column	 9 value	 0.156 
Considering row	 12 column	 8 value	 0.07 
Considering row	 12 column	 13 value	 0.1 
Considering row	 12 column	 3 value	 0.149 
Considering row	 12 column	 18 value	 0.063 
Considering row	 12 column	 19 value	 0.115 
Considering row	 12 column	 20 value	 0.165 
Considering row	 12 column	 4 value	 0.066 
Considering row	 12 column	 7 value	 0.102 
Considering row	 12 column	 15 value	 0.108 
Considering row	 12 column	 5 value	 0.018 
Considering row	 14 column	 2 value	 0.593 
Considering row	 14 column	 9 value	 0.152 
Considering row	 14 column	 8 value	 0.164 
Considering row	 14 column	 13 value	 0.68 
Considering row	 14 column	 3 value	 0.026 
Considering row	 14 column	 18 value	 0.416 
Considering row	 14 column	 19 value	 0.03 
Considering row	 14 column	 20 value	 0.123 
Considering row	 14 column	 4 value	 0.26 
Considering row	 14 column	 7 value	 0.129 
Considering row	 14 column	 15 value	 0.085 
Considering row	 14 column	 5 value	 0.007 
Considering row	 2 column	 9 value	 0.397 
Considering row	 2 column	 8 value	 0.154 
Considering row	 2 column	 13 value	 0.604 
Considering row	 2 column	 3 value	 0.202 
Considering row	 2 column	 18 value	 0.149 
Considering row	 2 column	 19 value	 0.036 
Considering row	 2 column	 20 value	 0.129 
Considering row	 2 column	 4 value	 0.185 
Considering row	 2 column	 7 value	 0.047 
Considering row	 2 column	 15 value	 0.065 
Considering row	 2 column	 5 value	 0.056 
Considering row	 9 column	 8 value	 0.376 
Considering row	 9 column	 13 value	 0.137 
Considering row	 9 column	 3 value	 0.314 
Considering row	 9 column	 18 value	 0.036 
Considering row	 9 column	 19 value	 0.155 
Considering row	 9 column	 20 value	 0.052 
Considering row	 9 column	 4 value	 0.025 
Considering row	 9 column	 7 value	 0.115 
Considering row	 9 column	 15 value	 0.059 
Considering row	 9 column	 5 value	 0.087 
Considering row	 8 column	 13 value	 0.138 
Considering row	 8 column	 3 value	 0.231 
Considering row	 8 column	 18 value	 0.189 
Considering row	 8 column	 19 value	 0.24 
Considering row	 8 column	 20 value	 0.167 
Considering row	 8 column	 4 value	 0.073 
Considering row	 8 column	 7 value	 0.106 
Considering row	 8 column	 15 value	 0.075 
Considering row	 8 column	 5 value	 0.03 
Considering row	 13 column	 3 value	 0.087 
Considering row	 13 column	 18 value	 0.224 
Considering row	 13 column	 19 value	 0.095 
Considering row	 13 column	 20 value	 0.165 
Considering row	 13 column	 4 value	 0.22 
Considering row	 13 column	 7 value	 0.052 
Considering row	 13 column	 15 value	 0.134 
Considering row	 13 column	 5 value	 0.007 
Considering row	 3 column	 18 value	 0.046 
Considering row	 3 column	 19 value	 0.123 
Considering row	 3 column	 20 value	 0.029 
Considering row	 3 column	 4 value	 0.121 
Considering row	 3 column	 7 value	 0.118 
Considering row	 3 column	 15 value	 0.029 
Considering row	 3 column	 5 value	 0.128 
Considering row	 18 column	 19 value	 0.169 
Considering row	 18 column	 20 value	 0.021 
Considering row	 18 column	 4 value	 0.1 
Considering row	 18 column	 7 value	 0.134 
Considering row	 18 column	 15 value	 0.082 
Considering row	 18 column	 5 value	 0.01 
Considering row	 19 column	 20 value	 0.855 
  Flagging column	 19 
Considering row	 20 column	 4 value	 0.029 
Considering row	 20 column	 7 value	 0.072 
Considering row	 20 column	 15 value	 0.031 
Considering row	 20 column	 5 value	 0.07 
Considering row	 4 column	 7 value	 0.026 
Considering row	 4 column	 15 value	 0.09 
Considering row	 4 column	 5 value	 0.237 
Considering row	 7 column	 15 value	 0.052 
Considering row	 7 column	 5 value	 0.001 
Considering row	 15 column	 5 value	 0.036 
> 
> colnames(trainDescr)[highCorr]
[1] "DEPSPOKE"     "SDEPHR"       "DEPBUCKET"    "AVGSQ"        "xAVAILBUCKET"
> 
> descr.ncol0 <- ncol(trainDescr)
> 
> # I've switched off the correlation remover and the results are better.
> if (sum(highCorr) > 0) {
+     warning("overfitting: correlations: err.trainDescr: ", paste(colnames(trainDescr)[highCorr], collapse = ", ") )
+     err.trainDescr <- trainDescr
+     trainDescr <- trainDescr[,-highCorr]
+ }
Warning message:
overfitting: correlations: err.trainDescr: DEPSPOKE, SDEPHR, DEPBUCKET, AVGSQ, xAVAILBUCKET 
> 
> descr.ncol1 <- ncol(trainDescr)
> 
> paste("Dropped: ", as.character(descr.ncol0 - descr.ncol1))
[1] "Dropped:  5"
> 
> descrCorr <- cor(trainDescr)
> summary(descrCorr[upper.tri(descrCorr)])
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.52440 -0.11740 -0.02409  0.01626  0.12310  0.67970 
> 
> ## Dominant correlations
> ## At 0.9, there are some big ones that might need re-thinking.
> 
> table.descrCorr <- as.data.frame(as.table(descrCorr))
> table.descrCorr <- table.descrCorr[which(table.descrCorr$Var1 != table.descrCorr$Var2),]
> table.descrCorr[order(abs(table.descrCorr$Freq), decreasing = TRUE),]
              Var1           Var2         Freq
146     TRNRANKGRP     DEPRANKGRP  0.679710649
160     DEPRANKGRP     TRNRANKGRP  0.679710649
118       ARRSPOKE DOWNLINEATCIMP  0.650258635
188 DOWNLINEATCIMP       ARRSPOKE  0.650258635
10      DEPRANKGRP      SKDDEPSTA  0.604024925
136      SKDDEPSTA     DEPRANKGRP  0.604024925
11      TRNRANKGRP      SKDDEPSTA  0.592997165
151      SKDDEPSTA     TRNRANKGRP  0.592997165
103       ARRSPOKE   DEPSTAATCIMP -0.524412986
187   DEPSTAATCIMP       ARRSPOKE -0.524412986
88        ARRSPOKE   UPLINEATCIMP  0.494116391
186   UPLINEATCIMP       ARRSPOKE  0.494116391
23  DOWNLINEATCIMP      SKDARRSTA  0.429627669
107      SKDARRSTA DOWNLINEATCIMP  0.429627669
164         xDURN2     TRNRANKGRP  0.416356398
206     TRNRANKGRP         xDURN2  0.416356398
7     DEPSTAATCIMP      SKDDEPSTA  0.396676501
91       SKDDEPSTA   DEPSTAATCIMP  0.396676501
83  DOWNLINEATCIMP   UPLINEATCIMP  0.385635866
111   UPLINEATCIMP DOWNLINEATCIMP  0.385635866
82    DEPSTAATCIMP   UPLINEATCIMP -0.376459935
96    UPLINEATCIMP   DEPSTAATCIMP -0.376459935
98  DOWNLINEATCIMP   DEPSTAATCIMP -0.359442928
112   DEPSTAATCIMP DOWNLINEATCIMP -0.359442928
22    DEPSTAATCIMP      SKDARRSTA -0.313983387
92       SKDARRSTA   DEPSTAATCIMP -0.313983387
28        ARRSPOKE      SKDARRSTA  0.269856622
182      SKDARRSTA       ARRSPOKE  0.269856622
133       ARRSPOKE      ARRBUCKET  0.266038665
189      ARRBUCKET       ARRSPOKE  0.266038665
41      TRNRANKGRP         SKDEQP  0.260348966
153         SKDEQP     TRNRANKGRP  0.260348966
194         xDURN2       ARRSPOKE -0.259384291
208       ARRSPOKE         xDURN2 -0.259384291
114      ARRBUCKET DOWNLINEATCIMP  0.258445673
128 DOWNLINEATCIMP      ARRBUCKET  0.258445673
117     ARRRANKGRP DOWNLINEATCIMP -0.252664012
173 DOWNLINEATCIMP     ARRRANKGRP -0.252664012
163       ARRSPOKE     TRNRANKGRP -0.249849318
191     TRNRANKGRP       ARRSPOKE -0.249849318
34          SKDEPS         SKDEQP  0.237489581
48          SKDEQP         SKDEPS  0.237489581
8   DOWNLINEATCIMP      SKDDEPSTA -0.231125751
106      SKDDEPSTA DOWNLINEATCIMP -0.231125751
21    UPLINEATCIMP      SKDARRSTA  0.230624101
77       SKDARRSTA   UPLINEATCIMP  0.230624101
116     TRNRANKGRP DOWNLINEATCIMP -0.224586402
158 DOWNLINEATCIMP     TRNRANKGRP -0.224586402
149         xDURN2     DEPRANKGRP  0.224335996
205     DEPRANKGRP         xDURN2  0.224335996
13        ARRSPOKE      SKDDEPSTA -0.224088104
181      SKDDEPSTA       ARRSPOKE -0.224088104
40      DEPRANKGRP         SKDEQP  0.219735222
138         SKDEQP     DEPRANKGRP  0.219735222
148       ARRSPOKE     DEPRANKGRP -0.219123513
190     DEPRANKGRP       ARRSPOKE -0.219123513
68  DOWNLINEATCIMP      AVGLOFATC -0.208026851
110      AVGLOFATC DOWNLINEATCIMP -0.208026851
2        SKDARRSTA      SKDDEPSTA -0.201985002
16       SKDDEPSTA      SKDARRSTA -0.201985002
119         xDURN2 DOWNLINEATCIMP -0.198190357
203 DOWNLINEATCIMP         xDURN2 -0.198190357
89          xDURN2   UPLINEATCIMP -0.188769467
201   UPLINEATCIMP         xDURN2 -0.188769467
3           SKDEQP      SKDDEPSTA  0.185342000
31       SKDDEPSTA         SKDEQP  0.185342000
115     DEPRANKGRP DOWNLINEATCIMP -0.176726111
143 DOWNLINEATCIMP     DEPRANKGRP -0.176726111
90    xAVGSKDAVAIL   UPLINEATCIMP  0.167237979
216   UPLINEATCIMP   xAVGSKDAVAIL  0.167237979
150   xAVGSKDAVAIL     DEPRANKGRP  0.165126992
220     DEPRANKGRP   xAVGSKDAVAIL  0.165126992
135   xAVGSKDAVAIL      ARRBUCKET -0.164724095
219      ARRBUCKET   xAVGSKDAVAIL -0.164724095
86      TRNRANKGRP   UPLINEATCIMP -0.164076053
156   UPLINEATCIMP     TRNRANKGRP -0.164076053
99       ARRBUCKET   DEPSTAATCIMP -0.155707847
127   DEPSTAATCIMP      ARRBUCKET -0.155707847
6     UPLINEATCIMP      SKDDEPSTA -0.154229596
76       SKDDEPSTA   UPLINEATCIMP -0.154229596
101     TRNRANKGRP   DEPSTAATCIMP -0.152394918
157   DEPSTAATCIMP     TRNRANKGRP -0.152394918
14          xDURN2      SKDDEPSTA  0.149409725
196      SKDDEPSTA         xDURN2  0.149409725
24       ARRBUCKET      SKDARRSTA  0.148654706
122      SKDARRSTA      ARRBUCKET  0.148654706
85      DEPRANKGRP   UPLINEATCIMP -0.138336908
141   UPLINEATCIMP     DEPRANKGRP -0.138336908
9        ARRBUCKET      SKDDEPSTA -0.138109644
121      SKDDEPSTA      ARRBUCKET -0.138109644
100     DEPRANKGRP   DEPSTAATCIMP  0.137168774
142   DEPSTAATCIMP     DEPRANKGRP  0.137168774
147     ARRRANKGRP     DEPRANKGRP  0.134293368
175     DEPRANKGRP     ARRRANKGRP  0.134293368
74          xDURN2      AVGLOFATC -0.133737212
200      AVGLOFATC         xDURN2 -0.133737212
15    xAVGSKDAVAIL      SKDDEPSTA  0.128937007
211      SKDDEPSTA   xAVGSKDAVAIL  0.128937007
71      TRNRANKGRP      AVGLOFATC  0.128844617
155      AVGLOFATC     TRNRANKGRP  0.128844617
19          SKDEPS      SKDARRSTA -0.127934873
47       SKDARRSTA         SKDEPS -0.127934873
165   xAVGSKDAVAIL     TRNRANKGRP  0.123051553
221     TRNRANKGRP   xAVGSKDAVAIL  0.123051553
18          SKDEQP      SKDARRSTA  0.120974677
32       SKDARRSTA         SKDEQP  0.120974677
20       AVGLOFATC      SKDARRSTA -0.117513827
62       SKDARRSTA      AVGLOFATC -0.117513827
53  DOWNLINEATCIMP         SKDEPS -0.117377214
109         SKDEPS DOWNLINEATCIMP -0.117377214
67    DEPSTAATCIMP      AVGLOFATC -0.114985784
95       AVGLOFATC   DEPSTAATCIMP -0.114985784
132     ARRRANKGRP      ARRBUCKET -0.108190526
174      ARRBUCKET     ARRRANKGRP -0.108190526
66    UPLINEATCIMP      AVGLOFATC -0.106087296
80       AVGLOFATC   UPLINEATCIMP -0.106087296
69       ARRBUCKET      AVGLOFATC -0.101680701
125      AVGLOFATC      ARRBUCKET -0.101680701
131     TRNRANKGRP      ARRBUCKET -0.101157118
159      ARRBUCKET     TRNRANKGRP -0.101157118
44          xDURN2         SKDEQP  0.100358277
198         SKDEQP         xDURN2  0.100358277
130     DEPRANKGRP      ARRBUCKET -0.099672898
144      ARRBUCKET     DEPRANKGRP -0.099672898
73        ARRSPOKE      AVGLOFATC -0.097294251
185      AVGLOFATC       ARRSPOKE -0.097294251
42      ARRRANKGRP         SKDEQP -0.089992400
168         SKDEQP     ARRRANKGRP -0.089992400
52    DEPSTAATCIMP         SKDEPS -0.087072528
94          SKDEPS   DEPSTAATCIMP -0.087072528
25      DEPRANKGRP      SKDARRSTA -0.086602115
137      SKDARRSTA     DEPRANKGRP -0.086602115
162     ARRRANKGRP     TRNRANKGRP  0.084645738
176     TRNRANKGRP     ARRRANKGRP  0.084645738
179         xDURN2     ARRRANKGRP  0.082357651
207     ARRRANKGRP         xDURN2  0.082357651
87      ARRRANKGRP   UPLINEATCIMP -0.074595694
171   UPLINEATCIMP     ARRRANKGRP -0.074595694
36    UPLINEATCIMP         SKDEQP -0.073204870
78          SKDEQP   UPLINEATCIMP -0.073204870
75    xAVGSKDAVAIL      AVGLOFATC -0.072283486
215      AVGLOFATC   xAVGSKDAVAIL -0.072283486
120   xAVGSKDAVAIL DOWNLINEATCIMP  0.070022296
218 DOWNLINEATCIMP   xAVGSKDAVAIL  0.070022296
84       ARRBUCKET   UPLINEATCIMP  0.069991729
126   UPLINEATCIMP      ARRBUCKET  0.069991729
60    xAVGSKDAVAIL         SKDEPS  0.069508892
214         SKDEPS   xAVGSKDAVAIL  0.069508892
39       ARRBUCKET         SKDEQP  0.066322418
123         SKDEQP      ARRBUCKET  0.066322418
12      ARRRANKGRP      SKDDEPSTA  0.065298363
166      SKDDEPSTA     ARRRANKGRP  0.065298363
134         xDURN2      ARRBUCKET -0.063338880
204      ARRBUCKET         xDURN2 -0.063338880
102     ARRRANKGRP   DEPSTAATCIMP  0.059417043
172   DEPSTAATCIMP     ARRRANKGRP  0.059417043
4           SKDEPS      SKDDEPSTA -0.055848950
46       SKDDEPSTA         SKDEPS -0.055848950
72      ARRRANKGRP      AVGLOFATC -0.052299380
170      AVGLOFATC     ARRRANKGRP -0.052299380
105   xAVGSKDAVAIL   DEPSTAATCIMP -0.051811519
217   DEPSTAATCIMP   xAVGSKDAVAIL -0.051811519
70      DEPRANKGRP      AVGLOFATC  0.051729445
140      AVGLOFATC     DEPRANKGRP  0.051729445
5        AVGLOFATC      SKDDEPSTA -0.047137870
61       SKDDEPSTA      AVGLOFATC -0.047137870
29          xDURN2      SKDARRSTA  0.046266649
197      SKDARRSTA         xDURN2  0.046266649
178       ARRSPOKE     ARRRANKGRP -0.041675524
192     ARRRANKGRP       ARRSPOKE -0.041675524
195   xAVGSKDAVAIL       ARRSPOKE  0.040724207
223       ARRSPOKE   xAVGSKDAVAIL  0.040724207
43        ARRSPOKE         SKDEQP  0.037713478
183         SKDEQP       ARRSPOKE  0.037713478
57      ARRRANKGRP         SKDEPS  0.035879493
169         SKDEPS     ARRRANKGRP  0.035879493
104         xDURN2   DEPSTAATCIMP -0.035857710
202   DEPSTAATCIMP         xDURN2 -0.035857710
180   xAVGSKDAVAIL     ARRRANKGRP -0.030911145
222     ARRRANKGRP   xAVGSKDAVAIL -0.030911145
51    UPLINEATCIMP         SKDEPS -0.030130879
79          SKDEPS   UPLINEATCIMP -0.030130879
30    xAVGSKDAVAIL      SKDARRSTA  0.028980188
212      SKDARRSTA   xAVGSKDAVAIL  0.028980188
27      ARRRANKGRP      SKDARRSTA  0.028711290
167      SKDARRSTA     ARRRANKGRP  0.028711290
45    xAVGSKDAVAIL         SKDEQP  0.028664638
213         SKDEQP   xAVGSKDAVAIL  0.028664638
35       AVGLOFATC         SKDEQP -0.026255891
63          SKDEQP      AVGLOFATC -0.026255891
26      TRNRANKGRP      SKDARRSTA -0.025500778
152      SKDARRSTA     TRNRANKGRP -0.025500778
37    DEPSTAATCIMP         SKDEQP -0.025496949
93          SKDEQP   DEPSTAATCIMP -0.025496949
58        ARRSPOKE         SKDEPS -0.024086753
184         SKDEPS       ARRSPOKE -0.024086753
38  DOWNLINEATCIMP         SKDEQP  0.023094073
108         SKDEQP DOWNLINEATCIMP  0.023094073
210   xAVGSKDAVAIL         xDURN2 -0.020905981
224         xDURN2   xAVGSKDAVAIL -0.020905981
54       ARRBUCKET         SKDEPS  0.017985930
124         SKDEPS      ARRBUCKET  0.017985930
59          xDURN2         SKDEPS  0.009506456
199         SKDEPS         xDURN2  0.009506456
56      TRNRANKGRP         SKDEPS  0.007436459
154         SKDEPS     TRNRANKGRP  0.007436459
55      DEPRANKGRP         SKDEPS -0.007022309
139         SKDEPS     DEPRANKGRP -0.007022309
50       AVGLOFATC         SKDEPS  0.001499404
64          SKDEPS      AVGLOFATC  0.001499404
> 
> ### Models
> 
> ## Try GBM (gradient boosting). Works well for mixed data.
> ## And there is a tutorial for it with caret.
> 
> ## Training controller and big grid
> 
> fitControl <- trainControl(## 10-fold CV
+     method = "repeatedcv",
+     number = 10,
+     ## repeated ten times
+     repeats = 10,
+     classProbs = 10,
+     summaryFunction = twoClassSummary)
> 
> ## 
> 
> colnames(trainDescr)
 [1] "SKDDEPSTA"      "SKDARRSTA"      "SKDEQP"         "SKDEPS"        
 [5] "AVGLOFATC"      "UPLINEATCIMP"   "DEPSTAATCIMP"   "DOWNLINEATCIMP"
 [9] "ARRBUCKET"      "DEPRANKGRP"     "TRNRANKGRP"     "ARRRANKGRP"    
[13] "ARRSPOKE"       "xDURN2"         "xAVGSKDAVAIL"  
> ?caret::expand.grid
> ?expand.grid
> fitControl <- trainControl(## 10-fold CV
+     method = "repeatedcv",
+     number = 10,
+     ## repeated ten times
+     repeats = 10,
+     classProbs = 10,
+     summaryFunction = twoClassSummary)
> 
> ## Some trial and error with variables to branch and boost.
> ## I'm just going to try the airports and the planes and the duration
> ## of the flight. There may be some distance relationship there that
> ## air traffic control use.
> 
> colnames(trainDescr)
 [1] "SKDDEPSTA"      "SKDARRSTA"      "SKDEQP"         "SKDEPS"        
 [5] "AVGLOFATC"      "UPLINEATCIMP"   "DEPSTAATCIMP"   "DOWNLINEATCIMP"
 [9] "ARRBUCKET"      "DEPRANKGRP"     "TRNRANKGRP"     "ARRRANKGRP"    
[13] "ARRSPOKE"       "xDURN2"         "xAVGSKDAVAIL"  
> 
> gbmGrid <-  expand.grid(interaction.depth = c(14, 3, 2, 1),
+                         n.trees = (1:30)*60,
+                         shrinkage = 0.1,
+                         n.minobsinnode = 20)
> 
> set.seed(seed.mine)
> gbmFit1 <- train(trainDescr, trainClass,
+                  method = "gbm",
+                  trControl = fitControl,
+                  ## This last option is actually one
+                  ## for gbm() that passes through
+                  tuneGrid = gbmGrid,
+                  metric = "ROC",
+                  verbose = FALSE)
Loading required package: gbm
Loading required package: survival

Attaching package: 'survival'

The following object is masked from 'package:caret':

    cluster

Loading required package: splines
Loaded gbm 2.1.1
Loading required package: plyr
> gbmFit1
Stochastic Gradient Boosting 

241 samples
 15 predictor
  2 classes: 'Strong', 'Weak' 

No pre-processing
Resampling: Cross-Validated (10 fold, repeated 10 times) 

Summary of sample sizes: 216, 217, 217, 217, 217, 217, ... 

Resampling results across tuning parameters:

  interaction.depth  n.trees  ROC        Sens       Spec       ROC SD    
   1                   60     0.8251323  0.9083333  0.3769048  0.08333795
   1                  120     0.8255556  0.9022222  0.4554762  0.08935970
   1                  180     0.8316270  0.9005556  0.4819048  0.08684516
   1                  240     0.8394974  0.9022222  0.4833333  0.08310476
   1                  300     0.8393519  0.9038889  0.4985714  0.08294855
   1                  360     0.8386376  0.9044444  0.4838095  0.08047728
   1                  420     0.8408201  0.9050000  0.5061905  0.08013721
   1                  480     0.8455026  0.9044444  0.4914286  0.07802772
   1                  540     0.8486905  0.9022222  0.4933333  0.07766604
   1                  600     0.8431481  0.9011111  0.4916667  0.07595585
   1                  660     0.8445899  0.8988889  0.5016667  0.07759765
   1                  720     0.8445635  0.8961111  0.5061905  0.07666323
   1                  780     0.8438757  0.8966667  0.5030952  0.07731174
   1                  840     0.8426058  0.8955556  0.5014286  0.07640969
   1                  900     0.8419577  0.8894444  0.5097619  0.07569767
   1                  960     0.8428968  0.8922222  0.5080952  0.07737170
   1                 1020     0.8442989  0.8894444  0.5080952  0.07791196
   1                 1080     0.8452513  0.8883333  0.5066667  0.07675585
   1                 1140     0.8441402  0.8900000  0.5130952  0.07700930
   1                 1200     0.8455423  0.8883333  0.5178571  0.07695576
   1                 1260     0.8446164  0.8872222  0.5216667  0.07657765
   1                 1320     0.8451984  0.8861111  0.5247619  0.07735699
   1                 1380     0.8445635  0.8872222  0.5247619  0.07837474
   1                 1440     0.8446693  0.8866667  0.5300000  0.07628185
   1                 1500     0.8461111  0.8894444  0.5264286  0.07595097
   1                 1560     0.8470503  0.8883333  0.5166667  0.07574182
   1                 1620     0.8459259  0.8855556  0.5247619  0.07586838
   1                 1680     0.8478307  0.8861111  0.5316667  0.07483885
   1                 1740     0.8466534  0.8833333  0.5333333  0.07379278
   1                 1800     0.8476720  0.8827778  0.5230952  0.07498295
   2                   60     0.8257804  0.8922222  0.4535714  0.07914460
   2                  120     0.8339683  0.8983333  0.4719048  0.07895931
   2                  180     0.8379365  0.8966667  0.4761905  0.07650746
   2                  240     0.8416799  0.8938889  0.4769048  0.07578638
   2                  300     0.8444444  0.8911111  0.4680952  0.07641165
   2                  360     0.8452646  0.8900000  0.4883333  0.07333456
   2                  420     0.8476323  0.8916667  0.4797619  0.07411765
   2                  480     0.8468651  0.8888889  0.4897619  0.07787306
   2                  540     0.8479762  0.8900000  0.4802381  0.07696711
   2                  600     0.8501323  0.8888889  0.4819048  0.07327297
   2                  660     0.8498016  0.8883333  0.4852381  0.07456380
   2                  720     0.8498016  0.8883333  0.4919048  0.07501021
   2                  780     0.8502646  0.8855556  0.4914286  0.07412631
   2                  840     0.8496032  0.8872222  0.4933333  0.07396340
   2                  900     0.8505688  0.8850000  0.4847619  0.07244433
   2                  960     0.8525794  0.8850000  0.5000000  0.07214239
   2                 1020     0.8519841  0.8861111  0.4935714  0.07062848
   2                 1080     0.8514815  0.8883333  0.4897619  0.06939676
   2                 1140     0.8517725  0.8877778  0.4933333  0.06961562
   2                 1200     0.8517196  0.8844444  0.4914286  0.06971017
   2                 1260     0.8536376  0.8850000  0.4880952  0.06889125
   2                 1320     0.8533730  0.8850000  0.4897619  0.06963023
   2                 1380     0.8536640  0.8855556  0.4916667  0.06925415
   2                 1440     0.8543915  0.8855556  0.4816667  0.06983130
   2                 1500     0.8547487  0.8855556  0.4978571  0.06877811
   2                 1560     0.8538492  0.8844444  0.4976190  0.06771083
   2                 1620     0.8531349  0.8838889  0.4892857  0.06857139
   2                 1680     0.8532143  0.8861111  0.4942857  0.06938616
   2                 1740     0.8534392  0.8844444  0.4861905  0.06725605
   2                 1800     0.8540212  0.8838889  0.4909524  0.06925360
   3                   60     0.8301984  0.8927778  0.4666667  0.08280211
   3                  120     0.8380688  0.8972222  0.4661905  0.08175918
   3                  180     0.8390079  0.8955556  0.4750000  0.07843443
   3                  240     0.8430159  0.8938889  0.4669048  0.07707991
   3                  300     0.8426058  0.8938889  0.4697619  0.07730191
   3                  360     0.8415344  0.8877778  0.4761905  0.07669331
   3                  420     0.8436640  0.8877778  0.4850000  0.07648602
   3                  480     0.8458862  0.8877778  0.4850000  0.07647951
   3                  540     0.8465212  0.8850000  0.4885714  0.07447726
   3                  600     0.8476984  0.8866667  0.4804762  0.07472047
   3                  660     0.8492460  0.8850000  0.4838095  0.07401356
   3                  720     0.8489550  0.8800000  0.4871429  0.07507929
   3                  780     0.8476852  0.8794444  0.4902381  0.07302964
   3                  840     0.8483201  0.8827778  0.4938095  0.07450824
   3                  900     0.8499471  0.8811111  0.4871429  0.07290465
   3                  960     0.8500529  0.8822222  0.4904762  0.07199357
   3                 1020     0.8502116  0.8811111  0.4904762  0.07184972
   3                 1080     0.8493783  0.8788889  0.4888095  0.07200367
   3                 1140     0.8495767  0.8794444  0.4952381  0.07047607
   3                 1200     0.8514021  0.8777778  0.4902381  0.06943397
   3                 1260     0.8496429  0.8772222  0.4852381  0.07159837
   3                 1320     0.8502381  0.8811111  0.4888095  0.07281229
   3                 1380     0.8493915  0.8794444  0.4904762  0.07367911
   3                 1440     0.8477910  0.8783333  0.4919048  0.07225252
   3                 1500     0.8496032  0.8750000  0.4888095  0.07129744
   3                 1560     0.8501058  0.8772222  0.4838095  0.07281382
   3                 1620     0.8490741  0.8783333  0.4854762  0.07300281
   3                 1680     0.8483333  0.8783333  0.4919048  0.07141625
   3                 1740     0.8476455  0.8794444  0.4852381  0.07182174
   3                 1800     0.8463228  0.8783333  0.4788095  0.07103491
  14                   60     0.8263624  0.9038889  0.4502381  0.08213179
  14                  120     0.8317063  0.8938889  0.4666667  0.07956277
  14                  180     0.8364683  0.8916667  0.4654762  0.07554977
  14                  240     0.8387566  0.8905556  0.4785714  0.07942841
  14                  300     0.8421958  0.8911111  0.4833333  0.07473430
  14                  360     0.8433730  0.8866667  0.4816667  0.07448216
  14                  420     0.8435847  0.8811111  0.4769048  0.07252209
  14                  480     0.8436905  0.8833333  0.4850000  0.07463859
  14                  540     0.8423545  0.8794444  0.4814286  0.07478557
  14                  600     0.8428836  0.8822222  0.4719048  0.07383428
  14                  660     0.8427381  0.8827778  0.4730952  0.07415489
  14                  720     0.8424471  0.8822222  0.4780952  0.07487685
  14                  780     0.8426587  0.8833333  0.4830952  0.07416263
  14                  840     0.8426720  0.8816667  0.4780952  0.07328052
  14                  900     0.8428439  0.8822222  0.4814286  0.07385991
  14                  960     0.8436508  0.8794444  0.4800000  0.07289439
  14                 1020     0.8431878  0.8761111  0.4830952  0.07337056
  14                 1080     0.8454365  0.8744444  0.4880952  0.07213137
  14                 1140     0.8468783  0.8755556  0.4797619  0.07105052
  14                 1200     0.8470503  0.8755556  0.4747619  0.07045666
  14                 1260     0.8477778  0.8772222  0.4750000  0.07223354
  14                 1320     0.8493254  0.8750000  0.4766667  0.07132485
  14                 1380     0.8476455  0.8733333  0.4800000  0.07094080
  14                 1440     0.8475926  0.8716667  0.4766667  0.06893644
  14                 1500     0.8472751  0.8727778  0.4783333  0.07097170
  14                 1560     0.8463360  0.8705556  0.4769048  0.06964411
  14                 1620     0.8458995  0.8733333  0.4766667  0.07185719
  14                 1680     0.8450397  0.8727778  0.4785714  0.07234520
  14                 1740     0.8450661  0.8705556  0.4816667  0.07126425
  14                 1800     0.8447222  0.8716667  0.4802381  0.07193693
  Sens SD     Spec SD  
  0.06945847  0.2119091
  0.07285187  0.2311308
  0.07586020  0.2170370
  0.07537577  0.2093384
  0.07608999  0.2065938
  0.07368585  0.2076736
  0.07075696  0.2014520
  0.06932594  0.2055016
  0.07327856  0.2004107
  0.07347400  0.2024375
  0.07506907  0.2026038
  0.07803189  0.1943633
  0.07656583  0.1882279
  0.07544192  0.1933946
  0.07470063  0.1894844
  0.07399828  0.1957314
  0.07675900  0.1899108
  0.07635177  0.1903583
  0.07735979  0.1862929
  0.07386123  0.1943561
  0.07510022  0.2014371
  0.07465053  0.2027921
  0.07633543  0.1899319
  0.07319342  0.1935662
  0.07171974  0.1976724
  0.07301217  0.1980372
  0.07441839  0.1971800
  0.07123122  0.1954631
  0.07386334  0.1930146
  0.07318277  0.1980937
  0.07098790  0.1978310
  0.07282405  0.1991869
  0.07366046  0.1951096
  0.07284117  0.1991316
  0.07570593  0.2024331
  0.07654955  0.2073871
  0.07423173  0.2080729
  0.07655769  0.2091675
  0.07855948  0.2012654
  0.07280050  0.2048765
  0.07553071  0.1981898
  0.07675900  0.2013838
  0.07399828  0.2041317
  0.07674275  0.2014367
  0.07584376  0.2051112
  0.07584376  0.1959004
  0.07630275  0.1993443
  0.07635177  0.1995567
  0.07614119  0.1947300
  0.07844034  0.1960909
  0.07945718  0.1959150
  0.07787192  0.2009578
  0.07689089  0.2006761
  0.08006887  0.2014019
  0.07607565  0.1984010
  0.07962376  0.1987299
  0.08017587  0.2033407
  0.07950425  0.2000687
  0.07804188  0.2075716
  0.07740612  0.2041110
  0.07666146  0.2018320
  0.07671025  0.2072403
  0.07828120  0.2081830
  0.07659637  0.1952239
  0.07618826  0.1988266
  0.07934920  0.2007795
  0.07855948  0.1974625
  0.08051927  0.2002842
  0.08023806  0.2032591
  0.08353698  0.2012461
  0.08291327  0.2056788
  0.08119017  0.1961464
  0.07977045  0.2077623
  0.07772766  0.1993088
  0.08541909  0.2017872
  0.08024778  0.2033583
  0.08168783  0.2033583
  0.08258361  0.2039615
  0.08093442  0.2007510
  0.08206099  0.2054062
  0.08515407  0.2030421
  0.08357429  0.2053326
  0.08687929  0.2047334
  0.08156370  0.2075175
  0.08295838  0.1997919
  0.08255151  0.2001477
  0.08270244  0.1894784
  0.08456626  0.1935248
  0.08283803  0.1960109
  0.08232461  0.1917912
  0.07526608  0.2093547
  0.07659637  0.1863121
  0.07589307  0.1883411
  0.07342094  0.1946247
  0.07276623  0.1993628
  0.07487779  0.2013166
  0.07615757  0.1915690
  0.07470272  0.2033486
  0.07617189  0.2002249
  0.07502753  0.1988129
  0.07528265  0.1985614
  0.07206017  0.2026723
  0.07301430  0.2010729
  0.07803189  0.2026723
  0.07667163  0.2030083
  0.07698611  0.2022209
  0.08238518  0.1996726
  0.08379781  0.2129454
  0.08508998  0.2021545
  0.08545558  0.2008885
  0.08404856  0.2005905
  0.08518336  0.2014907
  0.08616766  0.2046136
  0.08566510  0.2000933
  0.08696537  0.2037548
  0.08395949  0.2008210
  0.08209138  0.2028785
  0.08217299  0.2003084
  0.08579601  0.1985095
  0.08345296  0.1997804

Tuning parameter 'shrinkage' was held constant at a value of 0.1

Tuning parameter 'n.minobsinnode' was held constant at a value of 20
ROC was used to select the optimal model using  the largest value.
The final values used for the model were n.trees = 1500, interaction.depth =
 2, shrinkage = 0.1 and n.minobsinnode = 20. 
> 
> ## The acid test is dissapointing, but I've seen worse.
> 
> testPred <- predict(gbmFit1, testDescr)
> postResample(testPred, testClass)
 Accuracy     Kappa 
0.6835443 0.1767403 
> confusionMatrix(testPred, testClass, positive = "Weak")
Confusion Matrix and Statistics

          Reference
Prediction Strong Weak
    Strong     46   12
    Weak       13    8
                                          
               Accuracy : 0.6835          
                 95% CI : (0.5692, 0.7837)
    No Information Rate : 0.7468          
    P-Value [Acc > NIR] : 0.92            
                                          
                  Kappa : 0.1767          
 Mcnemar's Test P-Value : 1.00            
                                          
            Sensitivity : 0.4000          
            Specificity : 0.7797          
         Pos Pred Value : 0.3810          
         Neg Pred Value : 0.7931          
             Prevalence : 0.2532          
         Detection Rate : 0.1013          
   Detection Prevalence : 0.2658          
      Balanced Accuracy : 0.5898          
                                          
       'Positive' Class : Weak            
                                          
> 
> ## The training set is exact even with the correlation cut-offs
> ## As one would hope - but 
> trainPred <- predict(gbmFit1, trainDescr)
> postResample(trainPred, trainClass)
Accuracy    Kappa 
       1        1 
> confusionMatrix(trainPred, trainClass, positive = "Weak")
Confusion Matrix and Statistics

          Reference
Prediction Strong Weak
    Strong    180    0
    Weak        0   61
                                     
               Accuracy : 1          
                 95% CI : (0.9848, 1)
    No Information Rate : 0.7469     
    P-Value [Acc > NIR] : < 2.2e-16  
                                     
                  Kappa : 1          
 Mcnemar's Test P-Value : NA         
                                     
            Sensitivity : 1.0000     
            Specificity : 1.0000     
         Pos Pred Value : 1.0000     
         Neg Pred Value : 1.0000     
             Prevalence : 0.2531     
         Detection Rate : 0.2531     
   Detection Prevalence : 0.2531     
      Balanced Accuracy : 1.0000     
                                     
       'Positive' Class : Weak       
